(function(W){typeof define=="function"&&define.amd?define(W):W()})(function(){"use strict";var Qo=Object.defineProperty;var ec=(W,ue,Se)=>ue in W?Qo(W,ue,{enumerable:!0,configurable:!0,writable:!0,value:Se}):W[ue]=Se;var Tt=(W,ue,Se)=>(ec(W,typeof ue!="symbol"?ue+"":ue,Se),Se);class W{constructor(t){this.eventName=t}}class ue extends W{constructor(t){super("packet"),this.packet=t,this.payload=t[1]}}class Se extends ue{constructor(t){super(t),this.type=t[0]}}class Wr extends ue{constructor(t){super(t),this.isCanceled=!1,this.type=t[0]}}class $r extends W{constructor(t){super("player"),this.player=t}}class Nn extends W{constructor(t,r){super("health"),this.sid=t,this.health=r}}class Kr extends W{constructor(t){super("build"),this.building=t}}class Dn extends Kr{constructor(t){super(t)}}class jr extends Kr{constructor(t,r){super(t),this.reason=r}}class Mn extends W{constructor(t,r){super("chat"),this.sid=t,this.message=r}}class Un extends W{constructor(t){super("server_tick"),this.playerData=t}}class Cn extends W{constructor(t){super("projectile_add"),this.projectile=t}}class Fn extends W{constructor(t){super("projectile_remove"),this.projectile=t}}var L;(function(e){e.SPAWN="sp",e.CHAT="ch",e.ATTACK="c",e.PING="pp",e.SET_ANGLE="2",e.SELECT_ITEM="5",e.UPGRADE="6",e.SET_ATTACK_STATE="7",e.CREATE_TRIBE="8",e.LEAVE_TRIBE="9",e.REQUEST_JOIN_TRIBE="10",e.ACCEPT_TRIBE_REQUEST="11",e.KICK_FROM_TRIBE="12",e.BUY_AND_EQUIP="13c",e.PING_MAP="14",e.MOVE="33"})(L||(L={}));var F;(function(e){e.ANNOUNCE="ann",e.INIT="io-init",e.INIT_TRIBES="id",e.SET_SID="1",e.KICK="d",e.ADD_PLAYER="2",e.UPDAE_PLAYERS="33",e.REMOVE_PLAYER="4",e.UPDATE_LEADER_BOARD="5",e.ADD_OBJECT="6",e.UPDATE_AIS="a",e.PLAYER_SWING="7",e.MOOSTAFA_SWING="aa",e.WIGGLE="8",e.SHOOT_TURRET="sp",e.UPDATE_MATS="9",e.HEALTH="h",e.DEATH="11",e.REMOVE_OBJECT="12",e.REMOVE_ALL_OBJECTS="13",e.SET_ITEM_COUNT="14",e.SET_AGE="15",e.LIST_UPGRADES="16",e.SET_ITEMS_BAR="17",e.ADD_PROJECTILE="18",e.REMOVE_PROJECTILE="19",e.SERVER_RESTART="20",e.ADD_TRIBE="ac",e.DELETE_TRIBE="ad",e.REQUEST_JOIN_TRIBE="an",e.SET_TRIBE="st",e.SET_TRIBE_MEMBERS="sa",e.MINIMAP_LOCATIONS="mm",e.CHAT="ch",e.UPDATE_SHOP="us",e.PING="pp",e.DAMAGE_TEST="t",e.PING_MAP="p"})(F||(F={}));var U;(function(e){e[e.APPLE=0]="APPLE",e[e.COOKIE=1]="COOKIE",e[e.CHEESE=2]="CHEESE",e[e.WOOD_WALL=3]="WOOD_WALL",e[e.STONE_WALL=4]="STONE_WALL",e[e.CASTLE_WALL=5]="CASTLE_WALL",e[e.SPIKE=6]="SPIKE",e[e.GREATER_SPIKE=7]="GREATER_SPIKE",e[e.POISON_SPIKE=8]="POISON_SPIKE",e[e.SPINNING_SPIKE=9]="SPINNING_SPIKE",e[e.WINDMILL=10]="WINDMILL",e[e.FASTER_WINDMILL=11]="FASTER_WINDMILL",e[e.POWER_MILL=12]="POWER_MILL",e[e.MINE=13]="MINE",e[e.SAPPLING=14]="SAPPLING",e[e.PIT_TRAP=15]="PIT_TRAP",e[e.BOOST_PAD=16]="BOOST_PAD",e[e.TURRET=17]="TURRET",e[e.PLATFORM=18]="PLATFORM",e[e.HEALING_PAD=19]="HEALING_PAD",e[e.SPAWN_PAD=20]="SPAWN_PAD",e[e.BLOCKER=21]="BLOCKER",e[e.TELEPORTER=22]="TELEPORTER"})(U||(U={}));var Ve;(function(e){e[e.TOOL_HAMMER=0]="TOOL_HAMMER",e[e.HAND_AXE=1]="HAND_AXE",e[e.GREAT_AXE=2]="GREAT_AXE",e[e.SHORT_SWORD=3]="SHORT_SWORD",e[e.KATANA=4]="KATANA",e[e.POLE_ARM=5]="POLE_ARM",e[e.BAT=6]="BAT",e[e.DAGGERS=7]="DAGGERS",e[e.STICK=8]="STICK",e[e.HUNTING_BOW=9]="HUNTING_BOW",e[e.GREAT_HAMMER=10]="GREAT_HAMMER",e[e.WOODEN_SHIELD=11]="WOODEN_SHIELD",e[e.CROSSBOW=12]="CROSSBOW",e[e.REPEATER_CROSSBOW=13]="REPEATER_CROSSBOW",e[e.MC_GRABBY=14]="MC_GRABBY",e[e.MUSKET=15]="MUSKET"})(Ve||(Ve={}));var rr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Ye={},G={};Object.defineProperty(G,"__esModule",{value:!0}),G.randInt=G.randFloat=G.averageAngle=G.lerpPos=G.lerp=G.toDeg=_e=G.toRad=G.calcVec=Yr=G.getAngle=at=G.getDistance=void 0;const st=Ye,Vr=Math.PI;function Gn(e,t,r,i){if(e instanceof st.PrimitivePos&&t instanceof st.PrimitivePos)return Math.hypot(e.x-t.x,e.y-t.y);if(typeof e=="number"&&typeof t=="number"&&r!=null&&i!=null)return Math.hypot(e-r,t-i);throw new Error(`Invalid arguments! ${e} ${t} ${r} ${i}`)}var at=G.getDistance=Gn;function In(e,t,r,i){if(e instanceof st.PrimitivePos&&t instanceof st.PrimitivePos)return Math.atan2(t.y-e.y,t.x-e.x);if(typeof e=="number"&&typeof t=="number"&&r!=null&&i!=null)return Math.atan2(i-t,r-e);throw new Error(`Invalid arguments! ${e} ${t} ${r} ${i}`)}var Yr=G.getAngle=In;function Hn(e,t,r){return e.add(Math.cos(t)*r,Math.sin(t)*r)}G.calcVec=Hn;function Wn(e){return Vr*e/180}var _e=G.toRad=Wn;function $n(e){return e*(180/Vr)}G.toDeg=$n;function ir(e,t,r){return e+(t-e)*r}G.lerp=ir;function Kn(e,t,r){return new st.Pos(ir(e.x,t.x,r),ir(e.y,t.y,r))}G.lerpPos=Kn;function jn(e,t){return(360+t+((e-t+180+360)%360-180)/2)%360}G.averageAngle=jn;function Jr(e,t){return Math.random()*(t-e)+e}G.randFloat=Jr;function Vn(e,t){return Math.round(Jr(e,t))}G.randInt=Vn,Object.defineProperty(Ye,"__esModule",{value:!0});var ot=Ye.Pos=Ye.PrimitivePos=void 0;const qr=G;class nr{constructor(t=0,r=0){this.x=t,this.y=r}normalize(){return new he(this.x,this.y)}}Ye.PrimitivePos=nr;class he extends nr{constructor(t=0,r=0){super(t,r),this.x=t,this.y=r}clone(){return new he(this.x,this.y)}addX(t){const r=this.clone();return r.x+=t,r}addY(t){const r=this.clone();return r.y+=t,r}add(t,r){return t instanceof he?this.addX(t.x).addY(t.y):this.addX(t).addY(r||0)}sub(t,r){return t instanceof he?this.add(-t.x,-t.y):this.add(-t,-(r||0))}toString(){return`{X: ${this.x}, Y: ${this.y}}`}asPrimitive(){return new nr(this.x,this.y)}set(t){return this.x=t.x,this.y=t.y,this}dist(t){return(0,qr.getDistance)(this,t)}dirTo(t){return(0,qr.getAngle)(this,t)}equals(t){return this.x==t.x&&this.y==t.y}mult(t){return new he(this.x*t.x,this.y*t.y)}multBy(t){return new he(this.x*t,this.y*t)}div(t){return new he(this.x/t.x,this.y/t.y)}}ot=Ye.Pos=he;class sr extends ot{constructor(){super(...arguments),this.x=-2,this.y=-2,this.sid=-2,this.id="NULL",this.dir=0,this.currentObject=-2,this.wep=-2,this.variant=-2,this.tribe="NULL",this.isLeader=!1,this.hat=-2,this.acc=-2,this.isSkull=!1,this.zIndex=-1,this.health=100,this.name="NULL",this.chatMessage=null,this.messageTimeout=-1}assign(t){this.x=t.x,this.y=t.y,this.sid=t.sid,this.dir=t.dir,this.currentObject=t.currentObject,this.wep=t.wep,this.variant=t.variant,this.tribe=t.tribe,this.isLeader=t.isLeader,this.hat=t.hat,this.acc=t.acc,this.isSkull=t.isSkull,this.zIndex=t.zIndex}getAsPos(){return this}}class Yn extends sr{constructor(){super(...arguments),this.weapons=[Ve.TOOL_HAMMER,void 0],this.items=[U.APPLE,U.WOOD_WALL,U.SPIKE,U.WINDMILL,void 0,void 0,void 0,void 0]}getFoodType(){return this.items[0]}getWallType(){return this.items[1]}getSpikeType(){return this.items[2]}getMillType(){return this.items[3]}searchForId(t){for(let r of this.items)if(r==t)return r;return null}getSapplingType(){return this.searchForId(U.SAPPLING)}getMineType(){return this.searchForId(U.MINE)}getSpecialType(){return this.searchForId(U.TURRET)||this.searchForId(U.BLOCKER)||this.searchForId(U.HEALING_PAD)||this.searchForId(U.PLATFORM)||this.searchForId(U.TELEPORTER)}getPadType(){return this.items[4]||null}getPrimaryType(){return this.weapons[0]}getSecondaryType(){return this.weapons[1]}}var ar={},or={},Xr={},wt={},X={},Jn=cr(typeof Buffer!="undefined"&&Buffer)||cr(rr.Buffer)||cr(typeof window!="undefined"&&window.Buffer)||rr.Buffer;function cr(e){return e&&e.isBuffer&&e}var qn={}.toString,lr=Array.isArray||function(e){return qn.call(e)=="[object Array]"},zr={exports:{}},Je=X,Rt=zr.exports=Zr(0);Rt.alloc=Zr,Rt.concat=Je.concat,Rt.from=Xn;function Zr(e){return new Array(e)}function Xn(e){if(!Je.isBuffer(e)&&Je.isView(e))e=Je.Uint8Array.from(e);else if(Je.isArrayBuffer(e))e=new Uint8Array(e);else{if(typeof e=="string")return Je.from.call(Rt,e);if(typeof e=="number")throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(e)}var Qr={exports:{}},pe=X,qe=pe.global,Bt=Qr.exports=pe.hasBuffer?ei(0):[];Bt.alloc=pe.hasBuffer&&qe.alloc||ei,Bt.concat=pe.concat,Bt.from=zn;function ei(e){return new qe(e)}function zn(e){if(!pe.isBuffer(e)&&pe.isView(e))e=pe.Uint8Array.from(e);else if(pe.isArrayBuffer(e))e=new Uint8Array(e);else{if(typeof e=="string")return pe.from.call(Bt,e);if(typeof e=="number")throw new TypeError('"value" argument must not be a number')}return qe.from&&qe.from.length!==1?qe.from(e):new qe(e)}var ti={exports:{}},St=X,_t=ti.exports=St.hasArrayBuffer?ri(0):[];_t.alloc=ri,_t.concat=St.concat,_t.from=Zn;function ri(e){return new Uint8Array(e)}function Zn(e){if(St.isView(e)){var t=e.byteOffset,r=e.byteLength;e=e.buffer,e.byteLength!==r&&(e.slice?e=e.slice(t,t+r):(e=new Uint8Array(e),e.byteLength!==r&&(e=Array.prototype.slice.call(e,t,t+r))))}else{if(typeof e=="string")return St.from.call(_t,e);if(typeof e=="number")throw new TypeError('"value" argument must not be a number')}return new Uint8Array(e)}var Le={},Lt={};Lt.copy=ts,Lt.toString=es,Lt.write=Qn;function Qn(e,t){for(var r=this,i=t||(t|=0),n=e.length,s=0,a=0;a<n;)s=e.charCodeAt(a++),s<128?r[i++]=s:s<2048?(r[i++]=192|s>>>6,r[i++]=128|s&63):s<55296||s>57343?(r[i++]=224|s>>>12,r[i++]=128|s>>>6&63,r[i++]=128|s&63):(s=(s-55296<<10|e.charCodeAt(a++)-56320)+65536,r[i++]=240|s>>>18,r[i++]=128|s>>>12&63,r[i++]=128|s>>>6&63,r[i++]=128|s&63);return i-t}function es(e,t,r){var i=this,n=t|0;r||(r=i.length);for(var s="",a=0;n<r;){if(a=i[n++],a<128){s+=String.fromCharCode(a);continue}(a&224)===192?a=(a&31)<<6|i[n++]&63:(a&240)===224?a=(a&15)<<12|(i[n++]&63)<<6|i[n++]&63:(a&248)===240&&(a=(a&7)<<18|(i[n++]&63)<<12|(i[n++]&63)<<6|i[n++]&63),a>=65536?(a-=65536,s+=String.fromCharCode((a>>>10)+55296,(a&1023)+56320)):s+=String.fromCharCode(a)}return s}function ts(e,t,r,i){var n;r||(r=0),!i&&i!==0&&(i=this.length),t||(t=0);var s=i-r;if(e===this&&r<t&&t<i)for(n=s-1;n>=0;n--)e[n+t]=this[n+r];else for(n=0;n<s;n++)e[n+t]=this[n+r];return s}var ur=Lt;Le.copy=ai,Le.slice=oi,Le.toString=rs,Le.write=is("write");var xe=X,ii=xe.global,ni=xe.hasBuffer&&"TYPED_ARRAY_SUPPORT"in ii,si=ni&&!ii.TYPED_ARRAY_SUPPORT;function ai(e,t,r,i){var n=xe.isBuffer(this),s=xe.isBuffer(e);if(n&&s)return this.copy(e,t,r,i);if(!si&&!n&&!s&&xe.isView(this)&&xe.isView(e)){var a=r||i!=null?oi.call(this,r,i):this;return e.set(a,t),a.length}else return ur.copy.call(this,e,t,r,i)}function oi(e,t){var r=this.slice||!si&&this.subarray;if(r)return r.call(this,e,t);var i=xe.alloc.call(this,t-e);return ai.call(this,i,0,e,t),i}function rs(e,t,r){var i=!ni&&xe.isBuffer(this)?this.toString:ur.toString;return i.apply(this,arguments)}function is(e){return t;function t(){var r=this[e]||ur[e];return r.apply(this,arguments)}}(function(e){var t=e.global=Jn,r=e.hasBuffer=t&&!!t.isBuffer,i=e.hasArrayBuffer=typeof ArrayBuffer!="undefined",n=e.isArray=lr;e.isArrayBuffer=i?K:J;var s=e.isBuffer=r?t.isBuffer:J,a=e.isView=i?ArrayBuffer.isView||ce("ArrayBuffer","buffer"):J;e.alloc=R,e.concat=y,e.from=h;var u=e.Array=zr.exports,c=e.Buffer=Qr.exports,x=e.Uint8Array=ti.exports,v=e.prototype=Le;function h(f){return typeof f=="string"?Y.call(this,f):oe(this).from(f)}function R(f){return oe(this).alloc(f)}function y(f,m){m||(m=0,Array.prototype.forEach.call(f,B));var M=this!==e&&this||f[0],w=R.call(M,m),p=0;return Array.prototype.forEach.call(f,o),w;function B(l){m+=l.length}function o(l){p+=v.copy.call(l,w,p)}}var A=ce("ArrayBuffer");function K(f){return f instanceof ArrayBuffer||A(f)}function Y(f){var m=f.length*3,M=R.call(this,m),w=v.write.call(M,f);return m!==w&&(M=v.slice.call(M,0,w)),M}function oe(f){return s(f)?c:a(f)?x:n(f)?u:r?c:i?x:u}function J(){return!1}function ce(f,m){return f="[object "+f+"]",function(M){return M!=null&&{}.toString.call(m?M[m]:M)===f}}})(X),wt.ExtBuffer=fr;var ns=X;function fr(e,t){if(!(this instanceof fr))return new fr(e,t);this.buffer=ns.from(e),this.type=t}var ci={};ci.setExtPackers=os;var Ot=X,ss=Ot.global,se=Ot.Uint8Array.from,dr,as={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function os(e){e.addExtPacker(14,Error,[Oe,ee]),e.addExtPacker(1,EvalError,[Oe,ee]),e.addExtPacker(2,RangeError,[Oe,ee]),e.addExtPacker(3,ReferenceError,[Oe,ee]),e.addExtPacker(4,SyntaxError,[Oe,ee]),e.addExtPacker(5,TypeError,[Oe,ee]),e.addExtPacker(6,URIError,[Oe,ee]),e.addExtPacker(10,RegExp,[cs,ee]),e.addExtPacker(11,Boolean,[hr,ee]),e.addExtPacker(12,String,[hr,ee]),e.addExtPacker(13,Date,[Number,ee]),e.addExtPacker(15,Number,[hr,ee]),typeof Uint8Array!="undefined"&&(e.addExtPacker(17,Int8Array,se),e.addExtPacker(18,Uint8Array,se),e.addExtPacker(19,Int16Array,se),e.addExtPacker(20,Uint16Array,se),e.addExtPacker(21,Int32Array,se),e.addExtPacker(22,Uint32Array,se),e.addExtPacker(23,Float32Array,se),typeof Float64Array!="undefined"&&e.addExtPacker(24,Float64Array,se),typeof Uint8ClampedArray!="undefined"&&e.addExtPacker(25,Uint8ClampedArray,se),e.addExtPacker(26,ArrayBuffer,se),e.addExtPacker(29,DataView,se)),Ot.hasBuffer&&e.addExtPacker(27,ss,Ot.from)}function ee(e){return dr||(dr=ar.encode),dr(e)}function hr(e){return e.valueOf()}function cs(e){e=RegExp.prototype.toString.call(e).split("/"),e.shift();var t=[e.pop()];return t.unshift(e.join("/")),t}function Oe(e){var t={};for(var r in as)t[r]=e[r];return t}var li={},Pt={};(function(e){(function(t){var r="undefined",i=r!==typeof Buffer&&Buffer,n=r!==typeof Uint8Array&&Uint8Array,s=r!==typeof ArrayBuffer&&ArrayBuffer,a=[0,0,0,0,0,0,0,0],u=Array.isArray||M,c=4294967296,x=16777216,v;h("Uint64BE",!0,!0),h("Int64BE",!0,!1),h("Uint64LE",!1,!0),h("Int64LE",!1,!1);function h(w,p,B){var o=p?0:4,l=p?4:0,d=p?0:3,P=p?1:2,I=p?2:1,Q=p?3:0,de=p?J:f,nt=p?ce:m,q=Be.prototype,Re="is"+w,Qt="_"+Re;return q.buffer=void 0,q.offset=0,q[Qt]=!0,q.toNumber=Pn,q.toString=zo,q.toJSON=Pn,q.toArray=R,i&&(q.toBuffer=y),n&&(q.toArrayBuffer=A),Be[Re]=Hr,t[w]=Be,Be;function Be(S,b,T,_){return this instanceof Be?qo(this,S,b,T,_):new Be(S,b,T,_)}function Hr(S){return!!(S&&S[Qt])}function qo(S,b,T,_,$){if(n&&s&&(b instanceof s&&(b=new n(b)),_ instanceof s&&(_=new n(_))),!b&&!T&&!_&&!v){S.buffer=oe(a,0);return}if(!K(b,T)){var ve=v||Array;$=T,_=b,T=0,b=new ve(8)}S.buffer=b,S.offset=T|=0,r!==typeof _&&(typeof _=="string"?Xo(b,T,_,$||10):K(_,$)?Y(b,T,_,$):typeof $=="number"?(er(b,T+o,_),er(b,T+l,$)):_>0?de(b,T,_):_<0?nt(b,T,_):Y(b,T,a,0))}function Xo(S,b,T,_){var $=0,ve=T.length,me=0,le=0;T[0]==="-"&&$++;for(var Zo=$;$<ve;){var kn=parseInt(T[$++],_);if(!(kn>=0))break;le=le*_+kn,me=me*_+Math.floor(le/c),le%=c}Zo&&(me=~me,le?le=c-le:me++),er(S,b+o,me),er(S,b+l,le)}function Pn(){var S=this.buffer,b=this.offset,T=tr(S,b+o),_=tr(S,b+l);return B||(T|=0),T?T*c+_:_}function zo(S){var b=this.buffer,T=this.offset,_=tr(b,T+o),$=tr(b,T+l),ve="",me=!B&&_&2147483648;for(me&&(_=~_,$=c-$),S=S||10;;){var le=_%S*c+$;if(_=Math.floor(_/S),$=Math.floor(le/S),ve=(le%S).toString(S)+ve,!_&&!$)break}return me&&(ve="-"+ve),ve}function er(S,b,T){S[b+Q]=T&255,T=T>>8,S[b+I]=T&255,T=T>>8,S[b+P]=T&255,T=T>>8,S[b+d]=T&255}function tr(S,b){return S[b+d]*x+(S[b+P]<<16)+(S[b+I]<<8)+S[b+Q]}}function R(w){var p=this.buffer,B=this.offset;return v=null,w!==!1&&B===0&&p.length===8&&u(p)?p:oe(p,B)}function y(w){var p=this.buffer,B=this.offset;if(v=i,w!==!1&&B===0&&p.length===8&&Buffer.isBuffer(p))return p;var o=new i(8);return Y(o,0,p,B),o}function A(w){var p=this.buffer,B=this.offset,o=p.buffer;if(v=n,w!==!1&&B===0&&o instanceof s&&o.byteLength===8)return o;var l=new n(8);return Y(l,0,p,B),l.buffer}function K(w,p){var B=w&&w.length;return p|=0,B&&p+8<=B&&typeof w[p]!="string"}function Y(w,p,B,o){p|=0,o|=0;for(var l=0;l<8;l++)w[p++]=B[o++]&255}function oe(w,p){return Array.prototype.slice.call(w,p,p+8)}function J(w,p,B){for(var o=p+8;o>p;)w[--o]=B&255,B/=256}function ce(w,p,B){var o=p+8;for(B++;o>p;)w[--o]=-B&255^255,B/=256}function f(w,p,B){for(var o=p+8;p<o;)w[p++]=B&255,B/=256}function m(w,p,B){var o=p+8;for(B++;p<o;)w[p++]=-B&255^255,B/=256}function M(w){return!!w&&Object.prototype.toString.call(w)=="[object Array]"}})(typeof e.nodeName!="string"?e:rr||{})})(Pt);var ui={},kt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */kt.read=function(e,t,r,i,n){var s,a,u=n*8-i-1,c=(1<<u)-1,x=c>>1,v=-7,h=r?n-1:0,R=r?-1:1,y=e[t+h];for(h+=R,s=y&(1<<-v)-1,y>>=-v,v+=u;v>0;s=s*256+e[t+h],h+=R,v-=8);for(a=s&(1<<-v)-1,s>>=-v,v+=i;v>0;a=a*256+e[t+h],h+=R,v-=8);if(s===0)s=1-x;else{if(s===c)return a?NaN:(y?-1:1)*(1/0);a=a+Math.pow(2,i),s=s-x}return(y?-1:1)*a*Math.pow(2,s-i)},kt.write=function(e,t,r,i,n,s){var a,u,c,x=s*8-n-1,v=(1<<x)-1,h=v>>1,R=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=i?0:s-1,A=i?1:-1,K=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=v):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+h>=1?t+=R/c:t+=R*Math.pow(2,1-h),t*c>=2&&(a++,c/=2),a+h>=v?(u=0,a=v):a+h>=1?(u=(t*c-1)*Math.pow(2,n),a=a+h):(u=t*Math.pow(2,h-1)*Math.pow(2,n),a=0));n>=8;e[r+y]=u&255,y+=A,u/=256,n-=8);for(a=a<<n|u,x+=n;x>0;e[r+y]=a&255,y+=A,a/=256,x-=8);e[r+y-A]|=K*128};for(var pr={},ls=pr.uint8=new Array(256),Nt=0;Nt<=255;Nt++)ls[Nt]=us(Nt);function us(e){return function(t){var r=t.reserve(1);t.buffer[r]=e}}var fi=kt,di=Pt,fs=di.Uint64BE,ds=di.Int64BE,hi=pr.uint8,Dt=X,C=Dt.global,hs=Dt.hasBuffer&&"TYPED_ARRAY_SUPPORT"in C,ps=hs&&!C.TYPED_ARRAY_SUPPORT,pi=Dt.hasBuffer&&C.prototype||{};ui.getWriteToken=Es;function Es(e){return e&&e.uint8array?gs():ps||Dt.hasBuffer&&e&&e.safe?vs():Ei()}function gs(){var e=Ei();return e[202]=k(202,4,mi),e[203]=k(203,8,xi),e}function Ei(){var e=hi.slice();return e[196]=ct(196),e[197]=Pe(197),e[198]=ke(198),e[199]=ct(199),e[200]=Pe(200),e[201]=ke(201),e[202]=k(202,4,pi.writeFloatBE||mi,!0),e[203]=k(203,8,pi.writeDoubleBE||xi,!0),e[204]=ct(204),e[205]=Pe(205),e[206]=ke(206),e[207]=k(207,8,gi),e[208]=ct(208),e[209]=Pe(209),e[210]=ke(210),e[211]=k(211,8,vi),e[217]=ct(217),e[218]=Pe(218),e[219]=ke(219),e[220]=Pe(220),e[221]=ke(221),e[222]=Pe(222),e[223]=ke(223),e}function vs(){var e=hi.slice();return e[196]=k(196,1,C.prototype.writeUInt8),e[197]=k(197,2,C.prototype.writeUInt16BE),e[198]=k(198,4,C.prototype.writeUInt32BE),e[199]=k(199,1,C.prototype.writeUInt8),e[200]=k(200,2,C.prototype.writeUInt16BE),e[201]=k(201,4,C.prototype.writeUInt32BE),e[202]=k(202,4,C.prototype.writeFloatBE),e[203]=k(203,8,C.prototype.writeDoubleBE),e[204]=k(204,1,C.prototype.writeUInt8),e[205]=k(205,2,C.prototype.writeUInt16BE),e[206]=k(206,4,C.prototype.writeUInt32BE),e[207]=k(207,8,gi),e[208]=k(208,1,C.prototype.writeInt8),e[209]=k(209,2,C.prototype.writeInt16BE),e[210]=k(210,4,C.prototype.writeInt32BE),e[211]=k(211,8,vi),e[217]=k(217,1,C.prototype.writeUInt8),e[218]=k(218,2,C.prototype.writeUInt16BE),e[219]=k(219,4,C.prototype.writeUInt32BE),e[220]=k(220,2,C.prototype.writeUInt16BE),e[221]=k(221,4,C.prototype.writeUInt32BE),e[222]=k(222,2,C.prototype.writeUInt16BE),e[223]=k(223,4,C.prototype.writeUInt32BE),e}function ct(e){return function(t,r){var i=t.reserve(2),n=t.buffer;n[i++]=e,n[i]=r}}function Pe(e){return function(t,r){var i=t.reserve(3),n=t.buffer;n[i++]=e,n[i++]=r>>>8,n[i]=r}}function ke(e){return function(t,r){var i=t.reserve(5),n=t.buffer;n[i++]=e,n[i++]=r>>>24,n[i++]=r>>>16,n[i++]=r>>>8,n[i]=r}}function k(e,t,r,i){return function(n,s){var a=n.reserve(t+1);n.buffer[a++]=e,r.call(n.buffer,s,a,i)}}function gi(e,t){new fs(this,t,e)}function vi(e,t){new ds(this,t,e)}function mi(e,t){fi.write(this,e,t,!1,23,4)}function xi(e,t){fi.write(this,e,t,!1,52,8)}var ms=lr,Ai=Pt,xs=Ai.Uint64BE,As=Ai.Int64BE,yi=X,bi=Le,ys=ui,bs=pr.uint8,Ts=wt.ExtBuffer,ws=typeof Uint8Array!="undefined",Rs=typeof Map!="undefined",Xe=[];Xe[1]=212,Xe[2]=213,Xe[4]=214,Xe[8]=215,Xe[16]=216,li.getWriteType=Bs;function Bs(e){var t=ys.getWriteToken(e),r=e&&e.useraw,i=ws&&e&&e.binarraybuffer,n=i?yi.isArrayBuffer:yi.isBuffer,s=i?m:f,a=Rs&&e&&e.usemap,u=a?p:w,c={boolean:x,function:J,number:v,object:r?oe:Y,string:K(r?A:y),symbol:J,undefined:J};return c;function x(o,l){var d=l?195:194;t[d](o,l)}function v(o,l){var d=l|0,P;if(l!==d){P=203,t[P](o,l);return}else-32<=d&&d<=127?P=d&255:0<=d?P=d<=255?204:d<=65535?205:206:P=-128<=d?208:-32768<=d?209:210;t[P](o,d)}function h(o,l){var d=207;t[d](o,l.toArray())}function R(o,l){var d=211;t[d](o,l.toArray())}function y(o){return o<32?1:o<=255?2:o<=65535?3:5}function A(o){return o<32?1:o<=65535?3:5}function K(o){return l;function l(d,P){var I=P.length,Q=5+I*3;d.offset=d.reserve(Q);var de=d.buffer,nt=o(I),q=d.offset+nt;I=bi.write.call(de,P,q);var Re=o(I);if(nt!==Re){var Qt=q+Re-nt,Be=q+I;bi.copy.call(de,de,Qt,q,Be)}var Hr=Re===1?160+I:Re<=3?215+Re:219;t[Hr](d,I),d.offset+=I}}function Y(o,l){if(l===null)return J(o,l);if(n(l))return s(o,l);if(ms(l))return ce(o,l);if(xs.isUint64BE(l))return h(o,l);if(As.isInt64BE(l))return R(o,l);var d=o.codec.getExtPacker(l);if(d&&(l=d(l)),l instanceof Ts)return M(o,l);u(o,l)}function oe(o,l){if(n(l))return B(o,l);Y(o,l)}function J(o,l){var d=192;t[d](o,l)}function ce(o,l){var d=l.length,P=d<16?144+d:d<=65535?220:221;t[P](o,d);for(var I=o.codec.encode,Q=0;Q<d;Q++)I(o,l[Q])}function f(o,l){var d=l.length,P=d<255?196:d<=65535?197:198;t[P](o,d),o.send(l)}function m(o,l){f(o,new Uint8Array(l))}function M(o,l){var d=l.buffer,P=d.length,I=Xe[P]||(P<255?199:P<=65535?200:201);t[I](o,P),bs[l.type](o),o.send(d)}function w(o,l){var d=Object.keys(l),P=d.length,I=P<16?128+P:P<=65535?222:223;t[I](o,P);var Q=o.codec.encode;d.forEach(function(de){Q(o,de),Q(o,l[de])})}function p(o,l){if(!(l instanceof Map))return w(o,l);var d=l.size,P=d<16?128+d:d<=65535?222:223;t[P](o,d);var I=o.codec.encode;l.forEach(function(Q,de,nt){I(o,de),I(o,Q)})}function B(o,l){var d=l.length,P=d<32?160+d:d<=65535?218:219;t[P](o,d),o.send(l)}}var Ne={},Ss=lr;Ne.createCodec=Ti,Ne.install=Ls,Ne.filter=ks;var _s=X;function ze(e){if(!(this instanceof ze))return new ze(e);this.options=e,this.init()}ze.prototype.init=function(){var e=this.options;return e&&e.uint8array&&(this.bufferish=_s.Uint8Array),this};function Ls(e){for(var t in e)ze.prototype[t]=Os(ze.prototype[t],e[t])}function Os(e,t){return e&&t?r:e||t;function r(){return e.apply(this,arguments),t.apply(this,arguments)}}function Ps(e){return e=e.slice(),function(r){return e.reduce(t,r)};function t(r,i){return i(r)}}function ks(e){return Ss(e)?Ps(e):e}function Ti(e){return new ze(e)}Ne.preset=Ti({preset:!0});var Ns=wt.ExtBuffer,Ds=ci,Ms=li,Er=Ne;Er.install({addExtPacker:Cs,getExtPacker:Fs,init:wi}),Xr.preset=wi.call(Er.preset);function Us(e){var t=Ms.getWriteType(e);return r;function r(i,n){var s=t[typeof n];if(!s)throw new Error('Unsupported type "'+typeof n+'": '+n);s(i,n)}}function wi(){var e=this.options;return this.encode=Us(e),e&&e.preset&&Ds.setExtPackers(this),this}function Cs(e,t,r){r=Er.filter(r);var i=t.name;if(i&&i!=="Object"){var n=this.extPackers||(this.extPackers={});n[i]=a}else{var s=this.extEncoderList||(this.extEncoderList=[]);s.unshift([t,a])}function a(u){return r&&(u=r(u)),new Ns(u,e)}}function Fs(e){var t=this.extPackers||(this.extPackers={}),r=e.constructor,i=r&&r.name&&t[r.name];if(i)return i;for(var n=this.extEncoderList||(this.extEncoderList=[]),s=n.length,a=0;a<s;a++){var u=n[a];if(r===u[0])return u[1]}}var Mt={};Mt.FlexDecoder=Ze,Mt.FlexEncoder=Qe;var lt=X,Gs=2048,Is=65536,Ri="BUFFER_SHORTAGE";function Ze(){if(!(this instanceof Ze))return new Ze}function Qe(){if(!(this instanceof Qe))return new Qe}Ze.mixin=_i(Hs()),Ze.mixin(Ze.prototype),Qe.mixin=_i(Ws()),Qe.mixin(Qe.prototype);function Hs(){return{bufferish:lt,write:e,fetch:Ks,flush:t,push:Si,pull:js,read:Bi,reserve:r,offset:0};function e(i){var n=this.offset?lt.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=n?i?this.bufferish.concat([n,i]):n:i,this.offset=0}function t(){for(;this.offset<this.buffer.length;){var i=this.offset,n;try{n=this.fetch()}catch(s){if(s&&s.message!=Ri)throw s;this.offset=i;break}this.push(n)}}function r(i){var n=this.offset,s=n+i;if(s>this.buffer.length)throw new Error(Ri);return this.offset=s,n}}function Ws(){return{bufferish:lt,write:$s,fetch:e,flush:t,push:Si,pull:r,read:Bi,reserve:i,send:n,maxBufferSize:Is,minBufferSize:Gs,offset:0,start:0};function e(){var s=this.start;if(s<this.offset){var a=this.start=this.offset;return lt.prototype.slice.call(this.buffer,s,a)}}function t(){for(;this.start<this.offset;){var s=this.fetch();s&&this.push(s)}}function r(){var s=this.buffers||(this.buffers=[]),a=s.length>1?this.bufferish.concat(s):s[0];return s.length=0,a}function i(s){var a=s|0;if(this.buffer){var u=this.buffer.length,c=this.offset|0,x=c+a;if(x<u)return this.offset=x,c;this.flush(),s=Math.max(s,Math.min(u*2,this.maxBufferSize))}return s=Math.max(s,this.minBufferSize),this.buffer=this.bufferish.alloc(s),this.start=0,this.offset=a,0}function n(s){var a=s.length;if(a>this.minBufferSize)this.flush(),this.push(s);else{var u=this.reserve(a);lt.prototype.copy.call(s,this.buffer,u)}}}function $s(){throw new Error("method not implemented: write()")}function Ks(){throw new Error("method not implemented: fetch()")}function Bi(){var e=this.buffers&&this.buffers.length;return e?(this.flush(),this.pull()):this.fetch()}function Si(e){var t=this.buffers||(this.buffers=[]);t.push(e)}function js(){var e=this.buffers||(this.buffers=[]);return e.shift()}function _i(e){return t;function t(r){for(var i in e)r[i]=e[i];return r}}or.EncodeBuffer=et;var Vs=Xr.preset,Ys=Mt.FlexEncoder;Ys.mixin(et.prototype);function et(e){if(!(this instanceof et))return new et(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}et.prototype.codec=Vs,et.prototype.write=function(e){this.codec.encode(this,e)},ar.encode=qs;var Js=or.EncodeBuffer;function qs(e,t){var r=new Js(t);return r.write(e),r.read()}var gr={},vr={},Li={},Oi={};Oi.setExtUnpackers=Zs;var Pi=X,Xs=Pi.global,mr,zs={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function Zs(e){e.addExtUnpacker(14,[te,De(Error)]),e.addExtUnpacker(1,[te,De(EvalError)]),e.addExtUnpacker(2,[te,De(RangeError)]),e.addExtUnpacker(3,[te,De(ReferenceError)]),e.addExtUnpacker(4,[te,De(SyntaxError)]),e.addExtUnpacker(5,[te,De(TypeError)]),e.addExtUnpacker(6,[te,De(URIError)]),e.addExtUnpacker(10,[te,Qs]),e.addExtUnpacker(11,[te,j(Boolean)]),e.addExtUnpacker(12,[te,j(String)]),e.addExtUnpacker(13,[te,j(Date)]),e.addExtUnpacker(15,[te,j(Number)]),typeof Uint8Array!="undefined"&&(e.addExtUnpacker(17,j(Int8Array)),e.addExtUnpacker(18,j(Uint8Array)),e.addExtUnpacker(19,[Ae,j(Int16Array)]),e.addExtUnpacker(20,[Ae,j(Uint16Array)]),e.addExtUnpacker(21,[Ae,j(Int32Array)]),e.addExtUnpacker(22,[Ae,j(Uint32Array)]),e.addExtUnpacker(23,[Ae,j(Float32Array)]),typeof Float64Array!="undefined"&&e.addExtUnpacker(24,[Ae,j(Float64Array)]),typeof Uint8ClampedArray!="undefined"&&e.addExtUnpacker(25,j(Uint8ClampedArray)),e.addExtUnpacker(26,Ae),e.addExtUnpacker(29,[Ae,j(DataView)])),Pi.hasBuffer&&e.addExtUnpacker(27,j(Xs))}function te(e){return mr||(mr=gr.decode),mr(e)}function Qs(e){return RegExp.apply(null,e)}function De(e){return function(t){var r=new e;for(var i in zs)r[i]=t[i];return r}}function j(e){return function(t){return new e(t)}}function Ae(e){return new Uint8Array(e).buffer}var Ut={},ki=kt,Ni=Pt,Di=Ni.Uint64BE,Mi=Ni.Int64BE;Ut.getReadFormat=ra,Ut.readUint8=Ui;var xr=X,Ct=Le,ea=typeof Map!="undefined",ta=!0;function ra(e){var t=xr.hasArrayBuffer&&e&&e.binarraybuffer,r=e&&e.int64,i=ea&&e&&e.usemap,n={map:i?na:ia,array:sa,str:aa,bin:t?ca:oa,ext:la,uint8:Ui,uint16:fa,uint32:ha,uint64:Ft(8,r?va:Ea),int8:ua,int16:da,int32:pa,int64:Ft(8,r?ma:ga),float32:Ft(4,xa),float64:Ft(8,Aa)};return n}function ia(e,t){var r={},i,n=new Array(t),s=new Array(t),a=e.codec.decode;for(i=0;i<t;i++)n[i]=a(e),s[i]=a(e);for(i=0;i<t;i++)r[n[i]]=s[i];return r}function na(e,t){var r=new Map,i,n=new Array(t),s=new Array(t),a=e.codec.decode;for(i=0;i<t;i++)n[i]=a(e),s[i]=a(e);for(i=0;i<t;i++)r.set(n[i],s[i]);return r}function sa(e,t){for(var r=new Array(t),i=e.codec.decode,n=0;n<t;n++)r[n]=i(e);return r}function aa(e,t){var r=e.reserve(t),i=r+t;return Ct.toString.call(e.buffer,"utf-8",r,i)}function oa(e,t){var r=e.reserve(t),i=r+t,n=Ct.slice.call(e.buffer,r,i);return xr.from(n)}function ca(e,t){var r=e.reserve(t),i=r+t,n=Ct.slice.call(e.buffer,r,i);return xr.Uint8Array.from(n).buffer}function la(e,t){var r=e.reserve(t+1),i=e.buffer[r++],n=r+t,s=e.codec.getExtUnpacker(i);if(!s)throw new Error("Invalid ext type: "+(i&&"0x"+i.toString(16)));var a=Ct.slice.call(e.buffer,r,n);return s(a)}function Ui(e){var t=e.reserve(1);return e.buffer[t]}function ua(e){var t=e.reserve(1),r=e.buffer[t];return r&128?r-256:r}function fa(e){var t=e.reserve(2),r=e.buffer;return r[t++]<<8|r[t]}function da(e){var t=e.reserve(2),r=e.buffer,i=r[t++]<<8|r[t];return i&32768?i-65536:i}function ha(e){var t=e.reserve(4),r=e.buffer;return r[t++]*16777216+(r[t++]<<16)+(r[t++]<<8)+r[t]}function pa(e){var t=e.reserve(4),r=e.buffer;return r[t++]<<24|r[t++]<<16|r[t++]<<8|r[t]}function Ft(e,t){return function(r){var i=r.reserve(e);return t.call(r.buffer,i,ta)}}function Ea(e){return new Di(this,e).toNumber()}function ga(e){return new Mi(this,e).toNumber()}function va(e){return new Di(this,e)}function ma(e){return new Mi(this,e)}function xa(e){return ki.read(this,e,!1,23,4)}function Aa(e){return ki.read(this,e,!1,52,8)}var Ci={},ya=Ut;Ci.getReadToken=ba;function ba(e){var t=ya.getReadFormat(e);return e&&e.useraw?Ta(t):Fi(t)}function Fi(e){var t,r=new Array(256);for(t=0;t<=127;t++)r[t]=ut(t);for(t=128;t<=143;t++)r[t]=Ee(t-128,e.map);for(t=144;t<=159;t++)r[t]=Ee(t-144,e.array);for(t=160;t<=191;t++)r[t]=Ee(t-160,e.str);for(r[192]=ut(null),r[193]=null,r[194]=ut(!1),r[195]=ut(!0),r[196]=z(e.uint8,e.bin),r[197]=z(e.uint16,e.bin),r[198]=z(e.uint32,e.bin),r[199]=z(e.uint8,e.ext),r[200]=z(e.uint16,e.ext),r[201]=z(e.uint32,e.ext),r[202]=e.float32,r[203]=e.float64,r[204]=e.uint8,r[205]=e.uint16,r[206]=e.uint32,r[207]=e.uint64,r[208]=e.int8,r[209]=e.int16,r[210]=e.int32,r[211]=e.int64,r[212]=Ee(1,e.ext),r[213]=Ee(2,e.ext),r[214]=Ee(4,e.ext),r[215]=Ee(8,e.ext),r[216]=Ee(16,e.ext),r[217]=z(e.uint8,e.str),r[218]=z(e.uint16,e.str),r[219]=z(e.uint32,e.str),r[220]=z(e.uint16,e.array),r[221]=z(e.uint32,e.array),r[222]=z(e.uint16,e.map),r[223]=z(e.uint32,e.map),t=224;t<=255;t++)r[t]=ut(t-256);return r}function Ta(e){var t,r=Fi(e).slice();for(r[217]=r[196],r[218]=r[197],r[219]=r[198],t=160;t<=191;t++)r[t]=Ee(t-160,e.bin);return r}function ut(e){return function(){return e}}function z(e,t){return function(r){var i=e(r);return t(r,i)}}function Ee(e,t){return function(r){return t(r,e)}}var wa=wt.ExtBuffer,Ra=Oi,Ba=Ut.readUint8,Sa=Ci,Ar=Ne;Ar.install({addExtUnpacker:La,getExtUnpacker:Oa,init:Gi}),Li.preset=Gi.call(Ar.preset);function _a(e){var t=Sa.getReadToken(e);return r;function r(i){var n=Ba(i),s=t[n];if(!s)throw new Error("Invalid type: "+(n&&"0x"+n.toString(16)));return s(i)}}function Gi(){var e=this.options;return this.decode=_a(e),e&&e.preset&&Ra.setExtUnpackers(this),this}function La(e,t){var r=this.extUnpackers||(this.extUnpackers=[]);r[e]=Ar.filter(t)}function Oa(e){var t=this.extUnpackers||(this.extUnpackers=[]);return t[e]||r;function r(i){return new wa(i,e)}}vr.DecodeBuffer=tt;var Pa=Li.preset,ka=Mt.FlexDecoder;ka.mixin(tt.prototype);function tt(e){if(!(this instanceof tt))return new tt(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}tt.prototype.codec=Pa,tt.prototype.fetch=function(){return this.codec.decode(this)},gr.decode=Da;var Na=vr.DecodeBuffer;function Da(e,t){var r=new Na(t);return r.write(e),r.read()}var yr={exports:{}};/**
 * event-lite.js - Light-weight EventEmitter (less than 1KB when gzipped)
 *
 * @copyright Yusuke Kawasaki
 * @license MIT
 * @constructor
 * @see https://github.com/kawanet/event-lite
 * @see http://kawanet.github.io/event-lite/EventLite.html
 * @example
 * var EventLite = require("event-lite");
 *
 * function MyClass() {...}             // your class
 *
 * EventLite.mixin(MyClass.prototype);  // import event methods
 *
 * var obj = new MyClass();
 * obj.on("foo", function() {...});     // add event listener
 * obj.once("bar", function() {...});   // add one-time event listener
 * obj.emit("foo");                     // dispatch event
 * obj.emit("bar");                     // dispatch another event
 * obj.off("foo");                      // remove event listener
 */(function(e){function t(){if(!(this instanceof t))return new t}(function(r){e.exports=r;var i="listeners",n={on:a,once:u,off:c,emit:x};s(r.prototype),r.mixin=s;function s(h){for(var R in n)h[R]=n[R];return h}function a(h,R){return v(this,h).push(R),this}function u(h,R){var y=this;return A.originalListener=R,v(y,h).push(A),y;function A(){c.call(y,h,A),R.apply(this,arguments)}}function c(h,R){var y=this,A;if(!arguments.length)delete y[i];else if(R){if(A=v(y,h,!0),A){if(A=A.filter(K),!A.length)return c.call(y,h);y[i][h]=A}}else if(A=y[i],A&&(delete A[h],!Object.keys(A).length))return c.call(y);return y;function K(Y){return Y!==R&&Y.originalListener!==R}}function x(h,R){var y=this,A=v(y,h,!0);if(!A)return!1;var K=arguments.length;if(K===1)A.forEach(oe);else if(K===2)A.forEach(J);else{var Y=Array.prototype.slice.call(arguments,1);A.forEach(ce)}return!!A.length;function oe(f){f.call(y)}function J(f){f.call(y,R)}function ce(f){f.apply(y,Y)}}function v(h,R,y){if(!(y&&!h[i])){var A=h[i]||(h[i]={});return A[R]||(A[R]=[])}}})(t)})(yr);var Ma=yr.exports,Ii=or.EncodeBuffer;function rt(e){if(!(this instanceof rt))return new rt(e);Ii.call(this,e)}rt.prototype=new Ii,Ma.mixin(rt.prototype),rt.prototype.encode=function(e){this.write(e),this.emit("data",this.read())},rt.prototype.end=function(e){arguments.length&&this.encode(e),this.flush(),this.emit("end")};var Ua=yr.exports,Hi=vr.DecodeBuffer;function Me(e){if(!(this instanceof Me))return new Me(e);Hi.call(this,e)}Me.prototype=new Hi,Ua.mixin(Me.prototype),Me.prototype.decode=function(e){arguments.length&&this.write(e),this.flush()},Me.prototype.push=function(e){this.emit("data",e)},Me.prototype.end=function(e){this.decode(e),this.emit("end")},Ne.preset;var br=ar.encode,Gt=gr.decode,It;(function(e){e[e.BROWN=0]="BROWN",e[e.BEIGE=1]="BEIGE",e[e.DARKBROWN=2]="DARKBROWN",e[e.PEACH=3]="PEACH",e[e.WHITE=4]="WHITE",e[e.RED=5]="RED",e[e.BLACK=6]="BLACK",e[e.PINK=7]="PINK",e[e.BLUE=8]="BLUE",e[e.GREEN=9]="GREEN",e.SECRETLIGHTBLUE="length"})(It||(It={}));class Wi{constructor(t,r,i){this.cb=t,this.msInterval=r,this.code=i,this.intervalId=null}start(t){this.code!=t||this.intervalId!=null||(this.intervalId=setInterval(this.cb,this.msInterval))}stop(t){this.code!=t||this.intervalId==null||(clearInterval(this.intervalId),this.intervalId=null)}}class Ca extends ot{constructor(t,r,i,n,s,a,u,c){super(r,i),this.sid=t,this.dir=n,this.scale=s,this.type=a,this.buildType=u,this.ownerSid=c}}var ft;(function(e){e[e.PLAYERLEAVE=0]="PLAYERLEAVE",e[e.BUILDINGBREAK=1]="BUILDINGBREAK"})(ft||(ft={}));var H;(function(e){e[e.SHAME=45]="SHAME",e[e.MOO_CAP=51]="MOO_CAP",e[e.APPLE_CAP=50]="APPLE_CAP",e[e.MOO_HEAD=28]="MOO_HEAD",e[e.PIG_HEAD=29]="PIG_HEAD",e[e.FLUFF_HEAD=30]="FLUFF_HEAD",e[e.PANDOU_HEAD=36]="PANDOU_HEAD",e[e.BEAR_HEAD=37]="BEAR_HEAD",e[e.MONKEY_HEAD=38]="MONKEY_HEAD",e[e.POLAR_HEAD=44]="POLAR_HEAD",e[e.FEZ_HAT=35]="FEZ_HAT",e[e.ENIGMA_HAT=42]="ENIGMA_HAT",e[e.BLITZ_HAT=43]="BLITZ_HAT",e[e.BOB_XIII_HAT=49]="BOB_XIII_HAT",e[e.PUMPKIN=57]="PUMPKIN",e[e.BUMMLE_HAT=8]="BUMMLE_HAT",e[e.STRAW_HAT=2]="STRAW_HAT",e[e.WINTER_CAP=16]="WINTER_CAP",e[e.COWBOY_HAT=5]="COWBOY_HAT",e[e.RANGER_HAT=4]="RANGER_HAT",e[e.EXPLORER_HAT=18]="EXPLORER_HAT",e[e.FLIPPER_HAT=31]="FLIPPER_HAT",e[e.MARKSMAN_CAP=1]="MARKSMAN_CAP",e[e.BUSH_GEAR=10]="BUSH_GEAR",e[e.HALO=48]="HALO",e[e.SOLDIER_HELMET=6]="SOLDIER_HELMET",e[e.ANTI_VENOM_GEAR=23]="ANTI_VENOM_GEAR",e[e.MEDIC_GEAR=13]="MEDIC_GEAR",e[e.MINERS_HELMET=9]="MINERS_HELMET",e[e.MUSKETEER_HAT=32]="MUSKETEER_HAT",e[e.BULL_HELMET=7]="BULL_HELMET",e[e.EMP_HELMET=22]="EMP_HELMET",e[e.BOOSTER_HAT=12]="BOOSTER_HAT",e[e.BARBARIAN_ARMOR=26]="BARBARIAN_ARMOR",e[e.PLAGUE_MASK=21]="PLAGUE_MASK",e[e.BULL_MASK=46]="BULL_MASK",e[e.WINDMILL_HAT=14]="WINDMILL_HAT",e[e.SPIKE_GEAR=11]="SPIKE_GEAR",e[e.TURRET_GEAR=53]="TURRET_GEAR",e[e.SAMURAI_ARMOR=20]="SAMURAI_ARMOR",e[e.DARK_KNIGHT=58]="DARK_KNIGHT",e[e.SCAVENGER_GEAR=27]="SCAVENGER_GEAR",e[e.TANK_GEAR=40]="TANK_GEAR",e[e.THIEF_GEAR=40]="THIEF_GEAR",e[e.BLOODTHIRSTER=55]="BLOODTHIRSTER",e[e.Assassin_GEAR=56]="Assassin_GEAR",e[e.NONE=0]="NONE"})(H||(H={}));const Fa=[{id:45,name:"Shame!",dontSell:!0,price:0,scale:120,desc:"hacks are for losers"},{id:51,name:"Moo Cap",price:0,scale:120,desc:"coolest mooer around"},{id:50,name:"Apple Cap",price:0,scale:120,desc:"apple farms remembers"},{id:28,name:"Moo Head",price:0,scale:120,desc:"no effect"},{id:29,name:"Pig Head",price:0,scale:120,desc:"no effect"},{id:30,name:"Fluff Head",price:0,scale:120,desc:"no effect"},{id:36,name:"Pandou Head",price:0,scale:120,desc:"no effect"},{id:37,name:"Bear Head",price:0,scale:120,desc:"no effect"},{id:38,name:"Monkey Head",price:0,scale:120,desc:"no effect"},{id:44,name:"Polar Head",price:0,scale:120,desc:"no effect"},{id:35,name:"Fez Hat",price:0,scale:120,desc:"no effect"},{id:42,name:"Enigma Hat",price:0,scale:120,desc:"join the enigma army"},{id:43,name:"Blitz Hat",price:0,scale:120,desc:"hey everybody i'm blitz"},{id:49,name:"Bob XIII Hat",price:0,scale:120,desc:"like and subscribe"},{id:57,name:"Pumpkin",price:50,scale:120,desc:"Spooooky"},{id:8,name:"Bummle Hat",price:100,scale:120,desc:"no effect"},{id:2,name:"Straw Hat",price:500,scale:120,desc:"no effect"},{id:16,name:"Winter Cap",price:600,scale:120,desc:"allows you to move at normal speed in snow",coldM:1},{id:5,name:"Cowboy Hat",price:1e3,scale:120,desc:"no effect"},{id:4,name:"Ranger Hat",price:2e3,scale:120,desc:"no effect"},{id:18,name:"Explorer Hat",price:2e3,scale:120,desc:"no effect"},{id:31,name:"Flipper Hat",price:2500,scale:120,desc:"have more control while in water",watrImm:!0},{id:1,name:"Marksman Cap",price:3e3,scale:120,desc:"increases arrow speed and range",aMlt:1.3},{id:10,name:"Bush Gear",price:3e3,scale:160,desc:"allows you to disguise yourself as a bush"},{id:48,name:"Halo",price:3e3,scale:120,desc:"no effect"},{id:6,name:"Soldier Helmet",price:4e3,scale:120,desc:"reduces damage taken but slows movement",spdMult:.94,dmgMult:.75},{id:23,name:"Anti Venom Gear",price:4e3,scale:120,desc:"makes you immune to poison",poisonRes:1},{id:13,name:"Medic Gear",price:5e3,scale:110,desc:"slowly regenerates health over time",healthRegen:3},{id:9,name:"Miners Helmet",price:5e3,scale:120,desc:"earn 1 extra gold per resource",extraGold:1},{id:32,name:"Musketeer Hat",price:5e3,scale:120,desc:"reduces cost of projectiles",projCost:.5},{id:7,name:"Bull Helmet",price:6e3,scale:120,desc:"increases damage done but drains health",healthRegen:-5,dmgMultO:1.5,spdMult:.96},{id:22,name:"Emp Helmet",price:6e3,scale:120,desc:"turrets won't attack but you move slower",antiTurret:1,spdMult:.7},{id:12,name:"Booster Hat",price:6e3,scale:120,desc:"increases your movement speed",spdMult:1.16},{id:26,name:"Barbarian Armor",price:8e3,scale:120,desc:"knocks back enemies that attack you",dmgK:.6},{id:21,name:"Plague Mask",price:1e4,scale:120,desc:"melee attacks deal poison damage",poisonDmg:5,poisonTime:6},{id:46,name:"Bull Mask",price:1e4,scale:120,desc:"bulls won't target you unless you attack them",bullRepel:1},{id:14,name:"Windmill Hat",topSprite:!0,price:1e4,scale:120,desc:"generates points while worn",pps:1.5},{id:11,name:"Spike Gear",topSprite:!0,price:1e4,scale:120,desc:"deal damage to players that damage you",dmg:.45},{id:53,name:"Turret Gear",topSprite:!0,price:1e4,scale:120,desc:"you become a walking turret",turret:{proj:1,range:700,rate:2500},spdMult:.7},{id:20,name:"Samurai Armor",price:12e3,scale:120,desc:"increased attack speed and fire rate",atkSpd:.78},{id:58,name:"Dark Knight",price:12e3,scale:120,desc:"restores health when you deal damage",healD:.4},{id:27,name:"Scavenger Gear",price:15e3,scale:120,desc:"earn double points for each kill",kScrM:2},{id:40,name:"Tank Gear",price:15e3,scale:120,desc:"increased damage to buildings but slower movement",spdMult:.3,bDmg:3.3},{id:52,name:"Thief Gear",price:15e3,scale:120,desc:"steal half of a players gold when you kill them",goldSteal:.5},{id:55,name:"Bloodthirster",price:2e4,scale:120,desc:"Restore Health when dealing damage. And increased damage",healD:.25,dmgMultO:1.2},{id:56,name:"Assassin Gear",price:2e4,scale:120,desc:"Go invisible when not moving. Can't eat. Increased speed",noEat:!0,spdMult:1.1,invisTimer:1e3}];var ae;(function(e){e[e.SNOWBALL=12]="SNOWBALL",e[e.TREE_CAPE=9]="TREE_CAPE",e[e.STONE_CAPE=10]="STONE_CAPE",e[e.COOKIE_CAPE=3]="COOKIE_CAPE",e[e.COW_CAPE=8]="COW_CAPE",e[e.MONKEY_TAIL=11]="MONKEY_TAIL",e[e.APPLE_BASKET=17]="APPLE_BASKET",e[e.WINTER_CAPE=6]="WINTER_CAPE",e[e.SKULL_CAPE=4]="SKULL_CAPE",e[e.DASH_CAPE=5]="DASH_CAPE",e[e.DRAGON_CAPE=2]="DRAGON_CAPE",e[e.SUPER_CAPE=1]="SUPER_CAPE",e[e.TROLL_CAPE=7]="TROLL_CAPE",e[e.THORNS=14]="THORNS",e[e.BLOCKADES=15]="BLOCKADES",e[e.DEVILS_TAIL=20]="DEVILS_TAIL",e[e.SAWBLADE=16]="SAWBLADE",e[e.ANGEL_WINGS=13]="ANGEL_WINGS",e[e.SHADOW_WINGS=19]="SHADOW_WINGS",e[e.BLOOD_WINGS=18]="BLOOD_WINGS",e[e.CORRUPT_X_WINGS=21]="CORRUPT_X_WINGS",e[e.NONE=0]="NONE"})(ae||(ae={}));const Ga=[{id:12,name:"Snowball",price:1e3,scale:105,xOff:18,desc:"no effect"},{id:9,name:"Tree Cape",price:1e3,scale:90,desc:"no effect"},{id:10,name:"Stone Cape",price:1e3,scale:90,desc:"no effect"},{id:3,name:"Cookie Cape",price:1500,scale:90,desc:"no effect"},{id:8,name:"Cow Cape",price:2e3,scale:90,desc:"no effect"},{id:11,name:"Monkey Tail",price:2e3,scale:97,xOff:25,desc:"Super speed but reduced damage",spdMult:1.35,dmgMultO:.2},{id:17,name:"Apple Basket",price:3e3,scale:80,xOff:12,desc:"slowly regenerates health over time",healthRegen:1},{id:6,name:"Winter Cape",price:3e3,scale:90,desc:"no effect"},{id:4,name:"Skull Cape",price:4e3,scale:90,desc:"no effect"},{id:5,name:"Dash Cape",price:5e3,scale:90,desc:"no effect"},{id:2,name:"Dragon Cape",price:6e3,scale:90,desc:"no effect"},{id:1,name:"Super Cape",price:8e3,scale:90,desc:"no effect"},{id:7,name:"Troll Cape",price:8e3,scale:90,desc:"no effect"},{id:14,name:"Thorns",price:1e4,scale:115,xOff:20,desc:"no effect"},{id:15,name:"Blockades",price:1e4,scale:95,xOff:15,desc:"no effect"},{id:20,name:"Devils Tail",price:1e4,scale:95,xOff:20,desc:"no effect"},{id:16,name:"Sawblade",price:12e3,scale:90,spin:!0,xOff:0,desc:"deal damage to players that damage you",dmg:.15},{id:13,name:"Angel Wings",price:15e3,scale:138,xOff:22,desc:"slowly regenerates health over time",healthRegen:3},{id:19,name:"Shadow Wings",price:15e3,scale:138,xOff:22,desc:"increased movement speed",spdMult:1.1},{id:18,name:"Blood Wings",price:2e4,scale:178,xOff:26,desc:"restores health when you deal damage",healD:.2},{id:21,name:"Corrupt X Wings",price:2e4,scale:178,xOff:26,desc:"deal damage to players that damage you",dmg:.25}];var $i;(function(e){e[e.ARROW=0]="ARROW",e[e.TURRET_BULLET=1]="TURRET_BULLET",e[e.CROSSBOW_ARROW=2]="CROSSBOW_ARROW",e[e.REPEATER_ARROW=3]="REPEATER_ARROW",e[e.UNKOWN_PROJECTILE=4]="UNKOWN_PROJECTILE",e[e.MUSKET_BULLET=5]="MUSKET_BULLET"})($i||($i={}));class Ia{constructor(t,r,i,n,s,a,u,c){this.x=t,this.y=r,this.dir=i,this.range=n,this.speed=s,this.projectileType=a,this.layer=u,this.sid=c}getAsPos(){return new ot(this.x,this.y)}}class Ki{constructor(t,r,i=!1){Tt(this,"name");Tt(this,"cb");Tt(this,"once");this.name=t,this.cb=r,this.once=i}}class Ha{constructor(){Tt(this,"events",[])}on(t,r){return this.events.push(new Ki(t,r)),r}once(t,r){return this.events.push(new Ki(t,r,!0)),r}emit(t,r){for(let i=0;i<this.events.length;i++){const n=this.events[i];n.name==t&&(n.cb(r),n.once&&(this.events.splice(i,1),i--))}}removeEvent(t,r){this.events.forEach(i=>{i.name==t&&i.cb==r&&(i.once=!0)})}off(t,r){this.events.forEach(i=>{i.name==t&&i.cb==r&&(i.once=!0)})}wait(t){return new Promise(r=>{const i=n=>{r(n)};this.on(t,i),this.off(t,i)})}}var Tr=Ha,Wa=Date.now();const ne=class extends Tr{constructor(t=!1){super(),this.socket=null,this.player=new Yn,this.players=[],this.gameObjects=[],this.alive=!1,this.hatsOwned={},this.accessoriesOwned={},this.projectiles=[],this.isAutoAtk=!1;const r=this;if(t)Object.defineProperty(WebSocket.prototype,"hiddenSend",{value:WebSocket.prototype.send}),Object.defineProperty(WebSocket.prototype,"send",{value:function(i){r.socket==null&&(r.socket=this);const n=new Wr(Gt(new Uint8Array(i)));if(r.emit("packetSend",n),n.isCanceled)return;n.type==L.SPAWN&&(r.alive=!0),this.hiddenSend(i)}});else{class i extends WebSocket{hiddenSend(s){super.send(s)}constructor(s){super(s),this.send=a=>{const u=new Wr(Gt(new Uint8Array(a)));r.emit("packetSend",u),!u.isCanceled&&(u.type==L.SPAWN?r.alive=!0:u.type==L.SET_ATTACK_STATE&&u.payload[0]&&(r.isAutoAtk=!r.isAutoAtk),this.hiddenSend(a))},r.socket=this,r.initSocket()}}Object.defineProperty(window,"WebSocket",{value:i})}Fa.forEach(i=>{i.price<=0&&!i.dontSell&&(this.hatsOwned[i.id]=!0)}),Ga.forEach(i=>{i.price<=0&&(this.accessoriesOwned[i.id]=!0)})}initSocket(){var t;(t=this.socket)==null||t.addEventListener("message",r=>{const i=new Se(Gt(new Uint8Array(r.data)));this.emit("packetReceive",i);const n=i.payload;switch(i.type){case F.HEALTH:const c=n[0];this.emit("health",new Nn(c,n[1])),this.players[c].health=n[1];break;case F.INIT:this.player.id=n[0];break;case F.SET_SID:this.players[n[0]]=this.player,this.player.sid=n[0];break;case F.UPDAE_PLAYERS:var a=[];const x=Date.now();for(const f of this.projectiles)f.range-=(x-Wa)*f.speed,f.range<=0&&this.removeProjectile(f.sid);for(let f=0;f<n[0].length;f+=13){const m=n[0].slice(f,f+13),M={sid:m[0],x:m[1],y:m[2],dir:m[3],currentObject:m[4],wep:m[5],variant:m[6],tribe:m[7],isLeader:m[8],hat:m[9],acc:m[10],isSkull:m[11],zIndex:m[12]};this.players[M.sid]||(console.warn("Ran into unpredicted circumstance current player cannot be found, IPlayerDat, this.players, IPlayerDat.sid",M,this.players,M.sid),this.players[M.sid]=new sr),this.emit("updatePlayer",M),this.players[M.sid].assign(M),a.push(M)}this.emit("serverTick",new Un(a));break;case F.REMOVE_PLAYER:const v=this.getPlayerById(n[0]);v&&(this.emit("playerLeave",new $r(v)),delete this.players[v.sid]);break;case F.ADD_PLAYER:const h=n[0],R=h[1];var u=this.player;R!=this.player.sid&&(u=new sr),u.sid=R,u.id=h[0],u.name=h[2],u.x=h[3],u.y=h[4],this.players[R]=u,this.emit("addPlayer",new $r(u));break;case F.ADD_OBJECT:for(let f=0;f<n[0].length;f+=8){const m=n[0].slice(f,f+8),M=new Ca(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7]);this.gameObjects.push(M),this.emit("addObject",new Dn(M))}break;case F.REMOVE_OBJECT:for(let f=0;f<this.gameObjects.length;f++){const m=this.gameObjects[f];m.sid==n[0]&&(this.gameObjects.splice(f,1),this.emit("removeObject",new jr(m,ft.BUILDINGBREAK)))}break;case F.REMOVE_ALL_OBJECTS:for(let f=0;f<this.gameObjects.length;f++){const m=this.gameObjects[f];m.ownerSid==n[0]&&(this.emit("removeObject",new jr(m,ft.PLAYERLEAVE)),this.gameObjects.splice(f,1))}break;case F.SET_ITEMS_BAR:n[0]&&(n[1]?this.player.weapons=n[0]:this.player.items=n[0]);break;case F.DEATH:this.isAutoAtk=!1,this.player.weapons=[Ve.TOOL_HAMMER,void 0],this.player.items=[U.APPLE,U.WOOD_WALL,U.SPIKE,U.WINDMILL,void 0,void 0,void 0,void 0];break;case F.CHAT:const y=n[0],A=this.getPlayerBySid(y);if(A==null)return;const K=n[1];clearTimeout(A.messageTimeout),A.chatMessage=K,A.messageTimeout=setTimeout(()=>{A.chatMessage=null},3e3),this.emit("chat",new Mn(y,K));break;case F.UPDATE_SHOP:if(n[0])break;const oe=n[2],J=n[1];oe?this.accessoriesOwned[J]=!0:this.hatsOwned[J]=!0;break;case F.ADD_PROJECTILE:const ce=new Ia(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);this.emit("addProjectile",new Cn(ce)),this.projectiles.push(ce);break;case F.REMOVE_PROJECTILE:this.removeProjectile(n[0]);break}})}getPlayerById(t){for(let r of this.players)if((r==null?void 0:r.id)==t)return r;return null}getPlayerBySid(t){for(let r of this.players)if((r==null?void 0:r.sid)==t)return r;return null}sendRaw(t){var r;(r=this.socket)==null||r.send(br(t))}sendBasic(t,...r){this.sendRaw([t,r])}sendHidden(t,...r){var i=this.socket;i==null||i.hiddenSend(br([t,r]))}spawn(t="moomooapi",r=It.RED,i=!0){this.sendBasic(L.SPAWN,{name:t,skin:r,moofoll:i})}setHand(t,r){this.sendBasic(L.SELECT_ITEM,t,r)}setItem(t){this.setHand(t,!1)}setWeapon(t){this.setHand(t,!0)}attack(t,r=null){this.sendBasic(L.ATTACK,t,r)}singleSwing(t=null){this.attack(!0,t),this.attack(!1)}placeItem(t,r=null){this.setItem(t),this.singleSwing(r),this.setWeapon(this.player.wep)}toggleAutoAttack(){this.sendBasic(L.SET_ATTACK_STATE,1)}setGear(t,r,i){this.sendBasic(L.BUY_AND_EQUIP,t,r,i)}buyGear(t,r){this.setGear(!0,t,r)}buyHat(t){this.buyGear(t,!1)}equipGear(t,r){this.setGear(!1,t,r)}equipHat(t){this.equipGear(t,!1)}buyAccessory(t){this.buyGear(t,!0)}equipAccessory(t){this.equipGear(t,!0)}chat(t){this.sendBasic(L.CHAT,t.substring(0,30))}removeProjectile(t){for(let r=0;r<this.projectiles.length;r++)this.projectiles[r].sid==t&&(this.emit("removeProjectile",new Fn(this.projectiles[r])),this.projectiles.splice(r,1))}setDirection(t){this.sendBasic(L.SET_ANGLE,t)}lookAt(t){this.setDirection(this.player.getAsPos().dirTo(t))}};let dt=ne;(()=>{ne.SkinColours=It})(),(()=>{ne.C2SPacketType=L})(),(()=>{ne.S2CPacketType=F})(),(()=>{ne.ObjectRemoveReason=ft})(),(()=>{ne.ItemIds=U})(),(()=>{ne.WeaponIds=Ve})(),(()=>{ne.Repeater=Wi})(),(()=>{ne.msgpack={encode:br,decode:Gt}})(),(()=>{ne.HatIds=H})(),(()=>{ne.AccessoryIds=ae})(),Object.defineProperty(window,"MooMooAPI",{value:dt});const ji="justclient",wr={curConfig:{modules:[],menuPos:{},info:{name:"Default Config",author:"Default Author",desc:"Default Description"}},otherConfigs:[],version:"0.0.0",isDev:!0};var re=wr;const Vi=Ka();for(const e in Vi)re[e]=Vi[e];function ht(e=re){localStorage.setItem(ji,JSON.stringify(e))}function $a(){return localStorage.getItem(ji)}function Ka(){const e=$a();return e==null?(ht(wr),wr):JSON.parse(e)}var Yi=!1;function ja(e){if(!Yi)return;const t=re.curConfig;for(let r=0;r<t.modules.length;r++)if(t.modules[r].moduleName==e.name){t.modules[r]=e.getModuleData(),ht(re);return}t.modules.push(e.getModuleData()),ht(re)}function Va(){for(const e of re.curConfig.modules){const t=fe.getModule(e.moduleName);if(t!=null)for(const r of e.settings){const i=t.getSetting(r.name);i!=null&&(i.set(r.value),i==t.enabled&&i.val&&t.enable())}}Yi=!0}function Ue(e,...t){const r=document.createElement(e);for(const i of t)r.classList.add(i);return r}function Ht(e,...t){const r=Ue("input",...t);return r.type=e,r}function V(...e){return Ue("div",...e)}function Ya(e,...t){const r=Ue("p",...t);return r.textContent=e,r}function Ja(e){for(;e.firstChild;)e.removeChild(e.firstChild)}var pt=document.getElementById("gameCanvas");const Wt=document.getElementById("chatBox"),Ji=document.getElementById("chatHolder");var Ce;pt.addEventListener("mousemove",e=>{Ce=Math.atan2(e.clientY-pt.height/2,e.clientX-pt.width/2)}),Wt.addEventListener("input",()=>{Wt.value.startsWith(Or)?Wt.removeAttribute("max"):Wt.setAttribute("max","30")});var Et=V("guiHolder");function Rr(e){e.preventDefault()}function qa(e,t){var r=0,i=0,n=0,s=0;e.onmousedown=a,e.addEventListener("contextmenu",Rr);function a(x){x.button==0?(Rr(x),n=x.clientX,s=x.clientY,document.onmouseup=c,document.onmousemove=u):x.button==2}function u(x){Rr(x),r=n-x.clientX,i=s-x.clientY,n=x.clientX,s=x.clientY;const v=e.offsetTop-i,h=e.offsetLeft-r;e.style.top=v+"px",e.style.left=h+"px",re.curConfig.menuPos[t]={left:h,top:v,category:t,expanded:JSON.parse(e.getAttribute("expanded"))},ht()}function c(){document.onmouseup=null,document.onmousemove=null}}function qi(e){var r;const t=g.getPlayerBySid((r=an.targetPlayer)==null?void 0:r.sid);return e.replaceAll("%PREFIX%",Or).replaceAll("%PLAYER%",(t==null?void 0:t.name)||"No Player")}var Br=[];function $t(e,t,r){const i=V("notifDiv"),n=Ya(qi(e));i.append(n),t&&i.classList.add("errorDiv"),document.body.appendChild(i),setTimeout(()=>{i.style.right="0px"}),Br.unshift(i),fe.getModule("notifs").chatNotifs.val&&!r&&g.sendBasic(dt.C2SPacketType.CHAT,e),Xi(),setTimeout(()=>{i.style.right="-100px",i.style.opacity="0",setTimeout(()=>{i.remove()},650),Br.pop(),Xi()},3e3)}function Xi(){var e=200;for(let t of Br)t.style.bottom=e+"px",e+=t.clientHeight+10}function zi(e){if(!(Notification.permission!="denied"||!gt))return new Notification(e)}function Fe(){return Date.now()}const Ge=class{constructor(e,t,r){this.r=e,this.g=t,this.b=r}toString(){return JSON.stringify(this)}toHex(){return"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)}static from(e){const t=JSON.parse(e);return new Ge(t.r,t.g,t.b)}};let Ie=Ge;Ie.RED=new Ge(255,0,0),Ie.GREEN=new Ge(0,255,0),Ie.BLUE=new Ge(0,0,255),Ie.WHITE=new Ge(255,255,255),Ie.BLACK=new Ge(0,0,0);var gt=!1;addEventListener("blur",()=>{gt=!0}),addEventListener("focus",()=>{gt=!1});function Xa(e){return new ot(e.x,e.y)}class Zi{info(t,r){$t(t,!1,r)}error(t){$t(t,!0)}}class it extends Tr{constructor(t,r,i="",n){super(),this.name=t,this.defaultVal=r,this.desc=i,this.module=n,this.settingCategory=null,this.req=null,this.val=r}set(t){return typeof t=="string"?this.val=this.parse(t):this.val=t,this.save(),this.emit("change",this.val),!0}save(){this.module.save()}setCategory(t){return this.settingCategory=t,this}asStr(){return this.val.toString()}requires(t,r){return this.req={otherSetting:t,toBeVal:r},this}}class Qi extends it{constructor(t,r,i,n,s,a=""){super(t,r,a,s),this.minVal=i,this.maxVal=n}parse(t){return parseInt(t)}}class en extends it{constructor(t,r,i,n=""){super(t,r,n,i)}parse(t){return JSON.parse(t)}}class tn extends it{constructor(t,r,i="",n){super(t,n,i,r)}parse(t){return t}}class vt extends it{constructor(t,r,i,n,s=""){super(t,r,s,n),this.rawEnum=i}parse(t){return parseInt(t)}enumKeys(){const t=[];for(const r in this.rawEnum)typeof r=="string"&&t.push(r);return t}enumValues(){const t=[];for(const r in this.rawEnum){const i=parseInt(r);isNaN(i)||t.push(i)}return t}}class za extends vt{constructor(t,r,i,n=""){super(t,r,H,i,n)}}class Za extends vt{constructor(t,r,i,n=""){super(t,r,n,i)}}class rn extends it{constructor(t,r,i,n,s,a){super(t,r,n,i),this.minLen=s,this.maxLen=a}parse(t){return t}set(t){return this.maxLen&&t.length>this.maxLen||this.minLen&&t.length<this.minLen?!1:super.set(t)}}var ge=(e=>(e[e.SPIKE=0]="SPIKE",e[e.MILL=1]="MILL",e[e.TRAP=2]="TRAP",e[e.TURRET=3]="TURRET",e[e.WALL=4]="WALL",e))(ge||{});class Qa extends vt{constructor(t,r,i,n){super(t,r,ge,i,n)}}class nn extends it{constructor(t,r,i,n){super(t,r,i,n)}parse(t){return console.log(t,Ie.from(t)),Ie.from(t)}asStr(){return this.val.toHex()}}var N=(e=>(e[e.COMBAT=0]="COMBAT",e[e.MISC=1]="MISC",e[e.CLIENT=2]="CLIENT",e[e.PLACEMENT=3]="PLACEMENT",e[e.GEAR=4]="GEAR",e[e.WORLD=5]="WORLD",e[e.CHAT=6]="CHAT",e))(N||{});class D extends Zi{constructor(t,r,i=""){super(),this.name=t,this.category=r,this.desc=i,this.settings=[],this.bind=this.addBind("keybind","the keybind to toggle"),this.enabled=this.addBool("enabled",!1,"if it is enabled"),this.showNotifs=this.addBool("togglenotifs",!0,"whether or not to show notifications when module is enabled/disabled"),this.toggleOnRelease=this.addBool("toggleonrelease",!1,"toggles the module on key release"),this.guiElement=null,this.intervalData=[]}onEnable(){}onDisable(){}setDefaultBind(t){this.bind.val==""&&this.bind.set(t),this.save()}defaultToggle(){this.toggleOnRelease.val||this.toggleOnRelease.set(!0),this.save()}info(t,r){super.info(`[${this.name}] ${t}`,r)}error(t){super.error(`[${this.name}] ${t}`)}enable(){this.enabled.set(!0),this.showNotifs.val&&this.info("enabled"),this.guiElement.classList.add("moduleEnabled");for(const t of this.intervalData)t.interval=setInterval(t.cb,t.ms);this.onEnable()}disable(t){this.enabled.set(!1),this.showNotifs.val&&this.info("disabled"+(t?" "+t:"")),this.guiElement.classList.remove("moduleEnabled");for(const r of this.intervalData)clearInterval(r.interval);this.onDisable()}addSetting(t){return this.settings.push(t),t}addNum(t,r,i,n,s=""){return this.addSetting(new Qi(t,r,i,n,this,s))}addBool(t,r,i=""){return this.addSetting(new en(t,r,this,i))}addBind(t,r="",i=""){return this.addSetting(new tn(t,this,r,i))}addEnum(t,r,i,n=""){return this.addSetting(new vt(t,r,i,this,n))}addHat(t,r,i=""){return this.addSetting(new za(t,r,this,i))}addAcc(t,r,i=""){return this.addSetting(new Za(t,r,this,i))}addString(t,r="",i="",n,s){return this.addSetting(new rn(t,r,this,i,n,s))}addBuild(t,r,i=""){return this.addSetting(new Qa(t,r,this,i))}addCol(t,r,i=""){return this.addSetting(new nn(t,r,i,this))}save(){ja(this)}on(t,r){g.on(t,i=>{!this.enabled.val||r(i)})}onJust(t,r){Yt.on(t,i=>{!this.enabled.val||r(i)})}getSetting(t){for(const r of this.settings)if(r.name==t)return r;return null}getModuleData(){const t={settings:[],moduleName:this.name};for(const r of this.settings)t.settings.push({name:r.name,value:r.val});return t}onPostInit(){}postInit(){this.onPostInit(),this.save()}toggle(){this.enabled.val?this.disable():this.enable()}interval(t,r){this.intervalData.push({ms:t,cb:r,interval:-1})}}var Sr;class eo{constructor(){this.modules=[],this.moduleMap=new Map}addMod(t){if(this.moduleMap.has(t))throw new Error(`Module ${t.constructor.name} already registered`);const r=new t;return r.name=="gearsettings"&&(Sr=r),this.moduleMap.set(t,r),this.modules.push(r),this}getModule(t){if(typeof t=="string"){for(const r of this.modules)if(r.name==t)return r;return null}else return this.moduleMap.get(t)}init(){this.modulesPostInit()}modulesPostInit(){this.modules.sort((t,r)=>t.name<r.name?-1:t.name>r.name?1:0);for(const t of this.modules)t.postInit()}}const sn=V("invisHolder");var ye,Kt=null;window.addEventListener("contextmenu",e=>{e.preventDefault()}),Et.appendChild(sn);const jt=new Map;function Vt(e){return`BIND: ${e.val||"NONE"}`}const He=class extends D{constructor(){super("gui",N.CLIENT,"the gui"),this.closeOnEscape=this.addBool("escapeclose",!0,"closes the gui when you hit escape"),this.setDefaultBind("Escape"),document.addEventListener("keydown",e=>{e.keyCode==27&&this.enabled.val&&this.closeOnEscape.val&&this.bind.val!="Escape"&&this.disable()})}onEnable(){Et.style.display="block",this.tryRender()}onDisable(){Et.style.display="none",ye!=null&&(ye.remove(),ye=null,Kt=null)}renderGui(e){const t=V("dispGui"),r=V("settingDiv","setTitle");r.textContent=`${e.name} : ${e.desc}`,t.append(r);for(const n of e.settings){const s=V("settingDiv");s.title=n.desc;const a=V("settingContent");a.textContent=`${n.name} : ${n.desc}`,s.appendChild(a);const u=V("settingContent");if(n.req&&n.req.otherSetting.on("change",c=>{var x;c==((x=n.req)==null?void 0:x.toBeVal)?s.style.display="grid":s.style.display="none"}),n instanceof en){const c=Ht("checkbox","settingContent");c.checked=n.val,c.oninput=()=>{n.set(c.checked),n==e.enabled&&(n.val?e.enable():e.disable())},u.appendChild(c)}else if(n instanceof tn){const c=Ue("button","settingContent","bindBtn");c.textContent=Vt(n),c.onmousedown=x=>{x.button==2?(He.bindingSetting==n&&(He.bindingSetting=null),n.set(""),n.save(),c.textContent=Vt(n)):He.bindingSetting!=n?(He.bindingSetting=n,He.bindingSettingElm=c,c.textContent="BIND: BINDING"):(He.bindingSetting=null,c.textContent=Vt(n))},u.appendChild(c)}else if(n instanceof Qi){const c=Ht("range","settingContent");c.min=n.minVal.toString(),c.max=n.maxVal.toString(),c.value=n.val.toString(),a.textContent=`${n.name} : ${c.value} : ${n.desc}`,c.oninput=()=>{a.textContent=`${n.name} : ${c.value} : ${n.desc}`,n.set(c.value)},u.appendChild(c)}else if(n instanceof vt){const c=Ue("select");for(const x in n.rawEnum){if(isNaN(parseInt(x)))continue;const v=Ue("option");v.value=x,v.text=n.rawEnum[x],c.appendChild(v)}c.value=n.val.toString(),c.oninput=()=>{n.set(c.value)},u.appendChild(c)}else if(n instanceof rn){const c=Ht("text","settingContent");c.value=n.val;var i=n.val;c.oninput=()=>{n.set(c.value)?i=n.val:c.value=i},u.appendChild(c)}else if(n instanceof nn){const c=Ht("color","settingContent");c.value=n.asStr(),c.oninput=()=>{n.set(c.value)},u.appendChild(c)}s.appendChild(u),t.appendChild(s)}return t}onPostInit(){var t,r;function e(i,n,s){for(const a of Array.from(i.children))a.tagName=="DIV"&&(a.style.display=n?"block":"none");i.setAttribute("expanded",n.toString()),re.curConfig.menuPos[s]||(re.curConfig.menuPos[s]={left:0,top:0,category:s,expanded:!0}),re.curConfig.menuPos[s].expanded=JSON.parse(i.getAttribute("expanded")),ht()}for(const i of fe.modules){if(jt.has(i.category))continue;const n=V("catDiv");n.append(N[i.category]);const s=re.curConfig.menuPos[i.category];s&&(n.style.top=s.top+"px",n.style.left=s.left+"px"),n.addEventListener("mousedown",a=>{a.button==2&&a.target==n&&e(n,!JSON.parse(n.getAttribute("expanded")),i.category)}),jt.set(i.category,n)}for(const i of fe.modules){const n=V("moduleDiv");n.append(i.name),i.guiElement=n;const s=jt.get(i.category);!s||(s.appendChild(n),n.title=i.desc,n.addEventListener("mousedown",a=>{if(a.button==0)i.toggle();else if(a.button==2){if(ye&&(ye.remove(),ye=null,Kt==i.name)){Kt=null;return}Kt=i.name,ye=this.renderGui(i),sn.appendChild(ye)}}),qa(s,i.category),e(s,(r=(t=re.curConfig.menuPos[i.category])==null?void 0:t.expanded)!=null?r:!0,i.category))}for(const i of jt.values())Et.appendChild(i);document.body.appendChild(Et)}tryRender(){}};let We=He;We.bindingSetting=null;class to extends Tr{}var g=new dt,fe=new eo,E=g.player,Yt=new to;const _r={},Lr=[];document.addEventListener("keydown",e=>{if(Ji.style.display!="block"){if(Lr.forEach(t=>{t.start(e.code)}),We.bindingSetting!=null){We.bindingSetting.set(e.code),We.bindingSettingElm.textContent=Vt(We.bindingSetting),We.bindingSetting=null;return}if(!_r[e.code]){_r[e.code]=!0;for(const t of fe.modules)t.bind.val==e.code&&t.toggle()}}});function ro(e){Lr.push(e)}document.addEventListener("keyup",e=>{if(Ji.style.display!="block"){_r[e.code]=!1,Lr.forEach(t=>{t.stop(e.code)});for(const t of fe.modules)t.bind.val==e.code&&t.enabled.val&&t.toggleOnRelease.val&&t.disable()}});var Jt=[];const an={targetPlayer:null};function on(e){Jt.push(new e)}g.on("packetSend",e=>{if(e.type==L.CHAT){const t=e.payload[0];if(t.startsWith(Or)){e.isCanceled=!0;const r=t.split(" "),i=r[0].substring(1);for(const n of Jt)if(n.name==i){n.input(...r.slice(1));return}$t("command not found!")}}else e.type==L.SET_ANGLE&&Yt.emit("sendSetDir",e.payload[0])});var ie=null,cn=-1,mt=[];g.on("serverTick",e=>{ie=null;for(const i of e.playerData){if(i.sid==E.sid||i.tribe==E.tribe&&i.tribe!=null)continue;const n=g.getPlayerBySid(i.sid);(ie==null||at(E.getAsPos(),n.getAsPos())<cn)&&(ie=n,cn=at(E.getAsPos(),n.getAsPos()))}if(e.playerData.length!=mt.length){if(e.playerData.length>mt.length){var t=null;for(const i of e.playerData){var r=!1;for(const n of mt)i.sid==n.sid&&(r=!0);if(!r){t=i;break}}t&&Yt.emit("playerEnterRange",t)}else{var t=null;for(const n of mt){var r=!1;for(const a of e.playerData)n.sid==a.sid&&(r=!0);if(!r){t=n;break}}t&&Yt.emit("playerExitRange",t)}mt=e.playerData}});function O(e){fe.addMod(e)}var Or="!";class ln extends Zi{constructor(t,r){super(),this.name=t,this.description=r}info(t){super.info(`[${this.name}] ${t}`)}error(t){super.error(`[${this.name}] ${t}`)}}class io extends ln{constructor(){super("u","Allows you to obtain specific upgrades for your player, !u [km/pm]")}input(...t){return t.length==0?(this.info("No upgrade specified, defaulting to KM"),this.km(),!0):t[0]=="km"?(this.km(),!0):t[0]=="pm"?(this.pm(),!0):(this.info("Invalid upgrade specified"),!1)}km(){for(const t of[7,17,31,23,10,38,4,15])g.sendBasic(L.UPGRADE,t);this.info("KM upgrades obtained")}pm(){for(const t of[5,17,31,23,9,38,28,15])g.sendBasic(L.UPGRADE,t);this.info("PM upgrades obtained")}}class no extends D{constructor(){super("client",N.CLIENT,"a module to edit settings in the client (tbd)")}}class so extends D{constructor(){super("notifs",N.CLIENT,"Notification settings"),this.chatNotifs=this.addBool("chatnotify",!1,"notifies modules toggled in chat")}}function un(){return E.getFoodType()}function qt(e,t=null){g.placeItem(e,t)}function fn(){qt(un())}function xt(e){qt(E.getSpikeType(),e)}function ao(e){E.getPadType()!=null&&qt(E.getPadType(),e)}function Pr(){const e=un(),t=e==U.APPLE?20:e==U.COOKIE?40:30;for(let r=t;r<=100+t-E.health;r+=t)fn()}function oo(){setTimeout(Pr,125)}var Xt=!1,dn=!1,be=E.getSpikeType();class co extends D{constructor(){super("antitrap",N.COMBAT,"protects you while in a trap"),this.blockingType=this.addBuild("blocktype",ge.SPIKE,"the type of building to place while trapping"),this.placeIncr=this.addNum("placeincrease",10,1,90,"amount to increase for the direction to place in"),this.replace=this.addBool("replace",!0,"tries to replace when a building is broken nearby"),this.on("serverTick",()=>{Xt=!1;for(const t of g.gameObjects)if(!(!t||t.buildType!=U.PIT_TRAP||at(E,Xa(t))>100||t.ownerSid==E.sid)){be=E.getSpikeType(),this.blockingType.val==ge.MILL?be=E.getMillType():this.blockingType.val==ge.SPIKE?be=E.getSpikeType():this.blockingType.val==ge.TRAP&&E.getPadType()?be=E.getPadType():this.blockingType.val==ge.TURRET&&E.getSpecialType()?be=E.getSpecialType():this.blockingType.val==ge.WALL&&(be=E.getWallType()),dn||hn(be,this.placeIncr.val),Xt=!0;break}dn=Xt}),this.on("removeObject",t=>{t.building.buildType==U.PIT_TRAP||at(E,t.building)>=150||!Xt||hn(be,this.placeIncr.val)})}}function hn(e,t){for(let r=0;r<360;r+=t)qt(e,_e(r))}var $e=0;function pn(e){g.sendBasic(L.SET_ANGLE,e)}class En extends D{constructor(){super("autoaim",N.COMBAT,"automatically aims"),this.disableIfNone=this.addBool("disableifnone",!0,"disables if there is not a player nearby"),this.blockPackets=this.addBool("blockpackets",!0,"blocks other direction packets"),this.on("serverTick",()=>{if(ie==null){this.disableIfNone.val&&this.disable();return}$e=Yr(E.getAsPos(),ie.getAsPos()),pn($e)}),this.on("packetSend",t=>{t.type==L.SET_ANGLE&&t.payload[0]!=$e&&(t.isCanceled=!0)})}onEnable(){pn($e)}}var gn=Fe(),kr=Fe(),Nr=0,lo=100,vn=!1;function mn(){setTimeout(()=>{if(Fe()-kr<=125)return mn();kr=Fe(),Pr()},130)}class uo extends D{constructor(){super("autoheal",N.COMBAT,"automatically heals"),this.smartCheck=this.addBool("smartcheck",!0,"attempts to determine if the enemy is trying to insta"),this.smartCheckShame=this.addBool("smartcheckshame",!0,"attempts to calculate current shame, and heal accordingly, requires smartcheck to be enabled"),this.smartCheckShameVal=this.addNum("smartcheckshameval",4,0,6,"the maximum shame count to stop fast healing, requires smartchecksame to be enabled"),this.antiAgeOne=this.addBool("antiageone",!0,"tries to outheal age one instas"),this.on("health",t=>{if(t.sid!=E.sid)return;const r=t.health;if(vn=r>lo,vn?kr-gn<=120?Nr++:Nr-=2:gn=Fe(),!(r>=100)){var i=!1;if(this.smartCheck.val&&ie&&ie.dist(E)<=600&&r<=75){if(this.smartCheckShame.val&&Nr>this.smartCheckShameVal.val){oo();return}r<=55&&(i=!0),this.antiAgeOne.val&&r<=65&&ie.wep==Ve.TOOL_HAMMER&&(i=!0,setTimeout(fn,110))}i?Pr():mn()}})}}class fo extends D{constructor(){super("clownnotify",N.COMBAT,"notifies you if a player gets clown"),this.onlySelf=this.addBool("onlyself",!1,"only notifies if you have clown");var t={};this.on("updatePlayer",r=>{if(this.onlySelf.val&&r.sid!=E.sid)return;const i=r.hat==H.SHAME;if(!i&&t[r.sid]==null){t[r.sid]=!1;return}if(t[r.sid]!=i){t[r.sid]=i;const n=g.getPlayerBySid(r.sid);if(n==null)return;$t(n.name+(i?"":" no longer")+" has clown")}})}}function Z(e){Sr.buyHats.val&&g.buyHat(e),g.equipHat(e)}function Ke(e){Sr.buyAccs.val&&g.buyAccessory(e),g.equipAccessory(e)}function ho(){g.player.acc==ae.MONKEY_TAIL&&Ke(ae.NONE),Z(H.BULL_HELMET)}function xn(){g.setWeapon(E.getPrimaryType())}function po(){const e=E.getSecondaryType();e!=null&&g.setWeapon(e)}var Dr=!1,An;g.on("packetSend",e=>{e.type==L.SET_ANGLE&&Dr&&(e.isCanceled=!0,g.sendHidden(L.SET_ANGLE,An))});function yn(e,t){Mr(E.dirTo(e),t)}function Mr(e,t){t?(Dr=!0,An=e):t==!1&&(Dr=!1),g.sendBasic(L.SET_ANGLE,e)}var je=!1;g.on("packetReceive",e=>{e.type==F.DEATH&&(je=!1)}),g.on("packetSend",e=>{e.type==L.SET_ATTACK_STATE&&e.payload[0]&&(je=!je)});function zt(){g.toggleAutoAttack()}function Eo(){ho(),xn(),g.singleSwing()}function go(){Z(H.TURRET_GEAR),po(),g.singleSwing()}function vo(){Z(H.BOOSTER_HAT),Ke(ae.MONKEY_TAIL),xn()}var At=0,Zt,bn=!1,Tn=(e=>(e[e.NONE=0]="NONE",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e))(Tn||{});class mo extends D{constructor(){super("insta",N.COMBAT,"insta kill noobs"),this.spikePlaceCount=this.addEnum("spikePlaceCount",0,Tn,"amount of spikes to place for the insta"),this.on("packetReceive",t=>{if(t.type==F.UPDAE_PLAYERS){if(E.getSecondaryType()==null){this.disable("no secondary!");return}At++,At==1?(Eo(),this.instaSpike()):At==2?go():At==3&&(vo(),this.disable())}})}onPostInit(){Zt=fe.getModule(En)}onEnable(){At=0,Zt.enabled.val||(Zt.enable(),bn=!0)}onDisable(){bn&&Zt.disable()}instaSpike(){this.spikePlaceCount.val==1?xt($e):this.spikePlaceCount.val==2&&(xt($e-_e(45)),xt($e+_e(45)))}}var Ur=!1,wn=!1;class xo extends D{constructor(){super("trapnuker",N.COMBAT,"Breaks traps that you're in"),this.on("serverTick",()=>{for(const t of g.gameObjects)if(t.buildType==U.PIT_TRAP&&t.dist(E)<=95){yn(t,!0),Ur=!0,je||zt();break}!Ur&&wn&&je&&(zt(),Mr(Ce,!1)),wn=Ur})}onDisable(){je&&(zt(),Mr(Ce,!1))}}class Ao extends D{constructor(){super("visualrange",N.COMBAT,"notifies you if players come into/leave your view"),this.tabbedOutNotif=this.addBool("tabbedout",!0,"pops up a desktop notification if you're tabbed out"),this.enter=this.addBool("enter",!0,"notifies when a player enters visual range"),this.exit=this.addBool("exit",!0,"notifies when a player exits visual range"),this.onJust("playerEnterRange",t=>{var i;if(!this.enter.val||t.sid==E.sid)return;const r=((i=g.getPlayerBySid(t.sid))==null?void 0:i.name)+" has entered visual range";this.info(r),this.tabbedOutNotif&&gt&&zi(r)}),this.onJust("playerExitRange",t=>{var i;if(!this.exit.val||t.sid==E.sid)return;const r=((i=g.getPlayerBySid(t.sid))==null?void 0:i.name)+" has exited visual range";this.info(r),this.tabbedOutNotif&&gt&&zi(r)})}}const yt=[];var Te=0,Cr=0;for(let e in H){const t=parseInt(e);isNaN(t)||yt.push(t)}class yo extends D{constructor(){super("rainbow",N.GEAR,"cycles through hats"),this.tickInterval=this.addNum("interval",5,1,50,"interval to change hats"),this.on("serverTick",()=>{if(Cr++,Cr>=this.tickInterval.val){for(;!g.hatsOwned[yt[Te]];)Te++,Te>=yt.length&&(Te=0);Cr=0,Z(yt[Te]),Te++,Te>=yt.length&&(Te=0)}})}onDisable(){Z(0)}}var Rn;class bo extends D{constructor(){super("autoez",N.CHAT,"Automatically insult players after death"),this.msg=this.addString("message","get justclient %PLAYER%","the message to send after killing a player",0,30),this.onJust("playerExitRange",t=>{Fe()-Rn>=500||(an.targetPlayer=t,g.chat(qi(this.msg.val)))}),this.on("packetReceive",t=>{t.type==F.UPDATE_MATS&&t.payload[0]=="kills"&&(Rn=Fe())})}}class To extends D{constructor(){super("debug",N.MISC,"a module for debugging");const t=this.addBool("bool setting",!1,"bool setting defaulting to false");this.addNum("num setting",5,1,10,"num setting defaulting to 5 with a minimum of 1 and max of 10"),this.addBind("bind setting","a bind setting with no defaults"),this.addHat("hat setting",H.SHAME,"hat setting defaulting to the shame hat"),this.addBuild("build setting",ge.TRAP,"building setting, defaulting to trap");let r;(i=>{i[i.ENUMVAL1=0]="ENUMVAL1",i[i.ENUMVAL2=1]="ENUMVAL2",i[i.ENUMVAL3=2]="ENUMVAL3"})(r||(r={})),this.addEnum("enum setting",0,r,"an enum setting"),this.addBool("bool settingr",!1,"bool setting that requires first bool setting to be false").requires(t,!1)}}class wo extends D{constructor(){super("packetlogger",N.MISC,"logs packets"),this.consoleOnly=this.addBool("consoleonly",!1,"logs packets to the console"),this.sendingPackets=this.addBool("sending",!0,"logs packets if sent out to server"),this.receiveingPackets=this.addBool("receiving",!0,"logs packets sent from server to client"),this.on("packetSend",t=>{this.consoleOnly.val?console.log(t.packet):this.info("sending packet "+JSON.stringify(t.packet),!0)}),this.on("packetReceive",t=>{this.consoleOnly.val?console.log(t.packet):this.info("receiving packet "+JSON.stringify(t.packet),!0)})}}class bt extends D{constructor(t,r){super(t,N.PLACEMENT,"placement settings"),this.repeater=null,this.triPlace=this.addBool("triplace",!1,"will place 3 builds instead of 1"),this.triPlaceDir=this.addNum("triplaceadd",90,45,120,"the amount (in degrees) to add to the placement"),this.cbId=r.bind(E),this.defaultToggle()}onPostInit(){this.repeater=new Wi(()=>{const t=this.cbId();if(t!=null&&(g.placeItem(t,Ce),this.triPlace.val)){const r=_e(this.triPlaceDir.val);g.placeItem(t,Ce+r),g.placeItem(t,Ce-r)}},0,this.bind.val),this.bind.on("change",t=>{this.repeater.code=t}),ro(this.repeater)}}class Ro extends bt{constructor(){super("spike",E.getSpikeType)}}class Bo extends bt{constructor(){super("trap",E.getPadType)}}class So extends bt{constructor(){super("food",E.getFoodType)}}class _o extends bt{constructor(){super("mill",E.getMillType)}}class Lo extends bt{constructor(){super("turret",E.getSpecialType)}}class Oo extends D{constructor(){super("nuker",N.WORLD,"breaks near buildings"),this.on("serverTick",()=>{const t={dist:null,obj:null};for(const r in g.gameObjects){const i=g.gameObjects[r];(t.dist==null||i.dist(E.getAsPos())<t.dist)&&(t.obj=i,t.dist=i.dist(E.getAsPos()))}t.obj&&t.dist<100&&(yn(t.obj),je||zt())})}}var Po=`.notifDiv{position:absolute;right:-100px;width:fit-content;height:fit-content;background-color:#4b4b4b79;border-radius:5px;transition-duration:.65s;z-index:10}.guiHolder{top:0px;left:0px;width:100%;position:absolute;height:100%;background-color:#7c7c7c48;display:none}.catDiv{position:absolute;width:fit-content;height:fit-content;background-color:#1f1f1f;padding:6px;display:grid;place-items:center;color:#8ac0f0d7}.moduleDiv{display:block;width:fit-content;height:fit-content;padding:3px;background-color:#1f1f1f;transition-duration:.5s}.moduleDiv:hover{background-color:#3354c4}.invisHolder{display:grid;place-items:center;position:absolute;width:100%;height:100%}.dispGui{display:block;width:45%;height:70%;background-color:#103a94a2;overflow-y:hidden}.settingDiv{width:100%;height:fit-content;position:relative;display:grid;place-content:center;margin-bottom:4px;box-sizing:border-box}.settingContent{display:inline-block;width:fit-content}.moduleEnabled{background-color:#648edbea}.errorDiv{background-color:#740d0da8}.commandDiv{display:block;width:100%;height:fit-content;text-align:center;padding:5px;border:2px solid rgba(1,26,54,.26)}.helpDiv{display:block;width:50%;height:50%;background-color:#103a94a2;border-radius:8px}.commandDivName{width:100%;height:fit-content;text-align:center}.settingContent[type=color]{width:30px}.setTitle{font-size:large}
`;function ko(){const e=document.createElement("style");e.setAttribute("type","text/css"),e.appendChild(document.createTextNode(Po)),document.head.appendChild(e)}function Fr(e,t,r){r.on("packetSend",i=>{i.type==e&&t(i)})}function No(e,t,r){r.on("packetReceive",i=>{i.type==e&&t(i)})}const Do=JSON.parse(atob("WyJjdW50Iiwid2hvcmUiLCJmdWNrIiwic2hpdCIsImZhZ2dvdCIsIm5pZ2dlciIsIm5pZ2dhIiwiZGljayIsInZhZ2luYSIsIm1pbmdlIiwiY29jayIsInJhcGUiLCJjdW0iLCJzZXgiLCJ0aXRzIiwicGVuaXMiLCJjbGl0IiwicHVzc3kiLCJtZWF0Y3VydGFpbiIsImppenoiLCJwcnVuZSIsImRvdWNoZSIsIndhbmtlciIsImRhbW4iLCJiaXRjaCIsImRpY2siLCJmYWciLCJiYXN0YXJkIl0="));class Mo extends D{constructor(){super("cursebypass",N.CHAT,"bypasses the curse filter"),Fr(L.CHAT,t=>{var r=t.payload[0],i=!1;Do.forEach(n=>{r.indexOf(n)!=-1&&(i=!0,r=r.replaceAll(n,`${n[0].toUpperCase()}${n.substring(1,n.length)}`))}),i&&(t.isCanceled=!0,g.sendHidden(L.CHAT,r))},this)}}var Bn=(e=>(e[e.ENEMIES=0]="ENEMIES",e[e.TEAM=1]="TEAM",e[e.ALL=2]="ALL",e))(Bn||{});class Uo extends D{constructor(){super("chatmirror",N.CHAT,"mirrors player's chat messages"),this.copyPlayers=this.addEnum("playersel",2,Bn,"select which players to mirror"),No(F.CHAT,t=>{const r=t.payload[0];if(r==E.sid)return;const i=g.getPlayerBySid(r);i!=null&&(this.copyPlayers.val==1&&i.tribe!=E.tribe||this.copyPlayers.val==0&&i.tribe==E.tribe||g.chat(t.payload[1]))},this)}}class Co extends D{constructor(){super("speedgear",N.GEAR,"Equips the fastest gear"),this.deEquipHat=this.addBool("deequiphat",!0,"deequips your current hat")}onEnable(){this.deEquipHat.val&&Z(H.NONE),E.y<2400?(console.log("winter"),Z(H.WINTER_CAP)):E.y>6850&&E.y<7550?(console.log("flip"),Z(H.FLIPPER_HAT)):(console.log("boost"),Z(H.BOOSTER_HAT)),Ke(ae.MONKEY_TAIL),this.disable()}}class Fo extends D{constructor(){super("gearsettings",N.GEAR,"various settings regarding the handling of gear, does not matter if enabled/disabled"),this.buyHats=this.addBool("buyhat",!0,"automatically buys hats"),this.buyAccs=this.addBool("buyaccs",!0,"automatically buys accessories")}}const Go={esc:"Escape"},we=V("guiHolder"),Sn=V("invisHolder"),Gr=V("helpDiv"),_n=Ue("p","commandDivName"),Ir=V("commandsDiv");_n.innerText="Commands",Gr.appendChild(_n),Gr.appendChild(Ir),Sn.appendChild(Gr),we.appendChild(Sn),we.style.display="none",document.body.appendChild(we),we.addEventListener("click",()=>{we.style.display="none"}),we.addEventListener("keydown",e=>{e.code==Go.esc&&(we.style.display="none")});class Io extends ln{constructor(){super("help","get some help")}input(...t){return Ja(Ir),we.style.display="block",Jt.forEach(r=>{const i=V("commandDiv");i.innerText=r.name,i.title=r.description,Ir.appendChild(i)}),!0}}var Ln=(e=>(e[e.MOUSE=0]="MOUSE",e[e.ENEMY=1]="ENEMY",e))(Ln||{}),On=(e=>(e[e.NEAR=0]="NEAR",e[e.ALWAYS=1]="ALWAYS",e))(On||{});class Ho extends D{constructor(){super("boostspike",N.COMBAT,"rapidly places boost pads and spikes"),this.aimMode=this.addEnum("aimmode",1,Ln,"What direction to bostspike in"),this.spikeMode=this.addEnum("spikemode",0,On,"When to place spikes"),this.spikeDist=this.addNum("spikedist",300,200,1e3,"Distance to start place spikes"),this.defaultToggle(),this.interval(0,()=>{const t=this.aimMode.val==0||ie==null?Ce:E.dirTo(ie);ao(t),(this.spikeMode.val==1||ie!=null&&E.dist(ie)<this.spikeDist.val)&&(xt(t+_e(90)),xt(t-_e(90)))})}onEnable(){E.getPadType()!=U.BOOST_PAD&&this.disable("You do not have a boost pad!")}}class Wo extends D{constructor(){super("chattime",N.CHAT,"allows your chat messages to stay longer"),this.time=this.addNum("time",1e3,600,1e4,"amount of extra time for your messages to stay");var t=null;const r=[];Fr(L.CHAT,i=>{if(r.push(i.payload[0]),t==null){var n=this.time.val;t=setInterval(()=>{g.sendHidden(L.CHAT,r[0]),n-=this.time.minVal,n<=0&&r.shift(),r.length||(clearInterval(t),t=null)},this.time.minVal)}},this)}}class $o extends D{constructor(){super("antiaim",N.MISC,"makes you look wierd"),this.hit360=this.addBool("360hit",!1,"sends Number.MAX_VALUE as your direction"),Fr(L.SET_ANGLE,t=>{t.isCanceled=!0,g.sendHidden(L.SET_ANGLE,this.getDirection())},this)}getDirection(){return this.hit360.val?Number.MAX_VALUE:null}onEnable(){g.sendHidden(L.SET_ANGLE,this.getDirection())}}class Ko extends D{constructor(){super("noprompt",N.MISC,"removes moomoo.io's dumb prompt before close")}onEnable(){onbeforeunload=null}onDisable(){onbeforeunload=()=>"I hate this game"}}class jo extends D{constructor(){super("nocookie",N.MISC,"hides moomoo.io's cookie display")}onEnable(){var t;(t=document.getElementById("onetrust-consent-sdk"))==null||t.remove()}}class Vo extends D{constructor(){super("clickgear",N.GEAR,"equips gear when you click"),this.downHatL=this.addHat("downhatleft",H.BULL_HELMET,"the hat to equip when you left click"),this.downAccL=this.addAcc("downaccleft",ae.CORRUPT_X_WINGS,"the accessory to equip when you left click"),this.upHatL=this.addHat("uphatleft",H.SPIKE_GEAR,"the hat to equip when you release left click"),this.upAccL=this.addAcc("upaccleft",ae.CORRUPT_X_WINGS,"the accessory to equip when you release left click"),this.downHatR=this.addHat("downhatright",H.TANK_GEAR,"the hat to equip when you right click"),this.downAccR=this.addAcc("downaccright",ae.CORRUPT_X_WINGS,"the accessory to equip when you right click"),this.upHatR=this.addHat("uphatright",H.SOLDIER_HELMET,"the hat to equip when you release right click"),this.upAccR=this.addAcc("upaccright",ae.CORRUPT_X_WINGS,"the accessory to equip when you release right click"),pt.addEventListener("mousedown",t=>{t.button==0?(Z(this.downHatL.val),Ke(this.downAccL.val)):t.button==1&&(Z(this.downHatR.val),Ke(this.downAccR.val))}),pt.addEventListener("mouseup",t=>{t.button==0?(Z(this.upHatL.val),Ke(this.upAccL.val)):t.button==1&&(Z(this.upHatR.val),Ke(this.upAccR.val))})}}console.log("jusclient init...");const Yo="0.0.0",Jo=Date.now();O(uo),O(We),O(no),O(so),O(Ro),O(Bo),O(So),O(_o),O(Lo),O(mo),O(fo),O(To),O(yo),O(wo),O(Ao),O(En),O(co),O(Oo),O(xo),O(bo),O(Mo),O(Uo),O(Co),O(Fo),O(Ho),O(Wo),O($o),O(Ko),O(jo),O(Vo),fe.init(),Va(),ko(),on(Io),on(io),console.log("justclient init finished in",Date.now()-Jo,"ms",Yo),console.log("justclient registered",fe.modules.length,"total modules, and",Jt.length,"commands")});
