(function(k){typeof define=="function"&&define.amd?define(k):k()})(function(){"use strict";var Io=Object.defineProperty;var zo=(k,I,J)=>I in k?Io(k,I,{enumerable:!0,configurable:!0,writable:!0,value:J}):k[I]=J;var Rt=(k,I,J)=>(zo(k,typeof I!="symbol"?I+"":I,J),J);var k=(e=>(e.SPAWN="sp",e.CHAT="ch",e.ATTACK="c",e.PING="pp",e.SET_ANGLE="2",e.SELECT_ITEM="5",e.UPGRADE="6",e.SET_ATTACK_STATE="7",e.CREATE_TRIBE="8",e.LEAVE_TRIBE="9",e.REQUEST_JOIN_TRIBE="10",e.ACCEPT_TRIBE_REQUEST="11",e.KICK_FROM_TRIBE="12",e.BUY_AND_EQUIP="13c",e.PING_MAP="14",e.MOVE="33",e))(k||{}),I=(e=>(e.ANNOUNCE="ann",e.INIT="io-init",e.INIT_TRIBES="id",e.SET_SID="1",e.KICK="d",e.ADD_PLAYER="2",e.UPDAE_PLAYERS="33",e.REMOVE_PLAYER="4",e.UPDATE_LEADER_BOARD="5",e.ADD_OBJECT="6",e.UPDATE_AIS="a",e.PLAYER_SWING="7",e.MOOSTAFA_SWING="aa",e.WIGGLE="8",e.SHOOT_TURRET="sp",e.UPDATE_MATS="9",e.HEALTH="h",e.DEATH="11",e.REMOVE_OBJECT="12",e.REMOVE_ALL_OBJECTS="13",e.SET_ITEM_COUNT="14",e.SET_AGE="15",e.LIST_UPGRADES="16",e.SET_ITEMS_BAR="17",e.ADD_PROJECTILE="18",e.REMOVE_PROJECTILE="19",e.SERVER_RESTART="20",e.ADD_TRIBE="ac",e.DELETE_TRIBE="ad",e.REQUEST_JOIN_TRIBE="an",e.SET_TRIBE="st",e.SET_TRIBE_MEMBERS="sa",e.MINIMAP_LOCATIONS="mm",e.CHAT="ch",e.UPDATE_SHOP="us",e.PING="pp",e.DAMAGE_TEST="t",e.PING_MAP="p",e))(I||{});class J{constructor(t){this.eventName=t}}class Hr extends J{constructor(t){super("packet"),this.packet=t,this.payload=t[1]}}class Pn extends Hr{constructor(t){super(t),this.type=t[0]}}class $r extends Hr{constructor(t){super(t),this.isCanceled=!1,this.type=t[0]}}class jr extends J{constructor(t){super("player"),this.player=t}}class Nn extends J{constructor(t,r){super("health"),this.sid=t,this.health=r}}class Yr extends J{constructor(t){super("build"),this.building=t}}class wn extends Yr{constructor(t){super(t)}}class Vr extends Yr{constructor(t,r){super(t),this.reason=r}}class Dn extends J{constructor(t,r){super("chat"),this.sid=t,this.message=r}}class Mn extends J{constructor(t){super("server_tick"),this.playerData=t}}class Un extends J{constructor(t){super("projectile_add"),this.projectile=t}}class Cn extends J{constructor(t){super("projectile_remove"),this.projectile=t}}var z;(function(e){e.SPAWN="sp",e.CHAT="ch",e.ATTACK="c",e.PING="pp",e.SET_ANGLE="2",e.SELECT_ITEM="5",e.UPGRADE="6",e.SET_ATTACK_STATE="7",e.CREATE_TRIBE="8",e.LEAVE_TRIBE="9",e.REQUEST_JOIN_TRIBE="10",e.ACCEPT_TRIBE_REQUEST="11",e.KICK_FROM_TRIBE="12",e.BUY_AND_EQUIP="13c",e.PING_MAP="14",e.MOVE="33"})(z||(z={}));var F;(function(e){e.ANNOUNCE="ann",e.INIT="io-init",e.INIT_TRIBES="id",e.SET_SID="1",e.KICK="d",e.ADD_PLAYER="2",e.UPDAE_PLAYERS="33",e.REMOVE_PLAYER="4",e.UPDATE_LEADER_BOARD="5",e.ADD_OBJECT="6",e.UPDATE_AIS="a",e.PLAYER_SWING="7",e.MOOSTAFA_SWING="aa",e.WIGGLE="8",e.SHOOT_TURRET="sp",e.UPDATE_MATS="9",e.HEALTH="h",e.DEATH="11",e.REMOVE_OBJECT="12",e.REMOVE_ALL_OBJECTS="13",e.SET_ITEM_COUNT="14",e.SET_AGE="15",e.LIST_UPGRADES="16",e.SET_ITEMS_BAR="17",e.ADD_PROJECTILE="18",e.REMOVE_PROJECTILE="19",e.SERVER_RESTART="20",e.ADD_TRIBE="ac",e.DELETE_TRIBE="ad",e.REQUEST_JOIN_TRIBE="an",e.SET_TRIBE="st",e.SET_TRIBE_MEMBERS="sa",e.MINIMAP_LOCATIONS="mm",e.CHAT="ch",e.UPDATE_SHOP="us",e.PING="pp",e.DAMAGE_TEST="t",e.PING_MAP="p"})(F||(F={}));var K;(function(e){e[e.APPLE=0]="APPLE",e[e.COOKIE=1]="COOKIE",e[e.CHEESE=2]="CHEESE",e[e.WOOD_WALL=3]="WOOD_WALL",e[e.STONE_WALL=4]="STONE_WALL",e[e.CASTLE_WALL=5]="CASTLE_WALL",e[e.SPIKE=6]="SPIKE",e[e.GREATER_SPIKE=7]="GREATER_SPIKE",e[e.POISON_SPIKE=8]="POISON_SPIKE",e[e.SPINNING_SPIKE=9]="SPINNING_SPIKE",e[e.WINDMILL=10]="WINDMILL",e[e.FASTER_WINDMILL=11]="FASTER_WINDMILL",e[e.POWER_MILL=12]="POWER_MILL",e[e.MINE=13]="MINE",e[e.SAPPLING=14]="SAPPLING",e[e.PIT_TRAP=15]="PIT_TRAP",e[e.BOOST_PAD=16]="BOOST_PAD",e[e.TURRET=17]="TURRET",e[e.PLATFORM=18]="PLATFORM",e[e.HEALING_PAD=19]="HEALING_PAD",e[e.SPAWN_PAD=20]="SPAWN_PAD",e[e.BLOCKER=21]="BLOCKER",e[e.TELEPORTER=22]="TELEPORTER"})(K||(K={}));var tt;(function(e){e[e.TOOL_HAMMER=0]="TOOL_HAMMER",e[e.HAND_AXE=1]="HAND_AXE",e[e.GREAT_AXE=2]="GREAT_AXE",e[e.SHORT_SWORD=3]="SHORT_SWORD",e[e.KATANA=4]="KATANA",e[e.POLE_ARM=5]="POLE_ARM",e[e.BAT=6]="BAT",e[e.DAGGERS=7]="DAGGERS",e[e.STICK=8]="STICK",e[e.HUNTING_BOW=9]="HUNTING_BOW",e[e.GREAT_HAMMER=10]="GREAT_HAMMER",e[e.WOODEN_SHIELD=11]="WOODEN_SHIELD",e[e.CROSSBOW=12]="CROSSBOW",e[e.REPEATER_CROSSBOW=13]="REPEATER_CROSSBOW",e[e.MC_GRABBY=14]="MC_GRABBY",e[e.MUSKET=15]="MUSKET"})(tt||(tt={}));var Qt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Ke={},U={};Object.defineProperty(U,"__esModule",{value:!0}),U.randInt=U.randFloat=U.averageAngle=U.lerpPos=U.lerp=U.toDeg=nt=U.toRad=U.calcVec=Xr=U.getAngle=it=U.getDistance=void 0;const rt=Ke,Jr=Math.PI;function kn(e,t,r,i){if(e instanceof rt.PrimitivePos&&t instanceof rt.PrimitivePos)return Math.hypot(e.x-t.x,e.y-t.y);if(typeof e=="number"&&typeof t=="number"&&r!=null&&i!=null)return Math.hypot(e-r,t-i);throw new Error(`Invalid arguments! ${e} ${t} ${r} ${i}`)}var it=U.getDistance=kn;function Gn(e,t,r,i){if(e instanceof rt.PrimitivePos&&t instanceof rt.PrimitivePos)return Math.atan2(t.y-e.y,t.x-e.x);if(typeof e=="number"&&typeof t=="number"&&r!=null&&i!=null)return Math.atan2(i-t,r-e);throw new Error(`Invalid arguments! ${e} ${t} ${r} ${i}`)}var Xr=U.getAngle=Gn;function Fn(e,t,r){return e.add(Math.cos(t)*r,Math.sin(t)*r)}U.calcVec=Fn;function Kn(e){return Jr*e/180}var nt=U.toRad=Kn;function Wn(e){return e*(180/Jr)}U.toDeg=Wn;function er(e,t,r){return e+(t-e)*r}U.lerp=er;function Hn(e,t,r){return new rt.Pos(er(e.x,t.x,r),er(e.y,t.y,r))}U.lerpPos=Hn;function $n(e,t){return(360+t+((e-t+180+360)%360-180)/2)%360}U.averageAngle=$n;function Ir(e,t){return Math.random()*(t-e)+e}U.randFloat=Ir;function jn(e,t){return Math.round(Ir(e,t))}U.randInt=jn,Object.defineProperty(Ke,"__esModule",{value:!0});var at=Ke.Pos=Ke.PrimitivePos=void 0;const zr=U;class tr{constructor(t=0,r=0){this.x=t,this.y=r}normalize(){return new We(this.x,this.y)}}Ke.PrimitivePos=tr;class We extends tr{constructor(t=0,r=0){super(t,r),this.x=t,this.y=r}clone(){return new We(this.x,this.y)}addX(t){const r=this.clone();return r.x+=t,r}addY(t){const r=this.clone();return r.y+=t,r}add(t,r){return t instanceof We?this.addX(t.x).addY(t.y):this.addX(t).addY(r||0)}sub(t,r){return t instanceof We?this.add(-t.x,-t.y):this.add(-t,-(r||0))}toString(){return`X: ${this.x} Y: ${this.y}`}asPrimitive(){return new tr(this.x,this.y)}set(t){return this.x=t.x,this.y=t.y,this}dist(t){return(0,zr.getDistance)(this,t)}dirTo(t){return(0,zr.getAngle)(this,t)}equals(t){return this.x==t.x&&this.y==t.y}}at=Ke.Pos=We;class rr extends at{constructor(){super(...arguments),this.x=-2,this.y=-2,this.sid=-2,this.id="NULL",this.dir=0,this.currentObject=-2,this.wep=-2,this.variant=-2,this.tribe="NULL",this.isLeader=!1,this.hat=-2,this.acc=-2,this.isSkull=!1,this.zIndex=-1,this.health=100,this.name="NULL",this.chatMessage=null,this.messageTimeout=-1}assign(t){this.x=t.x,this.y=t.y,this.sid=t.sid,this.dir=t.dir,this.currentObject=t.currentObject,this.wep=t.wep,this.variant=t.variant,this.tribe=t.tribe,this.isLeader=t.isLeader,this.hat=t.hat,this.acc=t.acc,this.isSkull=t.isSkull,this.zIndex=t.zIndex}getAsPos(){return this}}class Yn extends rr{constructor(){super(...arguments),this.weapons=[tt.TOOL_HAMMER,void 0],this.items=[K.APPLE,K.WOOD_WALL,K.SPIKE,K.WINDMILL,void 0,void 0,void 0,void 0]}getFoodType(){return this.items[0]}getWallType(){return this.items[1]}getSpikeType(){return this.items[2]}getMillType(){return this.items[3]}searchForId(t){for(let r of this.items)if(r==t)return r;return null}getSapplingType(){return this.searchForId(K.SAPPLING)}getMineType(){return this.searchForId(K.MINE)}getSpecialType(){return this.searchForId(K.TURRET)||this.searchForId(K.BLOCKER)||this.searchForId(K.HEALING_PAD)||this.searchForId(K.PLATFORM)||this.searchForId(K.TELEPORTER)}getPadType(){return this.items[4]||null}getPrimaryType(){return this.weapons[0]}getSecondaryType(){return this.weapons[1]}}var ir={},nr={},Zr={},Tt={},Z={},Vn=ar(typeof Buffer!="undefined"&&Buffer)||ar(Qt.Buffer)||ar(typeof window!="undefined"&&window.Buffer)||Qt.Buffer;function ar(e){return e&&e.isBuffer&&e}var Jn={}.toString,sr=Array.isArray||function(e){return Jn.call(e)=="[object Array]"},qr={exports:{}},He=Z,bt=qr.exports=Qr(0);bt.alloc=Qr,bt.concat=He.concat,bt.from=Xn;function Qr(e){return new Array(e)}function Xn(e){if(!He.isBuffer(e)&&He.isView(e))e=He.Uint8Array.from(e);else if(He.isArrayBuffer(e))e=new Uint8Array(e);else{if(typeof e=="string")return He.from.call(bt,e);if(typeof e=="number")throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(e)}var ei={exports:{}},ue=Z,$e=ue.global,Ot=ei.exports=ue.hasBuffer?ti(0):[];Ot.alloc=ue.hasBuffer&&$e.alloc||ti,Ot.concat=ue.concat,Ot.from=In;function ti(e){return new $e(e)}function In(e){if(!ue.isBuffer(e)&&ue.isView(e))e=ue.Uint8Array.from(e);else if(ue.isArrayBuffer(e))e=new Uint8Array(e);else{if(typeof e=="string")return ue.from.call(Ot,e);if(typeof e=="number")throw new TypeError('"value" argument must not be a number')}return $e.from&&$e.from.length!==1?$e.from(e):new $e(e)}var ri={exports:{}},Bt=Z,yt=ri.exports=Bt.hasArrayBuffer?ii(0):[];yt.alloc=ii,yt.concat=Bt.concat,yt.from=zn;function ii(e){return new Uint8Array(e)}function zn(e){if(Bt.isView(e)){var t=e.byteOffset,r=e.byteLength;e=e.buffer,e.byteLength!==r&&(e.slice?e=e.slice(t,t+r):(e=new Uint8Array(e),e.byteLength!==r&&(e=Array.prototype.slice.call(e,t,t+r))))}else{if(typeof e=="string")return Bt.from.call(yt,e);if(typeof e=="number")throw new TypeError('"value" argument must not be a number')}return new Uint8Array(e)}var ye={},St={};St.copy=Qn,St.toString=qn,St.write=Zn;function Zn(e,t){for(var r=this,i=t||(t|=0),n=e.length,a=0,s=0;s<n;)a=e.charCodeAt(s++),a<128?r[i++]=a:a<2048?(r[i++]=192|a>>>6,r[i++]=128|a&63):a<55296||a>57343?(r[i++]=224|a>>>12,r[i++]=128|a>>>6&63,r[i++]=128|a&63):(a=(a-55296<<10|e.charCodeAt(s++)-56320)+65536,r[i++]=240|a>>>18,r[i++]=128|a>>>12&63,r[i++]=128|a>>>6&63,r[i++]=128|a&63);return i-t}function qn(e,t,r){var i=this,n=t|0;r||(r=i.length);for(var a="",s=0;n<r;){if(s=i[n++],s<128){a+=String.fromCharCode(s);continue}(s&224)===192?s=(s&31)<<6|i[n++]&63:(s&240)===224?s=(s&15)<<12|(i[n++]&63)<<6|i[n++]&63:(s&248)===240&&(s=(s&7)<<18|(i[n++]&63)<<12|(i[n++]&63)<<6|i[n++]&63),s>=65536?(s-=65536,a+=String.fromCharCode((s>>>10)+55296,(s&1023)+56320)):a+=String.fromCharCode(s)}return a}function Qn(e,t,r,i){var n;r||(r=0),!i&&i!==0&&(i=this.length),t||(t=0);var a=i-r;if(e===this&&r<t&&t<i)for(n=a-1;n>=0;n--)e[n+t]=this[n+r];else for(n=0;n<a;n++)e[n+t]=this[n+r];return a}var or=St;ye.copy=oi,ye.slice=ci,ye.toString=ea,ye.write=ta("write");var ge=Z,ni=ge.global,ai=ge.hasBuffer&&"TYPED_ARRAY_SUPPORT"in ni,si=ai&&!ni.TYPED_ARRAY_SUPPORT;function oi(e,t,r,i){var n=ge.isBuffer(this),a=ge.isBuffer(e);if(n&&a)return this.copy(e,t,r,i);if(!si&&!n&&!a&&ge.isView(this)&&ge.isView(e)){var s=r||i!=null?ci.call(this,r,i):this;return e.set(s,t),s.length}else return or.copy.call(this,e,t,r,i)}function ci(e,t){var r=this.slice||!si&&this.subarray;if(r)return r.call(this,e,t);var i=ge.alloc.call(this,t-e);return oi.call(this,i,0,e,t),i}function ea(e,t,r){var i=!ai&&ge.isBuffer(this)?this.toString:or.toString;return i.apply(this,arguments)}function ta(e){return t;function t(){var r=this[e]||or[e];return r.apply(this,arguments)}}(function(e){var t=e.global=Vn,r=e.hasBuffer=t&&!!t.isBuffer,i=e.hasArrayBuffer=typeof ArrayBuffer!="undefined",n=e.isArray=sr;e.isArrayBuffer=i?H:V;var a=e.isBuffer=r?t.isBuffer:V,s=e.isView=i?ArrayBuffer.isView||oe("ArrayBuffer","buffer"):V;e.alloc=O,e.concat=m,e.from=d;var f=e.Array=qr.exports,c=e.Buffer=ei.exports,_=e.Uint8Array=ri.exports,A=e.prototype=ye;function d(u){return typeof u=="string"?Y.call(this,u):se(this).from(u)}function O(u){return se(this).alloc(u)}function m(u,v){v||(v=0,Array.prototype.forEach.call(u,B));var N=this!==e&&this||u[0],b=O.call(N,v),E=0;return Array.prototype.forEach.call(u,o),b;function B(l){v+=l.length}function o(l){E+=A.copy.call(l,b,E)}}var x=oe("ArrayBuffer");function H(u){return u instanceof ArrayBuffer||x(u)}function Y(u){var v=u.length*3,N=O.call(this,v),b=A.write.call(N,u);return v!==b&&(N=A.slice.call(N,0,b)),N}function se(u){return a(u)?c:s(u)?_:n(u)?f:r?c:i?_:f}function V(){return!1}function oe(u,v){return u="[object "+u+"]",function(N){return N!=null&&{}.toString.call(v?N[v]:N)===u}}})(Z),Tt.ExtBuffer=cr;var ra=Z;function cr(e,t){if(!(this instanceof cr))return new cr(e,t);this.buffer=ra.from(e),this.type=t}var li={};li.setExtPackers=aa;var Lt=Z,ia=Lt.global,ne=Lt.Uint8Array.from,lr,na={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function aa(e){e.addExtPacker(14,Error,[Se,ee]),e.addExtPacker(1,EvalError,[Se,ee]),e.addExtPacker(2,RangeError,[Se,ee]),e.addExtPacker(3,ReferenceError,[Se,ee]),e.addExtPacker(4,SyntaxError,[Se,ee]),e.addExtPacker(5,TypeError,[Se,ee]),e.addExtPacker(6,URIError,[Se,ee]),e.addExtPacker(10,RegExp,[sa,ee]),e.addExtPacker(11,Boolean,[fr,ee]),e.addExtPacker(12,String,[fr,ee]),e.addExtPacker(13,Date,[Number,ee]),e.addExtPacker(15,Number,[fr,ee]),typeof Uint8Array!="undefined"&&(e.addExtPacker(17,Int8Array,ne),e.addExtPacker(18,Uint8Array,ne),e.addExtPacker(19,Int16Array,ne),e.addExtPacker(20,Uint16Array,ne),e.addExtPacker(21,Int32Array,ne),e.addExtPacker(22,Uint32Array,ne),e.addExtPacker(23,Float32Array,ne),typeof Float64Array!="undefined"&&e.addExtPacker(24,Float64Array,ne),typeof Uint8ClampedArray!="undefined"&&e.addExtPacker(25,Uint8ClampedArray,ne),e.addExtPacker(26,ArrayBuffer,ne),e.addExtPacker(29,DataView,ne)),Lt.hasBuffer&&e.addExtPacker(27,ia,Lt.from)}function ee(e){return lr||(lr=ir.encode),lr(e)}function fr(e){return e.valueOf()}function sa(e){e=RegExp.prototype.toString.call(e).split("/"),e.shift();var t=[e.pop()];return t.unshift(e.join("/")),t}function Se(e){var t={};for(var r in na)t[r]=e[r];return t}var fi={},Pt={};(function(e){(function(t){var r="undefined",i=r!==typeof Buffer&&Buffer,n=r!==typeof Uint8Array&&Uint8Array,a=r!==typeof ArrayBuffer&&ArrayBuffer,s=[0,0,0,0,0,0,0,0],f=Array.isArray||N,c=4294967296,_=16777216,A;d("Uint64BE",!0,!0),d("Int64BE",!0,!1),d("Uint64LE",!1,!0),d("Int64LE",!1,!1);function d(b,E,B){var o=E?0:4,l=E?4:0,h=E?0:3,L=E?1:2,G=E?2:1,Q=E?3:0,fe=E?V:u,et=E?oe:v,X=Be.prototype,Oe="is"+b,zt="_"+Oe;return X.buffer=void 0,X.offset=0,X[zt]=!0,X.toNumber=Sn,X.toString=Jo,X.toJSON=Sn,X.toArray=O,i&&(X.toBuffer=m),n&&(X.toArrayBuffer=x),Be[Oe]=Wr,t[b]=Be,Be;function Be(y,R,T,S){return this instanceof Be?Yo(this,y,R,T,S):new Be(y,R,T,S)}function Wr(y){return!!(y&&y[zt])}function Yo(y,R,T,S,W){if(n&&a&&(R instanceof a&&(R=new n(R)),S instanceof a&&(S=new n(S))),!R&&!T&&!S&&!A){y.buffer=se(s,0);return}if(!H(R,T)){var Ae=A||Array;W=T,S=R,T=0,R=new Ae(8)}y.buffer=R,y.offset=T|=0,r!==typeof S&&(typeof S=="string"?Vo(R,T,S,W||10):H(S,W)?Y(R,T,S,W):typeof W=="number"?(Zt(R,T+o,S),Zt(R,T+l,W)):S>0?fe(R,T,S):S<0?et(R,T,S):Y(R,T,s,0))}function Vo(y,R,T,S){var W=0,Ae=T.length,ve=0,ce=0;T[0]==="-"&&W++;for(var Xo=W;W<Ae;){var Ln=parseInt(T[W++],S);if(!(Ln>=0))break;ce=ce*S+Ln,ve=ve*S+Math.floor(ce/c),ce%=c}Xo&&(ve=~ve,ce?ce=c-ce:ve++),Zt(y,R+o,ve),Zt(y,R+l,ce)}function Sn(){var y=this.buffer,R=this.offset,T=qt(y,R+o),S=qt(y,R+l);return B||(T|=0),T?T*c+S:S}function Jo(y){var R=this.buffer,T=this.offset,S=qt(R,T+o),W=qt(R,T+l),Ae="",ve=!B&&S&2147483648;for(ve&&(S=~S,W=c-W),y=y||10;;){var ce=S%y*c+W;if(S=Math.floor(S/y),W=Math.floor(ce/y),Ae=(ce%y).toString(y)+Ae,!S&&!W)break}return ve&&(Ae="-"+Ae),Ae}function Zt(y,R,T){y[R+Q]=T&255,T=T>>8,y[R+G]=T&255,T=T>>8,y[R+L]=T&255,T=T>>8,y[R+h]=T&255}function qt(y,R){return y[R+h]*_+(y[R+L]<<16)+(y[R+G]<<8)+y[R+Q]}}function O(b){var E=this.buffer,B=this.offset;return A=null,b!==!1&&B===0&&E.length===8&&f(E)?E:se(E,B)}function m(b){var E=this.buffer,B=this.offset;if(A=i,b!==!1&&B===0&&E.length===8&&Buffer.isBuffer(E))return E;var o=new i(8);return Y(o,0,E,B),o}function x(b){var E=this.buffer,B=this.offset,o=E.buffer;if(A=n,b!==!1&&B===0&&o instanceof a&&o.byteLength===8)return o;var l=new n(8);return Y(l,0,E,B),l.buffer}function H(b,E){var B=b&&b.length;return E|=0,B&&E+8<=B&&typeof b[E]!="string"}function Y(b,E,B,o){E|=0,o|=0;for(var l=0;l<8;l++)b[E++]=B[o++]&255}function se(b,E){return Array.prototype.slice.call(b,E,E+8)}function V(b,E,B){for(var o=E+8;o>E;)b[--o]=B&255,B/=256}function oe(b,E,B){var o=E+8;for(B++;o>E;)b[--o]=-B&255^255,B/=256}function u(b,E,B){for(var o=E+8;E<o;)b[E++]=B&255,B/=256}function v(b,E,B){var o=E+8;for(B++;E<o;)b[E++]=-B&255^255,B/=256}function N(b){return!!b&&Object.prototype.toString.call(b)=="[object Array]"}})(typeof e.nodeName!="string"?e:Qt||{})})(Pt);var ui={},Nt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Nt.read=function(e,t,r,i,n){var a,s,f=n*8-i-1,c=(1<<f)-1,_=c>>1,A=-7,d=r?n-1:0,O=r?-1:1,m=e[t+d];for(d+=O,a=m&(1<<-A)-1,m>>=-A,A+=f;A>0;a=a*256+e[t+d],d+=O,A-=8);for(s=a&(1<<-A)-1,a>>=-A,A+=i;A>0;s=s*256+e[t+d],d+=O,A-=8);if(a===0)a=1-_;else{if(a===c)return s?NaN:(m?-1:1)*(1/0);s=s+Math.pow(2,i),a=a-_}return(m?-1:1)*s*Math.pow(2,a-i)},Nt.write=function(e,t,r,i,n,a){var s,f,c,_=a*8-n-1,A=(1<<_)-1,d=A>>1,O=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=i?0:a-1,x=i?1:-1,H=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(f=isNaN(t)?1:0,s=A):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),s+d>=1?t+=O/c:t+=O*Math.pow(2,1-d),t*c>=2&&(s++,c/=2),s+d>=A?(f=0,s=A):s+d>=1?(f=(t*c-1)*Math.pow(2,n),s=s+d):(f=t*Math.pow(2,d-1)*Math.pow(2,n),s=0));n>=8;e[r+m]=f&255,m+=x,f/=256,n-=8);for(s=s<<n|f,_+=n;_>0;e[r+m]=s&255,m+=x,s/=256,_-=8);e[r+m-x]|=H*128};for(var ur={},oa=ur.uint8=new Array(256),wt=0;wt<=255;wt++)oa[wt]=ca(wt);function ca(e){return function(t){var r=t.reserve(1);t.buffer[r]=e}}var hi=Nt,di=Pt,la=di.Uint64BE,fa=di.Int64BE,Ei=ur.uint8,Dt=Z,D=Dt.global,ua=Dt.hasBuffer&&"TYPED_ARRAY_SUPPORT"in D,ha=ua&&!D.TYPED_ARRAY_SUPPORT,pi=Dt.hasBuffer&&D.prototype||{};ui.getWriteToken=da;function da(e){return e&&e.uint8array?Ea():ha||Dt.hasBuffer&&e&&e.safe?pa():Ai()}function Ea(){var e=Ai();return e[202]=P(202,4,xi),e[203]=P(203,8,mi),e}function Ai(){var e=Ei.slice();return e[196]=st(196),e[197]=Le(197),e[198]=Pe(198),e[199]=st(199),e[200]=Le(200),e[201]=Pe(201),e[202]=P(202,4,pi.writeFloatBE||xi,!0),e[203]=P(203,8,pi.writeDoubleBE||mi,!0),e[204]=st(204),e[205]=Le(205),e[206]=Pe(206),e[207]=P(207,8,vi),e[208]=st(208),e[209]=Le(209),e[210]=Pe(210),e[211]=P(211,8,gi),e[217]=st(217),e[218]=Le(218),e[219]=Pe(219),e[220]=Le(220),e[221]=Pe(221),e[222]=Le(222),e[223]=Pe(223),e}function pa(){var e=Ei.slice();return e[196]=P(196,1,D.prototype.writeUInt8),e[197]=P(197,2,D.prototype.writeUInt16BE),e[198]=P(198,4,D.prototype.writeUInt32BE),e[199]=P(199,1,D.prototype.writeUInt8),e[200]=P(200,2,D.prototype.writeUInt16BE),e[201]=P(201,4,D.prototype.writeUInt32BE),e[202]=P(202,4,D.prototype.writeFloatBE),e[203]=P(203,8,D.prototype.writeDoubleBE),e[204]=P(204,1,D.prototype.writeUInt8),e[205]=P(205,2,D.prototype.writeUInt16BE),e[206]=P(206,4,D.prototype.writeUInt32BE),e[207]=P(207,8,vi),e[208]=P(208,1,D.prototype.writeInt8),e[209]=P(209,2,D.prototype.writeInt16BE),e[210]=P(210,4,D.prototype.writeInt32BE),e[211]=P(211,8,gi),e[217]=P(217,1,D.prototype.writeUInt8),e[218]=P(218,2,D.prototype.writeUInt16BE),e[219]=P(219,4,D.prototype.writeUInt32BE),e[220]=P(220,2,D.prototype.writeUInt16BE),e[221]=P(221,4,D.prototype.writeUInt32BE),e[222]=P(222,2,D.prototype.writeUInt16BE),e[223]=P(223,4,D.prototype.writeUInt32BE),e}function st(e){return function(t,r){var i=t.reserve(2),n=t.buffer;n[i++]=e,n[i]=r}}function Le(e){return function(t,r){var i=t.reserve(3),n=t.buffer;n[i++]=e,n[i++]=r>>>8,n[i]=r}}function Pe(e){return function(t,r){var i=t.reserve(5),n=t.buffer;n[i++]=e,n[i++]=r>>>24,n[i++]=r>>>16,n[i++]=r>>>8,n[i]=r}}function P(e,t,r,i){return function(n,a){var s=n.reserve(t+1);n.buffer[s++]=e,r.call(n.buffer,a,s,i)}}function vi(e,t){new la(this,t,e)}function gi(e,t){new fa(this,t,e)}function xi(e,t){hi.write(this,e,t,!1,23,4)}function mi(e,t){hi.write(this,e,t,!1,52,8)}var Aa=sr,_i=Pt,va=_i.Uint64BE,ga=_i.Int64BE,Ri=Z,Ti=ye,xa=ui,ma=ur.uint8,_a=Tt.ExtBuffer,Ra=typeof Uint8Array!="undefined",Ta=typeof Map!="undefined",je=[];je[1]=212,je[2]=213,je[4]=214,je[8]=215,je[16]=216,fi.getWriteType=ba;function ba(e){var t=xa.getWriteToken(e),r=e&&e.useraw,i=Ra&&e&&e.binarraybuffer,n=i?Ri.isArrayBuffer:Ri.isBuffer,a=i?v:u,s=Ta&&e&&e.usemap,f=s?E:b,c={boolean:_,function:V,number:A,object:r?se:Y,string:H(r?x:m),symbol:V,undefined:V};return c;function _(o,l){var h=l?195:194;t[h](o,l)}function A(o,l){var h=l|0,L;if(l!==h){L=203,t[L](o,l);return}else-32<=h&&h<=127?L=h&255:0<=h?L=h<=255?204:h<=65535?205:206:L=-128<=h?208:-32768<=h?209:210;t[L](o,h)}function d(o,l){var h=207;t[h](o,l.toArray())}function O(o,l){var h=211;t[h](o,l.toArray())}function m(o){return o<32?1:o<=255?2:o<=65535?3:5}function x(o){return o<32?1:o<=65535?3:5}function H(o){return l;function l(h,L){var G=L.length,Q=5+G*3;h.offset=h.reserve(Q);var fe=h.buffer,et=o(G),X=h.offset+et;G=Ti.write.call(fe,L,X);var Oe=o(G);if(et!==Oe){var zt=X+Oe-et,Be=X+G;Ti.copy.call(fe,fe,zt,X,Be)}var Wr=Oe===1?160+G:Oe<=3?215+Oe:219;t[Wr](h,G),h.offset+=G}}function Y(o,l){if(l===null)return V(o,l);if(n(l))return a(o,l);if(Aa(l))return oe(o,l);if(va.isUint64BE(l))return d(o,l);if(ga.isInt64BE(l))return O(o,l);var h=o.codec.getExtPacker(l);if(h&&(l=h(l)),l instanceof _a)return N(o,l);f(o,l)}function se(o,l){if(n(l))return B(o,l);Y(o,l)}function V(o,l){var h=192;t[h](o,l)}function oe(o,l){var h=l.length,L=h<16?144+h:h<=65535?220:221;t[L](o,h);for(var G=o.codec.encode,Q=0;Q<h;Q++)G(o,l[Q])}function u(o,l){var h=l.length,L=h<255?196:h<=65535?197:198;t[L](o,h),o.send(l)}function v(o,l){u(o,new Uint8Array(l))}function N(o,l){var h=l.buffer,L=h.length,G=je[L]||(L<255?199:L<=65535?200:201);t[G](o,L),ma[l.type](o),o.send(h)}function b(o,l){var h=Object.keys(l),L=h.length,G=L<16?128+L:L<=65535?222:223;t[G](o,L);var Q=o.codec.encode;h.forEach(function(fe){Q(o,fe),Q(o,l[fe])})}function E(o,l){if(!(l instanceof Map))return b(o,l);var h=l.size,L=h<16?128+h:h<=65535?222:223;t[L](o,h);var G=o.codec.encode;l.forEach(function(Q,fe,et){G(o,fe),G(o,Q)})}function B(o,l){var h=l.length,L=h<32?160+h:h<=65535?218:219;t[L](o,h),o.send(l)}}var xe={},Oa=sr;xe.createCodec=bi,xe.install=ya,xe.filter=Pa;var Ba=Z;function Ye(e){if(!(this instanceof Ye))return new Ye(e);this.options=e,this.init()}Ye.prototype.init=function(){var e=this.options;return e&&e.uint8array&&(this.bufferish=Ba.Uint8Array),this};function ya(e){for(var t in e)Ye.prototype[t]=Sa(Ye.prototype[t],e[t])}function Sa(e,t){return e&&t?r:e||t;function r(){return e.apply(this,arguments),t.apply(this,arguments)}}function La(e){return e=e.slice(),function(r){return e.reduce(t,r)};function t(r,i){return i(r)}}function Pa(e){return Oa(e)?La(e):e}function bi(e){return new Ye(e)}xe.preset=bi({preset:!0});var Na=Tt.ExtBuffer,wa=li,Da=fi,hr=xe;hr.install({addExtPacker:Ua,getExtPacker:Ca,init:Oi}),Zr.preset=Oi.call(hr.preset);function Ma(e){var t=Da.getWriteType(e);return r;function r(i,n){var a=t[typeof n];if(!a)throw new Error('Unsupported type "'+typeof n+'": '+n);a(i,n)}}function Oi(){var e=this.options;return this.encode=Ma(e),e&&e.preset&&wa.setExtPackers(this),this}function Ua(e,t,r){r=hr.filter(r);var i=t.name;if(i&&i!=="Object"){var n=this.extPackers||(this.extPackers={});n[i]=s}else{var a=this.extEncoderList||(this.extEncoderList=[]);a.unshift([t,s])}function s(f){return r&&(f=r(f)),new Na(f,e)}}function Ca(e){var t=this.extPackers||(this.extPackers={}),r=e.constructor,i=r&&r.name&&t[r.name];if(i)return i;for(var n=this.extEncoderList||(this.extEncoderList=[]),a=n.length,s=0;s<a;s++){var f=n[s];if(r===f[0])return f[1]}}var Mt={};Mt.FlexDecoder=Ve,Mt.FlexEncoder=Je;var ot=Z,ka=2048,Ga=65536,Bi="BUFFER_SHORTAGE";function Ve(){if(!(this instanceof Ve))return new Ve}function Je(){if(!(this instanceof Je))return new Je}Ve.mixin=Li(Fa()),Ve.mixin(Ve.prototype),Je.mixin=Li(Ka()),Je.mixin(Je.prototype);function Fa(){return{bufferish:ot,write:e,fetch:Ha,flush:t,push:Si,pull:$a,read:yi,reserve:r,offset:0};function e(i){var n=this.offset?ot.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=n?i?this.bufferish.concat([n,i]):n:i,this.offset=0}function t(){for(;this.offset<this.buffer.length;){var i=this.offset,n;try{n=this.fetch()}catch(a){if(a&&a.message!=Bi)throw a;this.offset=i;break}this.push(n)}}function r(i){var n=this.offset,a=n+i;if(a>this.buffer.length)throw new Error(Bi);return this.offset=a,n}}function Ka(){return{bufferish:ot,write:Wa,fetch:e,flush:t,push:Si,pull:r,read:yi,reserve:i,send:n,maxBufferSize:Ga,minBufferSize:ka,offset:0,start:0};function e(){var a=this.start;if(a<this.offset){var s=this.start=this.offset;return ot.prototype.slice.call(this.buffer,a,s)}}function t(){for(;this.start<this.offset;){var a=this.fetch();a&&this.push(a)}}function r(){var a=this.buffers||(this.buffers=[]),s=a.length>1?this.bufferish.concat(a):a[0];return a.length=0,s}function i(a){var s=a|0;if(this.buffer){var f=this.buffer.length,c=this.offset|0,_=c+s;if(_<f)return this.offset=_,c;this.flush(),a=Math.max(a,Math.min(f*2,this.maxBufferSize))}return a=Math.max(a,this.minBufferSize),this.buffer=this.bufferish.alloc(a),this.start=0,this.offset=s,0}function n(a){var s=a.length;if(s>this.minBufferSize)this.flush(),this.push(a);else{var f=this.reserve(s);ot.prototype.copy.call(a,this.buffer,f)}}}function Wa(){throw new Error("method not implemented: write()")}function Ha(){throw new Error("method not implemented: fetch()")}function yi(){var e=this.buffers&&this.buffers.length;return e?(this.flush(),this.pull()):this.fetch()}function Si(e){var t=this.buffers||(this.buffers=[]);t.push(e)}function $a(){var e=this.buffers||(this.buffers=[]);return e.shift()}function Li(e){return t;function t(r){for(var i in e)r[i]=e[i];return r}}nr.EncodeBuffer=Xe;var ja=Zr.preset,Ya=Mt.FlexEncoder;Ya.mixin(Xe.prototype);function Xe(e){if(!(this instanceof Xe))return new Xe(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}Xe.prototype.codec=ja,Xe.prototype.write=function(e){this.codec.encode(this,e)},ir.encode=Ja;var Va=nr.EncodeBuffer;function Ja(e,t){var r=new Va(t);return r.write(e),r.read()}var dr={},Er={},Pi={},Ni={};Ni.setExtUnpackers=za;var wi=Z,Xa=wi.global,pr,Ia={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function za(e){e.addExtUnpacker(14,[te,Ne(Error)]),e.addExtUnpacker(1,[te,Ne(EvalError)]),e.addExtUnpacker(2,[te,Ne(RangeError)]),e.addExtUnpacker(3,[te,Ne(ReferenceError)]),e.addExtUnpacker(4,[te,Ne(SyntaxError)]),e.addExtUnpacker(5,[te,Ne(TypeError)]),e.addExtUnpacker(6,[te,Ne(URIError)]),e.addExtUnpacker(10,[te,Za]),e.addExtUnpacker(11,[te,$(Boolean)]),e.addExtUnpacker(12,[te,$(String)]),e.addExtUnpacker(13,[te,$(Date)]),e.addExtUnpacker(15,[te,$(Number)]),typeof Uint8Array!="undefined"&&(e.addExtUnpacker(17,$(Int8Array)),e.addExtUnpacker(18,$(Uint8Array)),e.addExtUnpacker(19,[me,$(Int16Array)]),e.addExtUnpacker(20,[me,$(Uint16Array)]),e.addExtUnpacker(21,[me,$(Int32Array)]),e.addExtUnpacker(22,[me,$(Uint32Array)]),e.addExtUnpacker(23,[me,$(Float32Array)]),typeof Float64Array!="undefined"&&e.addExtUnpacker(24,[me,$(Float64Array)]),typeof Uint8ClampedArray!="undefined"&&e.addExtUnpacker(25,$(Uint8ClampedArray)),e.addExtUnpacker(26,me),e.addExtUnpacker(29,[me,$(DataView)])),wi.hasBuffer&&e.addExtUnpacker(27,$(Xa))}function te(e){return pr||(pr=dr.decode),pr(e)}function Za(e){return RegExp.apply(null,e)}function Ne(e){return function(t){var r=new e;for(var i in Ia)r[i]=t[i];return r}}function $(e){return function(t){return new e(t)}}function me(e){return new Uint8Array(e).buffer}var Ut={},Di=Nt,Mi=Pt,Ui=Mi.Uint64BE,Ci=Mi.Int64BE;Ut.getReadFormat=es,Ut.readUint8=ki;var Ar=Z,Ct=ye,qa=typeof Map!="undefined",Qa=!0;function es(e){var t=Ar.hasArrayBuffer&&e&&e.binarraybuffer,r=e&&e.int64,i=qa&&e&&e.usemap,n={map:i?rs:ts,array:is,str:ns,bin:t?ss:as,ext:os,uint8:ki,uint16:ls,uint32:us,uint64:kt(8,r?ps:ds),int8:cs,int16:fs,int32:hs,int64:kt(8,r?As:Es),float32:kt(4,vs),float64:kt(8,gs)};return n}function ts(e,t){var r={},i,n=new Array(t),a=new Array(t),s=e.codec.decode;for(i=0;i<t;i++)n[i]=s(e),a[i]=s(e);for(i=0;i<t;i++)r[n[i]]=a[i];return r}function rs(e,t){var r=new Map,i,n=new Array(t),a=new Array(t),s=e.codec.decode;for(i=0;i<t;i++)n[i]=s(e),a[i]=s(e);for(i=0;i<t;i++)r.set(n[i],a[i]);return r}function is(e,t){for(var r=new Array(t),i=e.codec.decode,n=0;n<t;n++)r[n]=i(e);return r}function ns(e,t){var r=e.reserve(t),i=r+t;return Ct.toString.call(e.buffer,"utf-8",r,i)}function as(e,t){var r=e.reserve(t),i=r+t,n=Ct.slice.call(e.buffer,r,i);return Ar.from(n)}function ss(e,t){var r=e.reserve(t),i=r+t,n=Ct.slice.call(e.buffer,r,i);return Ar.Uint8Array.from(n).buffer}function os(e,t){var r=e.reserve(t+1),i=e.buffer[r++],n=r+t,a=e.codec.getExtUnpacker(i);if(!a)throw new Error("Invalid ext type: "+(i&&"0x"+i.toString(16)));var s=Ct.slice.call(e.buffer,r,n);return a(s)}function ki(e){var t=e.reserve(1);return e.buffer[t]}function cs(e){var t=e.reserve(1),r=e.buffer[t];return r&128?r-256:r}function ls(e){var t=e.reserve(2),r=e.buffer;return r[t++]<<8|r[t]}function fs(e){var t=e.reserve(2),r=e.buffer,i=r[t++]<<8|r[t];return i&32768?i-65536:i}function us(e){var t=e.reserve(4),r=e.buffer;return r[t++]*16777216+(r[t++]<<16)+(r[t++]<<8)+r[t]}function hs(e){var t=e.reserve(4),r=e.buffer;return r[t++]<<24|r[t++]<<16|r[t++]<<8|r[t]}function kt(e,t){return function(r){var i=r.reserve(e);return t.call(r.buffer,i,Qa)}}function ds(e){return new Ui(this,e).toNumber()}function Es(e){return new Ci(this,e).toNumber()}function ps(e){return new Ui(this,e)}function As(e){return new Ci(this,e)}function vs(e){return Di.read(this,e,!1,23,4)}function gs(e){return Di.read(this,e,!1,52,8)}var Gi={},xs=Ut;Gi.getReadToken=ms;function ms(e){var t=xs.getReadFormat(e);return e&&e.useraw?_s(t):Fi(t)}function Fi(e){var t,r=new Array(256);for(t=0;t<=127;t++)r[t]=ct(t);for(t=128;t<=143;t++)r[t]=he(t-128,e.map);for(t=144;t<=159;t++)r[t]=he(t-144,e.array);for(t=160;t<=191;t++)r[t]=he(t-160,e.str);for(r[192]=ct(null),r[193]=null,r[194]=ct(!1),r[195]=ct(!0),r[196]=q(e.uint8,e.bin),r[197]=q(e.uint16,e.bin),r[198]=q(e.uint32,e.bin),r[199]=q(e.uint8,e.ext),r[200]=q(e.uint16,e.ext),r[201]=q(e.uint32,e.ext),r[202]=e.float32,r[203]=e.float64,r[204]=e.uint8,r[205]=e.uint16,r[206]=e.uint32,r[207]=e.uint64,r[208]=e.int8,r[209]=e.int16,r[210]=e.int32,r[211]=e.int64,r[212]=he(1,e.ext),r[213]=he(2,e.ext),r[214]=he(4,e.ext),r[215]=he(8,e.ext),r[216]=he(16,e.ext),r[217]=q(e.uint8,e.str),r[218]=q(e.uint16,e.str),r[219]=q(e.uint32,e.str),r[220]=q(e.uint16,e.array),r[221]=q(e.uint32,e.array),r[222]=q(e.uint16,e.map),r[223]=q(e.uint32,e.map),t=224;t<=255;t++)r[t]=ct(t-256);return r}function _s(e){var t,r=Fi(e).slice();for(r[217]=r[196],r[218]=r[197],r[219]=r[198],t=160;t<=191;t++)r[t]=he(t-160,e.bin);return r}function ct(e){return function(){return e}}function q(e,t){return function(r){var i=e(r);return t(r,i)}}function he(e,t){return function(r){return t(r,e)}}var Rs=Tt.ExtBuffer,Ts=Ni,bs=Ut.readUint8,Os=Gi,vr=xe;vr.install({addExtUnpacker:ys,getExtUnpacker:Ss,init:Ki}),Pi.preset=Ki.call(vr.preset);function Bs(e){var t=Os.getReadToken(e);return r;function r(i){var n=bs(i),a=t[n];if(!a)throw new Error("Invalid type: "+(n&&"0x"+n.toString(16)));return a(i)}}function Ki(){var e=this.options;return this.decode=Bs(e),e&&e.preset&&Ts.setExtUnpackers(this),this}function ys(e,t){var r=this.extUnpackers||(this.extUnpackers=[]);r[e]=vr.filter(t)}function Ss(e){var t=this.extUnpackers||(this.extUnpackers=[]);return t[e]||r;function r(i){return new Rs(i,e)}}Er.DecodeBuffer=Ie;var Ls=Pi.preset,Ps=Mt.FlexDecoder;Ps.mixin(Ie.prototype);function Ie(e){if(!(this instanceof Ie))return new Ie(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}Ie.prototype.codec=Ls,Ie.prototype.fetch=function(){return this.codec.decode(this)},dr.decode=ws;var Ns=Er.DecodeBuffer;function ws(e,t){var r=new Ns(t);return r.write(e),r.read()}var gr={exports:{}};/**
 * event-lite.js - Light-weight EventEmitter (less than 1KB when gzipped)
 *
 * @copyright Yusuke Kawasaki
 * @license MIT
 * @constructor
 * @see https://github.com/kawanet/event-lite
 * @see http://kawanet.github.io/event-lite/EventLite.html
 * @example
 * var EventLite = require("event-lite");
 *
 * function MyClass() {...}             // your class
 *
 * EventLite.mixin(MyClass.prototype);  // import event methods
 *
 * var obj = new MyClass();
 * obj.on("foo", function() {...});     // add event listener
 * obj.once("bar", function() {...});   // add one-time event listener
 * obj.emit("foo");                     // dispatch event
 * obj.emit("bar");                     // dispatch another event
 * obj.off("foo");                      // remove event listener
 */(function(e){function t(){if(!(this instanceof t))return new t}(function(r){e.exports=r;var i="listeners",n={on:s,once:f,off:c,emit:_};a(r.prototype),r.mixin=a;function a(d){for(var O in n)d[O]=n[O];return d}function s(d,O){return A(this,d).push(O),this}function f(d,O){var m=this;return x.originalListener=O,A(m,d).push(x),m;function x(){c.call(m,d,x),O.apply(this,arguments)}}function c(d,O){var m=this,x;if(!arguments.length)delete m[i];else if(O){if(x=A(m,d,!0),x){if(x=x.filter(H),!x.length)return c.call(m,d);m[i][d]=x}}else if(x=m[i],x&&(delete x[d],!Object.keys(x).length))return c.call(m);return m;function H(Y){return Y!==O&&Y.originalListener!==O}}function _(d,O){var m=this,x=A(m,d,!0);if(!x)return!1;var H=arguments.length;if(H===1)x.forEach(se);else if(H===2)x.forEach(V);else{var Y=Array.prototype.slice.call(arguments,1);x.forEach(oe)}return!!x.length;function se(u){u.call(m)}function V(u){u.call(m,O)}function oe(u){u.apply(m,Y)}}function A(d,O,m){if(!(m&&!d[i])){var x=d[i]||(d[i]={});return x[O]||(x[O]=[])}}})(t)})(gr);var Ds=gr.exports,Wi=nr.EncodeBuffer;function ze(e){if(!(this instanceof ze))return new ze(e);Wi.call(this,e)}ze.prototype=new Wi,Ds.mixin(ze.prototype),ze.prototype.encode=function(e){this.write(e),this.emit("data",this.read())},ze.prototype.end=function(e){arguments.length&&this.encode(e),this.flush(),this.emit("end")};var Ms=gr.exports,Hi=Er.DecodeBuffer;function we(e){if(!(this instanceof we))return new we(e);Hi.call(this,e)}we.prototype=new Hi,Ms.mixin(we.prototype),we.prototype.decode=function(e){arguments.length&&this.write(e),this.flush()},we.prototype.push=function(e){this.emit("data",e)},we.prototype.end=function(e){this.decode(e),this.emit("end")},xe.createCodec,xe.preset;var xr=ir.encode,Gt=dr.decode,Ft;(function(e){e[e.BROWN=0]="BROWN",e[e.BEIGE=1]="BEIGE",e[e.DARKBROWN=2]="DARKBROWN",e[e.PEACH=3]="PEACH",e[e.WHITE=4]="WHITE",e[e.RED=5]="RED",e[e.BLACK=6]="BLACK",e[e.PINK=7]="PINK",e[e.BLUE=8]="BLUE",e[e.GREEN=9]="GREEN",e.SECRETLIGHTBLUE="length"})(Ft||(Ft={}));class Us{constructor(t,r,i){this.cb=t,this.msInterval=r,this.code=i,this.intervalId=null}start(t){this.code!=t||this.intervalId!=null||(this.intervalId=setInterval(this.cb,this.msInterval))}stop(t){this.code!=t||this.intervalId==null||(clearInterval(this.intervalId),this.intervalId=null)}}class Cs extends at{constructor(t,r,i,n,a,s,f,c){super(r,i),this.id=t,this.dir=n,this.scale=a,this.type=s,this.buildType=f,this.ownerSid=c}}var lt;(function(e){e[e.PLAYERLEAVE=0]="PLAYERLEAVE",e[e.BUILDINGBREAK=1]="BUILDINGBREAK"})(lt||(lt={}));var mr;(function(e){e[e.SHAME=45]="SHAME",e[e.MOO_CAP=51]="MOO_CAP",e[e.APPLE_CAP=50]="APPLE_CAP",e[e.MOO_HEAD=28]="MOO_HEAD",e[e.PIG_HEAD=29]="PIG_HEAD",e[e.FLUFF_HEAD=30]="FLUFF_HEAD",e[e.PANDOU_HEAD=36]="PANDOU_HEAD",e[e.BEAR_HEAD=37]="BEAR_HEAD",e[e.MONKEY_HEAD=38]="MONKEY_HEAD",e[e.POLAR_HEAD=44]="POLAR_HEAD",e[e.FEZ_HAT=35]="FEZ_HAT",e[e.ENIGMA_HAT=42]="ENIGMA_HAT",e[e.BLITZ_HAT=43]="BLITZ_HAT",e[e.BOB_XIII_HAT=49]="BOB_XIII_HAT",e[e.PUMPKIN=57]="PUMPKIN",e[e.BUMMLE_HAT=8]="BUMMLE_HAT",e[e.STRAW_HAT=2]="STRAW_HAT",e[e.WINTER_CAP=15]="WINTER_CAP",e[e.COWBOY_HAT=5]="COWBOY_HAT",e[e.RANGER_HAT=4]="RANGER_HAT",e[e.EXPLORER_HAT=18]="EXPLORER_HAT",e[e.FLIPPER_HAT=31]="FLIPPER_HAT",e[e.MARKSMAN_CAP=1]="MARKSMAN_CAP",e[e.BUSH_GEAR=10]="BUSH_GEAR",e[e.HALO=48]="HALO",e[e.SOLDIER_HELMET=6]="SOLDIER_HELMET",e[e.ANTI_VENOM_GEAR=23]="ANTI_VENOM_GEAR",e[e.MEDIC_GEAR=13]="MEDIC_GEAR",e[e.MINERS_HELMET=9]="MINERS_HELMET",e[e.MUSKETEER_HAT=32]="MUSKETEER_HAT",e[e.BULL_HELMET=7]="BULL_HELMET",e[e.EMP_HELMET=22]="EMP_HELMET",e[e.BOOSTER_HAT=12]="BOOSTER_HAT",e[e.BARBARIAN_ARMOR=26]="BARBARIAN_ARMOR",e[e.PLAGUE_MASK=21]="PLAGUE_MASK",e[e.BULL_MASK=46]="BULL_MASK",e[e.WINDMILL_HAT=14]="WINDMILL_HAT",e[e.SPIKE_GEAR=11]="SPIKE_GEAR",e[e.TURRET_GEAR=53]="TURRET_GEAR",e[e.SAMURAI_ARMOR=20]="SAMURAI_ARMOR",e[e.DARK_KNIGHT=58]="DARK_KNIGHT",e[e.SCAVENGER_GEAR=27]="SCAVENGER_GEAR",e[e.TANK_GEAR=40]="TANK_GEAR",e[e.THIEF_GEAR=40]="THIEF_GEAR",e[e.BLOODTHIRSTER=55]="BLOODTHIRSTER",e[e.Assassin_GEAR=56]="Assassin_GEAR"})(mr||(mr={}));const ks=[{id:45,name:"Shame!",dontSell:!0,price:0,scale:120,desc:"hacks are for losers"},{id:51,name:"Moo Cap",price:0,scale:120,desc:"coolest mooer around"},{id:50,name:"Apple Cap",price:0,scale:120,desc:"apple farms remembers"},{id:28,name:"Moo Head",price:0,scale:120,desc:"no effect"},{id:29,name:"Pig Head",price:0,scale:120,desc:"no effect"},{id:30,name:"Fluff Head",price:0,scale:120,desc:"no effect"},{id:36,name:"Pandou Head",price:0,scale:120,desc:"no effect"},{id:37,name:"Bear Head",price:0,scale:120,desc:"no effect"},{id:38,name:"Monkey Head",price:0,scale:120,desc:"no effect"},{id:44,name:"Polar Head",price:0,scale:120,desc:"no effect"},{id:35,name:"Fez Hat",price:0,scale:120,desc:"no effect"},{id:42,name:"Enigma Hat",price:0,scale:120,desc:"join the enigma army"},{id:43,name:"Blitz Hat",price:0,scale:120,desc:"hey everybody i'm blitz"},{id:49,name:"Bob XIII Hat",price:0,scale:120,desc:"like and subscribe"},{id:57,name:"Pumpkin",price:50,scale:120,desc:"Spooooky"},{id:8,name:"Bummle Hat",price:100,scale:120,desc:"no effect"},{id:2,name:"Straw Hat",price:500,scale:120,desc:"no effect"},{id:15,name:"Winter Cap",price:600,scale:120,desc:"allows you to move at normal speed in snow",coldM:1},{id:5,name:"Cowboy Hat",price:1e3,scale:120,desc:"no effect"},{id:4,name:"Ranger Hat",price:2e3,scale:120,desc:"no effect"},{id:18,name:"Explorer Hat",price:2e3,scale:120,desc:"no effect"},{id:31,name:"Flipper Hat",price:2500,scale:120,desc:"have more control while in water",watrImm:!0},{id:1,name:"Marksman Cap",price:3e3,scale:120,desc:"increases arrow speed and range",aMlt:1.3},{id:10,name:"Bush Gear",price:3e3,scale:160,desc:"allows you to disguise yourself as a bush"},{id:48,name:"Halo",price:3e3,scale:120,desc:"no effect"},{id:6,name:"Soldier Helmet",price:4e3,scale:120,desc:"reduces damage taken but slows movement",spdMult:.94,dmgMult:.75},{id:23,name:"Anti Venom Gear",price:4e3,scale:120,desc:"makes you immune to poison",poisonRes:1},{id:13,name:"Medic Gear",price:5e3,scale:110,desc:"slowly regenerates health over time",healthRegen:3},{id:9,name:"Miners Helmet",price:5e3,scale:120,desc:"earn 1 extra gold per resource",extraGold:1},{id:32,name:"Musketeer Hat",price:5e3,scale:120,desc:"reduces cost of projectiles",projCost:.5},{id:7,name:"Bull Helmet",price:6e3,scale:120,desc:"increases damage done but drains health",healthRegen:-5,dmgMultO:1.5,spdMult:.96},{id:22,name:"Emp Helmet",price:6e3,scale:120,desc:"turrets won't attack but you move slower",antiTurret:1,spdMult:.7},{id:12,name:"Booster Hat",price:6e3,scale:120,desc:"increases your movement speed",spdMult:1.16},{id:26,name:"Barbarian Armor",price:8e3,scale:120,desc:"knocks back enemies that attack you",dmgK:.6},{id:21,name:"Plague Mask",price:1e4,scale:120,desc:"melee attacks deal poison damage",poisonDmg:5,poisonTime:6},{id:46,name:"Bull Mask",price:1e4,scale:120,desc:"bulls won't target you unless you attack them",bullRepel:1},{id:14,name:"Windmill Hat",topSprite:!0,price:1e4,scale:120,desc:"generates points while worn",pps:1.5},{id:11,name:"Spike Gear",topSprite:!0,price:1e4,scale:120,desc:"deal damage to players that damage you",dmg:.45},{id:53,name:"Turret Gear",topSprite:!0,price:1e4,scale:120,desc:"you become a walking turret",turret:{proj:1,range:700,rate:2500},spdMult:.7},{id:20,name:"Samurai Armor",price:12e3,scale:120,desc:"increased attack speed and fire rate",atkSpd:.78},{id:58,name:"Dark Knight",price:12e3,scale:120,desc:"restores health when you deal damage",healD:.4},{id:27,name:"Scavenger Gear",price:15e3,scale:120,desc:"earn double points for each kill",kScrM:2},{id:40,name:"Tank Gear",price:15e3,scale:120,desc:"increased damage to buildings but slower movement",spdMult:.3,bDmg:3.3},{id:52,name:"Thief Gear",price:15e3,scale:120,desc:"steal half of a players gold when you kill them",goldSteal:.5},{id:55,name:"Bloodthirster",price:2e4,scale:120,desc:"Restore Health when dealing damage. And increased damage",healD:.25,dmgMultO:1.2},{id:56,name:"Assassin Gear",price:2e4,scale:120,desc:"Go invisible when not moving. Can't eat. Increased speed",noEat:!0,spdMult:1.1,invisTimer:1e3}];var _r;(function(e){e[e.SNOWBALL=12]="SNOWBALL",e[e.TREE_CAPE=9]="TREE_CAPE",e[e.STONE_CAPE=10]="STONE_CAPE",e[e.COOKIE_CAPE=3]="COOKIE_CAPE",e[e.COW_CAPE=8]="COW_CAPE",e[e.MONKEY_TAIL=11]="MONKEY_TAIL",e[e.APPLE_BASKET=17]="APPLE_BASKET",e[e.WINTER_CAPE=6]="WINTER_CAPE",e[e.SKULL_CAPE=4]="SKULL_CAPE",e[e.DASH_CAPE=5]="DASH_CAPE",e[e.DRAGON_CAPE=2]="DRAGON_CAPE",e[e.SUPER_CAPE=1]="SUPER_CAPE",e[e.TROLL_CAPE=7]="TROLL_CAPE",e[e.THORNS=14]="THORNS",e[e.BLOCKADES=15]="BLOCKADES",e[e.DEVILS_TAIL=20]="DEVILS_TAIL",e[e.SAWBLADE=16]="SAWBLADE",e[e.ANGEL_WINGS=13]="ANGEL_WINGS",e[e.SHADOW_WINGS=19]="SHADOW_WINGS",e[e.BLOOD_WINGS=18]="BLOOD_WINGS",e[e.CORRUPT_X_WINGS=21]="CORRUPT_X_WINGS"})(_r||(_r={}));const Gs=[{id:12,name:"Snowball",price:1e3,scale:105,xOff:18,desc:"no effect"},{id:9,name:"Tree Cape",price:1e3,scale:90,desc:"no effect"},{id:10,name:"Stone Cape",price:1e3,scale:90,desc:"no effect"},{id:3,name:"Cookie Cape",price:1500,scale:90,desc:"no effect"},{id:8,name:"Cow Cape",price:2e3,scale:90,desc:"no effect"},{id:11,name:"Monkey Tail",price:2e3,scale:97,xOff:25,desc:"Super speed but reduced damage",spdMult:1.35,dmgMultO:.2},{id:17,name:"Apple Basket",price:3e3,scale:80,xOff:12,desc:"slowly regenerates health over time",healthRegen:1},{id:6,name:"Winter Cape",price:3e3,scale:90,desc:"no effect"},{id:4,name:"Skull Cape",price:4e3,scale:90,desc:"no effect"},{id:5,name:"Dash Cape",price:5e3,scale:90,desc:"no effect"},{id:2,name:"Dragon Cape",price:6e3,scale:90,desc:"no effect"},{id:1,name:"Super Cape",price:8e3,scale:90,desc:"no effect"},{id:7,name:"Troll Cape",price:8e3,scale:90,desc:"no effect"},{id:14,name:"Thorns",price:1e4,scale:115,xOff:20,desc:"no effect"},{id:15,name:"Blockades",price:1e4,scale:95,xOff:15,desc:"no effect"},{id:20,name:"Devils Tail",price:1e4,scale:95,xOff:20,desc:"no effect"},{id:16,name:"Sawblade",price:12e3,scale:90,spin:!0,xOff:0,desc:"deal damage to players that damage you",dmg:.15},{id:13,name:"Angel Wings",price:15e3,scale:138,xOff:22,desc:"slowly regenerates health over time",healthRegen:3},{id:19,name:"Shadow Wings",price:15e3,scale:138,xOff:22,desc:"increased movement speed",spdMult:1.1},{id:18,name:"Blood Wings",price:2e4,scale:178,xOff:26,desc:"restores health when you deal damage",healD:.2},{id:21,name:"Corrupt X Wings",price:2e4,scale:178,xOff:26,desc:"deal damage to players that damage you",dmg:.25}];var $i;(function(e){e[e.ARROW=0]="ARROW",e[e.TURRET_BULLET=1]="TURRET_BULLET",e[e.CROSSBOW_ARROW=2]="CROSSBOW_ARROW",e[e.REPEATER_ARROW=3]="REPEATER_ARROW",e[e.UNKOWN_PROJECTILE=4]="UNKOWN_PROJECTILE",e[e.MUSKET_BULLET=5]="MUSKET_BULLET"})($i||($i={}));class Fs{constructor(t,r,i,n,a,s,f,c){this.x=t,this.y=r,this.dir=i,this.range=n,this.speed=a,this.projectileType=s,this.layer=f,this.sid=c}getAsPos(){return new at(this.x,this.y)}}var Rr={};Object.defineProperty(Rr,"__esModule",{value:!0});var Kt=Rr.EventEmitter=void 0;class ji{constructor(t,r,i=!1){Rt(this,"name");Rt(this,"cb");Rt(this,"once");this.name=t,this.cb=r,this.once=i}}class Ks{constructor(){Rt(this,"events",[])}on(t,r){this.events.push(new ji(t,r))}once(t,r){this.events.push(new ji(t,r,!0))}emit(t,r){this.events.filter(i=>i.name!=t?!0:(i.cb(r),!i.once))}removeEvent(t,r){this.events.forEach(i=>{i.name==t&&i.cb==r&&(i.once=!0)})}}Kt=Rr.EventEmitter=Ks;var Ws=Date.now();const ie=class extends Kt{constructor(t=!1){super(),this.socket=null,this.player=new Yn,this.players=[],this.gameObjects=[],this.alive=!1,this.hatsOwned={},this.accessoriesOwned={},this.projectiles=[],this.isAutoAtk=!1;const r=this;if(t)Object.defineProperty(WebSocket.prototype,"hiddenSend",{value:WebSocket.prototype.send}),Object.defineProperty(WebSocket.prototype,"send",{value:function(i){r.socket==null&&(r.socket=this);const n=new $r(Gt(new Uint8Array(i)));if(r.emit("packetSend",n),n.isCanceled)return;n.type==z.SPAWN&&(r.alive=!0),this.hiddenSend(i)}});else{class i extends WebSocket{hiddenSend(a){super.send(a)}constructor(a){super(a),this.send=s=>{const f=new $r(Gt(new Uint8Array(s)));r.emit("packetSend",f),!f.isCanceled&&(f.type==z.SPAWN?r.alive=!0:f.type==z.SET_ATTACK_STATE&&f.payload[0]&&(r.isAutoAtk=!r.isAutoAtk),this.hiddenSend(s))},r.socket=this,r.initSocket()}}Object.defineProperty(window,"WebSocket",{value:i})}ks.forEach(i=>{i.price<=0&&!i.dontSell&&(this.hatsOwned[i.id]=!0)}),Gs.forEach(i=>{i.price<=0&&(this.accessoriesOwned[i.id]=!0)})}initSocket(){var t;(t=this.socket)==null||t.addEventListener("message",r=>{const i=new Pn(Gt(new Uint8Array(r.data)));this.emit("packetReceive",i);const n=i.payload;switch(i.type){case F.HEALTH:const c=n[0];this.emit("health",new Nn(c,n[1])),this.players[c].health=n[1];break;case F.INIT:this.player.id=n[0];break;case F.SET_SID:this.players[n[0]]=this.player,this.player.sid=n[0];break;case F.UPDAE_PLAYERS:var s=[];const _=Date.now();for(const u of this.projectiles)u.range-=(_-Ws)*u.speed,u.range<=0&&this.removeProjectile(u.sid);for(let u=0;u<n[0].length;u+=13){const v=n[0].slice(u,u+13),N={sid:v[0],x:v[1],y:v[2],dir:v[3],currentObject:v[4],wep:v[5],variant:v[6],tribe:v[7],isLeader:v[8],hat:v[9],acc:v[10],isSkull:v[11],zIndex:v[12]};this.players[N.sid]||(console.warn("Ran into unpredicted circumstance current player cannot be found, IPlayerDat, this.players, IPlayerDat.sid",N,this.players,N.sid),this.players[N.sid]=new rr),this.emit("updatePlayer",N),this.players[N.sid].assign(N),s.push(N)}this.emit("serverTick",new Mn(s));break;case F.REMOVE_PLAYER:const A=this.getPlayerById(n[0]);A&&(this.emit("playerLeave",new jr(A)),delete this.players[A.sid]);break;case F.ADD_PLAYER:const d=n[0],O=d[1];var f=this.player;O!=this.player.sid&&(f=new rr),f.sid=O,f.id=d[0],f.name=d[2],f.x=d[3],f.y=d[4],this.players[O]=f,this.emit("addPlayer",new jr(f));break;case F.ADD_OBJECT:for(let u=0;u<n[0].length;u+=8){const v=n[0].slice(u,u+8),N=new Cs(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7]);this.gameObjects.push(N),this.emit("addObject",new wn(N))}break;case F.REMOVE_OBJECT:for(let u=0;u<this.gameObjects.length;u++){const v=this.gameObjects[u];v.ownerSid==n[0]&&this.emit("removeObject",new Vr(v,lt.BUILDINGBREAK))}delete this.gameObjects[n[0]];break;case F.REMOVE_ALL_OBJECTS:for(let u=0;u<this.gameObjects.length;u++){const v=this.gameObjects[u];v.ownerSid==n[0]&&(this.emit("removeObject",new Vr(v,lt.PLAYERLEAVE)),this.gameObjects.slice(u,1))}break;case F.SET_ITEMS_BAR:n[0]&&(n[1]?this.player.weapons=n[0]:this.player.items=n[0]);break;case F.DEATH:this.isAutoAtk=!1,this.player.weapons=[tt.TOOL_HAMMER,void 0],this.player.items=[K.APPLE,K.WOOD_WALL,K.SPIKE,K.WINDMILL,void 0,void 0,void 0,void 0];break;case F.CHAT:const m=n[0],x=this.getPlayerBySid(m);if(x==null)return;const H=n[1];clearTimeout(x.messageTimeout),x.chatMessage=H,x.messageTimeout=setTimeout(()=>{x.chatMessage=null},3e3),this.emit("chat",new Dn(m,H));break;case F.UPDATE_SHOP:if(n[0])break;const se=n[2],V=n[1];se?this.accessoriesOwned[V]=!0:this.hatsOwned[V]=!0;break;case F.ADD_PROJECTILE:const oe=new Fs(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);this.emit("addProjectile",new Un(oe)),this.projectiles.push(oe);break;case F.REMOVE_PROJECTILE:this.removeProjectile(n[0]);break}})}getPlayerById(t){for(let r of this.players)if((r==null?void 0:r.id)==t)return r;return null}getPlayerBySid(t){for(let r of this.players)if((r==null?void 0:r.sid)==t)return r;return null}sendRaw(t){var r;(r=this.socket)==null||r.send(xr(t))}sendBasic(t,...r){this.sendRaw([t,r])}sendHidden(t,...r){var i=this.socket;i==null||i.hiddenSend(xr([t,r]))}spawn(t="moomooapi",r=Ft.RED,i=!0){this.sendBasic(z.SPAWN,{name:t,skin:r,moofoll:i})}setHand(t,r){this.sendBasic(z.SELECT_ITEM,t,r)}setItem(t){this.setHand(t,!1)}setWeapon(t){this.setHand(t,!0)}attack(t,r=null){this.sendBasic(z.ATTACK,t,r)}singleSwing(t=null){this.attack(!0,t),this.attack(!1)}placeItem(t,r=null){this.setItem(t),this.singleSwing(r),this.setWeapon(this.player.wep)}toggleAutoAttack(){this.sendBasic(z.SET_ATTACK_STATE,1)}setGear(t,r,i){this.sendBasic(z.BUY_AND_EQUIP,t,r,i)}buyGear(t,r){this.setGear(!0,t,r)}buyHat(t){this.buyGear(t,!1)}equipGear(t,r){this.setGear(!1,t,r)}equipHat(t){this.equipGear(t,!1)}buyAccessory(t){this.buyGear(t,!0)}equipAccessory(t){this.equipGear(t,!0)}chat(t){this.sendBasic(z.CHAT,t.substring(0,30))}removeProjectile(t){for(let r=0;r<this.projectiles.length;r++)this.projectiles[r].sid==t&&(this.emit("removeProjectile",new Cn(this.projectiles[r])),this.projectiles.splice(r,1))}setDirection(t){this.sendBasic(z.SET_ANGLE,t)}lookAt(t){this.setDirection(this.player.getAsPos().dirTo(t))}};let ft=ie;(()=>{ie.SkinColours=Ft})(),(()=>{ie.C2SPacketType=z})(),(()=>{ie.S2CPacketType=F})(),(()=>{ie.ObjectRemoveReason=lt})(),(()=>{ie.ItemIds=K})(),(()=>{ie.WeaponIds=tt})(),(()=>{ie.Repeater=Us})(),(()=>{ie.msgpack={encode:xr,decode:Gt}})(),(()=>{ie.HatIds=mr})(),(()=>{ie.AccessoryIds=_r})(),Object.defineProperty(window,"MooMooAPI",{value:ft});const Yi="justclient",Tr={curConfig:{modules:[],menuPos:{}},version:"0.0.0",isDev:!0};var le=Tr;const Vi=$s();for(const e in Vi)le[e]=Vi[e];function ut(e=le){localStorage.setItem(Yi,JSON.stringify(e))}function Hs(){return localStorage.getItem(Yi)}function $s(){const e=Hs();return e==null?(ut(Tr),Tr):JSON.parse(e)}var Ji=!1;function js(e){if(!Ji)return;const t=le.curConfig;for(let r=0;r<t.modules.length;r++)if(t.modules[r].moduleName==e.name){t.modules[r]=e.getModuleData(),ut(le);return}t.modules.push(e.getModuleData()),ut(le)}function Ys(){for(const e of le.curConfig.modules){const t=Ee.getModule(e.moduleName);if(t!=null)for(const r of e.settings){const i=t.getSetting(r.name);i!=null&&(i.set(r.value),i==t.enabled&&i.val&&t.enable())}}Ji=!0}function De(e,t){const r=document.createElement(e);return t&&(r.className=t),r}function Wt(e,t){const r=De("input",t);return r.type=e,r}function j(e){return De("div",e)}function Vs(e,t){const r=De("p",t);return r.textContent=e,r}function Js(e){for(;e.firstChild;)e.removeChild(e.firstChild)}var br=document.getElementById("gameCanvas");const Ze=document.getElementById("chatBox");var ht;br.addEventListener("mousemove",e=>{ht=Math.atan2(e.clientY-br.height/2,e.clientX-br.width/2)}),Ze.addEventListener("input",()=>{Ze.value.startsWith(wr)?Ze.removeAttribute("max"):Ze.setAttribute("max","30")});var dt=j("guiHolder");function Or(e){e.preventDefault()}function Xs(e,t){var r=0,i=0,n=0,a=0;e.onmousedown=s,e.addEventListener("contextmenu",Or);function s(_){_.button==0?(Or(_),n=_.clientX,a=_.clientY,document.onmouseup=c,document.onmousemove=f):_.button==2}function f(_){Or(_),r=n-_.clientX,i=a-_.clientY,n=_.clientX,a=_.clientY;const A=e.offsetTop-i,d=e.offsetLeft-r;e.style.top=A+"px",e.style.left=d+"px",le.curConfig.menuPos[t]={left:d,top:A,category:t,expanded:JSON.parse(e.getAttribute("expanded"))},ut()}function c(){document.onmouseup=null,document.onmousemove=null}}function Xi(e){var r;const t=g.getPlayerBySid((r=an.targetPlayer)==null?void 0:r.sid);return e.replaceAll("%PREFIX%",wr).replaceAll("%PLAYER%",(t==null?void 0:t.name)||"No Player")}var Br=[];function Ht(e,t=!1){const r=j("notifDiv"),i=Vs(Xi(e));r.append(i),t&&r.classList.add("errorDiv"),document.body.appendChild(r),setTimeout(()=>{r.style.right="0px"}),Br.unshift(r),Ee.getModule("notifs").chatNotifs.val&&g.sendBasic(ft.C2SPacketType.CHAT,e),Ii(),setTimeout(()=>{r.style.right="-100px",setTimeout(()=>{r.remove()},650),Br.pop(),Ii()},3e3)}function Ii(){var e=200;for(let t of Br)t.style.bottom=e+"px",e+=t.clientHeight+10}function zi(e){if(!(Notification.permission!="denied"||!Et))return new Notification(e)}function Me(){return Date.now()}const Ue=class{constructor(e,t,r){this.r=e,this.g=t,this.b=r}toString(){return JSON.stringify(this)}toHex(){return"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)}static from(e){const t=JSON.parse(e);return new Ue(t.r,t.g,t.b)}};let Ce=Ue;Ce.RED=new Ue(255,0,0),Ce.GREEN=new Ue(0,255,0),Ce.BLUE=new Ue(0,0,255),Ce.WHITE=new Ue(255,255,255),Ce.BLACK=new Ue(0,0,0);var Et=!1;addEventListener("blur",()=>{Et=!0}),addEventListener("focus",()=>{Et=!1});function Is(e){return new at(e.x,e.y)}class Zi{info(t){Ht(t)}error(t){Ht(t,!0)}}var ae=(e=>(e[e.SHAME=45]="SHAME",e[e.MOO_CAP=51]="MOO_CAP",e[e.APPLE_CAP=50]="APPLE_CAP",e[e.MOO_HEAD=28]="MOO_HEAD",e[e.PIG_HEAD=29]="PIG_HEAD",e[e.FLUFF_HEAD=30]="FLUFF_HEAD",e[e.PANDOU_HEAD=36]="PANDOU_HEAD",e[e.BEAR_HEAD=37]="BEAR_HEAD",e[e.MONKEY_HEAD=38]="MONKEY_HEAD",e[e.POLAR_HEAD=44]="POLAR_HEAD",e[e.FEZ_HAT=35]="FEZ_HAT",e[e.ENIGMA_HAT=42]="ENIGMA_HAT",e[e.BLITZ_HAT=43]="BLITZ_HAT",e[e.BOB_XIII_HAT=49]="BOB_XIII_HAT",e[e.PUMPKIN=57]="PUMPKIN",e[e.BUMMLE_HAT=8]="BUMMLE_HAT",e[e.STRAW_HAT=2]="STRAW_HAT",e[e.WINTER_CAP=15]="WINTER_CAP",e[e.COWBOY_HAT=5]="COWBOY_HAT",e[e.RANGER_HAT=4]="RANGER_HAT",e[e.EXPLORER_HAT=18]="EXPLORER_HAT",e[e.FLIPPER_HAT=31]="FLIPPER_HAT",e[e.MARKSMAN_CAP=1]="MARKSMAN_CAP",e[e.BUSH_GEAR=10]="BUSH_GEAR",e[e.HALO=48]="HALO",e[e.SOLDIER_HELMET=6]="SOLDIER_HELMET",e[e.ANTI_VENOM_GEAR=23]="ANTI_VENOM_GEAR",e[e.MEDIC_GEAR=13]="MEDIC_GEAR",e[e.MINERS_HELMET=9]="MINERS_HELMET",e[e.MUSKETEER_HAT=32]="MUSKETEER_HAT",e[e.BULL_HELMET=7]="BULL_HELMET",e[e.EMP_HELMET=22]="EMP_HELMET",e[e.BOOSTER_HAT=12]="BOOSTER_HAT",e[e.BARBARIAN_ARMOR=26]="BARBARIAN_ARMOR",e[e.PLAGUE_MASK=21]="PLAGUE_MASK",e[e.BULL_MASK=46]="BULL_MASK",e[e.WINDMILL_HAT=14]="WINDMILL_HAT",e[e.SPIKE_GEAR=11]="SPIKE_GEAR",e[e.TURRET_GEAR=53]="TURRET_GEAR",e[e.SAMURAI_ARMOR=20]="SAMURAI_ARMOR",e[e.DARK_KNIGHT=58]="DARK_KNIGHT",e[e.SCAVENGER_GEAR=27]="SCAVENGER_GEAR",e[e.TANK_GEAR=40]="TANK_GEAR",e[e.THIEF_GEAR=40]="THIEF_GEAR",e[e.BLOODTHIRSTER=55]="BLOODTHIRSTER",e[e.Assassin_GEAR=56]="Assassin_GEAR",e))(ae||{});class qe extends Kt{constructor(t,r,i="",n){super(),this.name=t,this.defaultVal=r,this.desc=i,this.module=n,this.settingCategory=null,this.val=r}set(t){return typeof t=="string"?this.val=this.parse(t):this.val=t,this.save(),this.emit("change",this.val),!0}save(){this.module.save()}setCategory(t){return this.settingCategory=t,this}asStr(){return this.val.toString()}}class qi extends qe{constructor(t,r,i,n,a,s=""){super(t,r,s,a),this.minVal=i,this.maxVal=n}parse(t){return parseInt(t)}}class Qi extends qe{constructor(t,r,i,n=""){super(t,r,n,i)}parse(t){return JSON.parse(t)}}class en extends qe{constructor(t,r,i="",n){super(t,n,i,r)}parse(t){return t}}class pt extends qe{constructor(t,r,i,n,a=""){super(t,r,a,n),this.rawEnum=i}parse(t){return parseInt(t)}enumKeys(){const t=[];for(const r in this.rawEnum)typeof r=="string"&&t.push(r);return t}enumValues(){const t=[];for(const r in this.rawEnum){const i=parseInt(r);isNaN(i)||t.push(i)}return t}}class zs extends pt{constructor(t,r,i,n=""){super(t,r,ae,i,n)}}class Zs extends pt{constructor(t,r,i,n=""){super(t,r,n,i)}}class tn extends qe{constructor(t,r,i,n,a,s){super(t,r,n,i),this.minLen=a,this.maxLen=s}parse(t){return t}set(t){return this.maxLen&&t.length>this.maxLen||this.minLen&&t.length<this.minLen?!1:super.set(t)}}var de=(e=>(e[e.SPIKE=0]="SPIKE",e[e.MILL=1]="MILL",e[e.TRAP=2]="TRAP",e[e.TURRET=3]="TURRET",e[e.WALL=4]="WALL",e))(de||{});class qs extends pt{constructor(t,r,i,n){super(t,r,de,i,n)}}class rn extends qe{constructor(t,r,i,n){super(t,r,i,n)}parse(t){return console.log(t,Ce.from(t)),Ce.from(t)}asStr(){return this.val.toHex()}}var M=(e=>(e[e.COMBAT=0]="COMBAT",e[e.MISC=1]="MISC",e[e.CLIENT=2]="CLIENT",e[e.PLACEMENT=3]="PLACEMENT",e[e.GEAR=4]="GEAR",e[e.WORLD=5]="WORLD",e[e.CHAT=6]="CHAT",e))(M||{});class C extends Zi{constructor(t,r,i=""){super(),this.name=t,this.category=r,this.desc=i,this.settings=[],this.bind=this.addBind("keybind","the keybind to toggle"),this.enabled=this.addBool("enabled",!1,"if it is enabled"),this.showNotifs=this.addBool("togglenotifs",!0,"whether or not to show notifications when module is enabled/disabled"),this.toggleOnRelease=this.addBool("toggleonrelease",!1,"toggles the module on key release"),this.guiElement=null,this.intervalData=[]}onEnable(){}onDisable(){}setDefaultBind(t){this.bind.val==""&&this.bind.set(t),this.save()}defaultToggle(){this.toggleOnRelease.val||this.toggleOnRelease.set(!0),this.save()}info(t){super.info(`[${this.name}] ${t}`)}error(t){super.error(`[${this.name}] ${t}`)}enable(){this.enabled.set(!0),this.showNotifs.val&&this.info("enabled"),this.guiElement.classList.add("moduleEnabled");for(const t of this.intervalData)t.interval=setInterval(t.cb,t.ms);this.onEnable()}disable(t){this.enabled.set(!1),this.showNotifs.val&&this.info("disabled"+(t?" "+t:"")),this.guiElement.classList.remove("moduleEnabled");for(const r of this.intervalData)clearInterval(r.interval);this.onDisable()}addSetting(t){return this.settings.push(t),t}addNum(t,r,i,n,a=""){return this.addSetting(new qi(t,r,i,n,this,a))}addBool(t,r,i=""){return this.addSetting(new Qi(t,r,this,i))}addBind(t,r="",i=""){return this.addSetting(new en(t,this,r,i))}addEnum(t,r,i,n=""){return this.addSetting(new pt(t,r,i,this,n))}addHat(t,r,i=""){return this.addSetting(new zs(t,r,this,i))}addAcc(t,r,i=""){return this.addSetting(new Zs(t,r,this,i))}addString(t,r="",i="",n,a){return this.addSetting(new tn(t,r,this,i,n,a))}addBuild(t,r,i=""){return this.addSetting(new qs(t,r,this,i))}addCol(t,r,i=""){return this.addSetting(new rn(t,r,i,this))}save(){js(this)}on(t,r){g.on(t,i=>{!this.enabled.val||r(i)})}onJust(t,r){Yt.on(t,i=>{!this.enabled.val||r(i)})}getSetting(t){for(const r of this.settings)if(r.name==t)return r;return null}getModuleData(){const t={settings:[],moduleName:this.name};for(const r of this.settings)t.settings.push({name:r.name,value:r.val});return t}onPostInit(){}postInit(){this.onPostInit(),this.save()}toggle(){this.enabled.val?this.disable():this.enable()}interval(t,r){this.intervalData.push({ms:t,cb:r,interval:-1})}}var yr;class Qs{constructor(){this.modules=[],this.moduleMap=new Map}addMod(t){if(this.moduleMap.has(t))return;const r=new t;return r.name=="gearsettings"&&(yr=r),this.moduleMap.set(t,r),this.modules.push(r),this}getModule(t){if(typeof t=="string"){for(const r of this.modules)if(r.name==t)return r;return null}else return this.moduleMap.get(t)}init(){this.modulesPostInit()}modulesPostInit(){this.modules.sort((t,r)=>t.name<r.name?-1:t.name>r.name?1:0);for(const t of this.modules)t.postInit()}}const nn=j("invisHolder");var _e,$t=null;window.addEventListener("contextmenu",e=>{e.preventDefault()}),dt.appendChild(nn);const jt=new Map;function Sr(e){return`BIND: ${e.val}`}const At=class extends C{constructor(){super("gui",M.CLIENT,"the gui"),this.closeOnEscape=this.addBool("escapeclose",!0,"closes the gui when you hit escape"),this.setDefaultBind("Escape"),document.addEventListener("keydown",e=>{e.keyCode==27&&this.enabled.val&&this.closeOnEscape.val&&this.bind.val!="Escape"&&this.disable()})}onEnable(){dt.style.display="block",this.tryRender()}onDisable(){dt.style.display="none",_e!=null&&(_e.remove(),_e=null,$t=null)}renderGui(e){const t=j("dispGui"),r=j("settingDiv");r.textContent=e.name,t.append(r);for(const n of e.settings){const a=j("settingDiv");a.title=n.desc;const s=j("settingContent");s.textContent=`${n.name}:`,a.appendChild(s);const f=j("settingContent");if(n instanceof Qi){const c=Wt("checkbox","settingContent");c.checked=n.val,c.oninput=()=>{n.set(c.checked),n==e.enabled&&(n.val?e.enable():e.disable())},f.appendChild(c)}else if(n instanceof en){const c=De("button","settingContent");c.textContent=Sr(n),c.onclick=()=>{At.bindingSetting!=n?(At.bindingSetting=n,At.bindingSettingElm=c,c.textContent="BIND: BINDING"):(At.bindingSetting=null,c.textContent=Sr(n))},f.appendChild(c)}else if(n instanceof qi){const c=Wt("range","settingContent");c.min=n.minVal.toString(),c.max=n.maxVal.toString(),c.value=n.val.toString(),s.textContent=`${n.name}: ${c.value}`,c.oninput=()=>{s.textContent=`${n.name}: ${c.value}`,n.set(c.value)},f.appendChild(c)}else if(n instanceof pt){const c=De("select");for(const _ in n.rawEnum){if(isNaN(parseInt(_)))continue;const A=De("option");A.value=_,A.text=n.rawEnum[_],c.appendChild(A)}c.value=n.val.toString(),c.oninput=()=>{n.set(c.value)},f.appendChild(c)}else if(n instanceof tn){const c=Wt("text","settingContent");c.value=n.val;var i=n.val;c.oninput=()=>{n.set(c.value)?i=n.val:c.value=i},f.appendChild(c)}else if(n instanceof rn){const c=Wt("color","settingContent");c.value=n.asStr(),c.oninput=()=>{n.set(c.value)},f.appendChild(c)}a.appendChild(f),t.appendChild(a)}return t}onPostInit(){var t;function e(r,i,n){console.log(i);for(const a of Array.from(r.children))a.tagName=="DIV"&&(a.style.display=i?"block":"none");r.setAttribute("expanded",i.toString()),le.curConfig.menuPos[n].expanded=JSON.parse(r.getAttribute("expanded")),ut()}for(const r of Ee.modules){if(jt.has(r.category))continue;const i=j("catDiv");i.append(M[r.category]);const n=le.curConfig.menuPos[r.category];n&&(i.style.top=n.top+"px",i.style.left=n.left+"px"),i.addEventListener("mousedown",a=>{a.button==2&&a.target==i&&e(i,!JSON.parse(i.getAttribute("expanded")),r.category)}),jt.set(r.category,i)}for(const r of Ee.modules){const i=j("moduleDiv");i.append(r.name),r.guiElement=i;const n=jt.get(r.category);!n||(n.appendChild(i),i.title=r.desc,i.addEventListener("mousedown",a=>{if(a.button==0)r.toggle();else if(a.button==2){if(_e&&(_e.remove(),_e=null,$t==r.name)){$t=null;return}$t=r.name,_e=this.renderGui(r),nn.appendChild(_e)}}),Xs(n,r.category),e(n,(t=le.curConfig.menuPos[r.category].expanded)!=null?t:!0,r.category))}for(const r of jt.values())dt.appendChild(r);document.body.appendChild(dt)}tryRender(){}};let ke=At;ke.bindingSetting=null;class eo extends Kt{}var g=new ft,Ee=new Qs,p=g.player,Yt=new eo;const Lr={},Pr=[];document.addEventListener("keydown",e=>{if(Ze.style.display!="block"){if(Pr.forEach(t=>{t.start(e.code)}),ke.bindingSetting!=null){ke.bindingSetting.set(e.code),ke.bindingSettingElm.textContent=Sr(ke.bindingSetting),ke.bindingSetting=null;return}if(!Lr[e.code]){Lr[e.code]=!0;for(const t of Ee.modules)t.bind.val==e.code&&t.toggle()}}});function to(e){Pr.push(e)}document.addEventListener("keyup",e=>{if(Ze.style.display!="block"){Lr[e.code]=!1,Pr.forEach(t=>{t.stop(e.code)});for(const t of Ee.modules)t.bind.val==e.code&&t.enabled.val&&t.toggleOnRelease.val&&t.disable()}});var Nr=[];const an={targetPlayer:null};function sn(e){Nr.push(new e)}g.on("packetSend",e=>{if(e.type==k.CHAT){const t=e.payload[0];if(t.startsWith(wr)){e.isCanceled=!0;const r=t.split(" "),i=r[0].substring(1);for(const n of Nr)if(n.name==i){n.input(...r.slice(1));return}Ht("command not found!")}}else e.type==k.SET_ANGLE&&Yt.emit("sendSetDir",e.payload[0])});var re=null,on=-1,vt=[];g.on("serverTick",e=>{re=null;for(const i of e.playerData){if(i.sid==p.sid||i.tribe==p.tribe&&i.tribe!=null)continue;const n=g.getPlayerBySid(i.sid);(re==null||it(p.getAsPos(),n.getAsPos())<on)&&(re=n,on=it(p.getAsPos(),n.getAsPos()))}if(e.playerData.length!=vt.length){if(e.playerData.length>vt.length){var t=null;for(const i of e.playerData){var r=!1;for(const n of vt)i.sid==n.sid&&(r=!0);if(!r){t=i;break}}t&&Yt.emit("playerEnterRange",t)}else{var t=null;for(const n of vt){var r=!1;for(const s of e.playerData)n.sid==s.sid&&(r=!0);if(!r){t=n;break}}t&&Yt.emit("playerExitRange",t)}vt=e.playerData}});function w(e){Ee.addMod(e)}var wr="!";class cn extends Zi{constructor(t,r){super(),this.name=t,this.description=r}info(t){super.info(`[${this.name}] ${t}`)}error(t){super.error(`[${this.name}] ${t}`)}}class ro extends cn{constructor(){super("u","Allows you to obtain specific upgrades for your player, !u [km/pm]")}input(...t){return t.length==0?(this.info("No upgrade specified, defaulting to KM"),this.km(),!0):t[0]=="km"?(this.km(),!0):t[0]=="pm"?(this.pm(),!0):(this.info("Invalid upgrade specified"),!1)}km(){for(const t of[7,17,31,23,10,38,4,15])g.sendBasic(k.UPGRADE,t);this.info("KM upgrades obtained")}pm(){for(const t of[5,17,31,23,9,38,28,15])g.sendBasic(k.UPGRADE,t);this.info("PM upgrades obtained")}}class io extends C{constructor(){super("client",M.CLIENT,"a module to edit settings in the client (tbd)")}}class no extends C{constructor(){super("notifs",M.CLIENT,"Notification settings"),this.chatNotifs=this.addBool("chatnotify",!1,"notifies modules toggled in chat")}}var Ge=(e=>(e[e.APPLE=0]="APPLE",e[e.COOKIE=1]="COOKIE",e[e.CHEESE=2]="CHEESE",e[e.WOOD_WALL=3]="WOOD_WALL",e[e.STONE_WALL=4]="STONE_WALL",e[e.CASTLE_WALL=5]="CASTLE_WALL",e[e.SPIKE=6]="SPIKE",e[e.GREATER_SPIKE=7]="GREATER_SPIKE",e[e.POISON_SPIKE=8]="POISON_SPIKE",e[e.SPINNING_SPIKE=9]="SPINNING_SPIKE",e[e.WINDMILL=10]="WINDMILL",e[e.FASTER_WINDMILL=11]="FASTER_WINDMILL",e[e.POWER_MILL=12]="POWER_MILL",e[e.MINE=13]="MINE",e[e.SAPPLING=14]="SAPPLING",e[e.PIT_TRAP=15]="PIT_TRAP",e[e.BOOST_PAD=16]="BOOST_PAD",e[e.TURRET=17]="TURRET",e[e.PLATFORM=18]="PLATFORM",e[e.HEALING_PAD=19]="HEALING_PAD",e[e.SPAWN_PAD=20]="SPAWN_PAD",e[e.BLOCKER=21]="BLOCKER",e[e.TELEPORTER=22]="TELEPORTER",e))(Ge||{});function ln(){return p.getFoodType()}function Vt(e,t=null){g.placeItem(e,t)}function fn(){Vt(ln())}function gt(e){Vt(p.getSpikeType(),e)}function ao(e){p.getPadType()!=null&&Vt(p.getPadType(),e)}function Dr(){const e=ln(),t=e==Ge.APPLE?20:e==Ge.COOKIE?40:30;for(let r=t;r<=100+t-p.health;r+=t)fn()}function so(){setTimeout(Dr,125)}var Jt=!1,un=!1,Re=p.getSpikeType();class oo extends C{constructor(){super("antitrap",M.COMBAT,"protects you while in a trap"),this.blockingType=this.addBuild("blocktype",de.SPIKE,"the type of building to place while trapping"),this.placeIncr=this.addNum("placeincrease",10,1,90,"amount to increase for the direction to place in"),this.replace=this.addBool("replace",!0,"tries to replace when a building is broken nearby"),this.on("serverTick",()=>{Jt=!1;for(const t of g.gameObjects)if(!(!t||t.buildType!=Ge.PIT_TRAP||it(p,Is(t))>100||t.ownerSid==p.sid)){Re=p.getSpikeType(),this.blockingType.val==de.MILL?Re=p.getMillType():this.blockingType.val==de.SPIKE?Re=p.getSpikeType():this.blockingType.val==de.TRAP&&p.getPadType()?Re=p.getPadType():this.blockingType.val==de.TURRET&&p.getSpecialType()?Re=p.getSpecialType():this.blockingType.val==de.WALL&&(Re=p.getWallType()),un||hn(Re,this.placeIncr.val),Jt=!0;break}un=Jt}),this.on("removeObject",t=>{t.building.buildType==Ge.PIT_TRAP||it(p,t.building)>=150||!Jt||hn(Re,this.placeIncr.val)})}}function hn(e,t){for(let r=0;r<360;r+=t)Vt(e,nt(r))}var Fe=0;function dn(e){g.sendBasic(k.SET_ANGLE,e)}class co extends C{constructor(){super("autoaim",M.COMBAT,"automatically aims"),this.disableIfNone=this.addBool("disableifnone",!0,"disables if there is a player nearby"),this.blockPackets=this.addBool("blockpackets",!0,"blocks other direction packets"),this.on("serverTick",()=>{if(re==null){this.disableIfNone.val&&this.disable();return}Fe=Xr(p.getAsPos(),re.getAsPos()),dn(Fe)}),this.on("packetSend",t=>{t.type==k.SET_ANGLE&&t.payload[0]!=Fe&&(t.isCanceled=!0)})}onEnable(){dn(Fe)}}var En=(e=>(e[e.TOOL_HAMMER=0]="TOOL_HAMMER",e[e.HAND_AXE=1]="HAND_AXE",e[e.GREAT_AXE=2]="GREAT_AXE",e[e.SHORT_SWORD=3]="SHORT_SWORD",e[e.KATANA=4]="KATANA",e[e.POLE_ARM=5]="POLE_ARM",e[e.BAT=6]="BAT",e[e.DAGGERS=7]="DAGGERS",e[e.STICK=8]="STICK",e[e.HUNTING_BOW=9]="HUNTING_BOW",e[e.GREAT_HAMMER=10]="GREAT_HAMMER",e[e.WOODEN_SHIELD=11]="WOODEN_SHIELD",e[e.CROSSBOW=12]="CROSSBOW",e[e.REPEATER_CROSSBOW=13]="REPEATER_CROSSBOW",e[e.MC_GRABBY=14]="MC_GRABBY",e[e.MUSKET=15]="MUSKET",e))(En||{}),pn=Me(),Mr=Me(),Ur=0,lo=100,An=!1;function vn(){setTimeout(()=>{if(Me()-Mr<=125)return vn();Mr=Me(),Dr()},130)}class fo extends C{constructor(){super("autoheal",M.COMBAT,"automatically heals"),this.smartCheck=this.addBool("smartcheck",!0,"attempts to determine if the enemy is trying to insta"),this.smartCheckShame=this.addBool("smartcheckshame",!0,"attempts to calculate current shame, and heal accordingly, requires smartcheck to be enabled"),this.smartCheckShameVal=this.addNum("smartcheckshameval",4,0,6,"the maximum shame count to stop fast healing, requires smartchecksame to be enabled"),this.antiAgeOne=this.addBool("antiageone",!0,"tries to outheal age one instas"),this.on("health",t=>{if(t.sid!=p.sid)return;const r=t.health;if(An=r>lo,An?Mr-pn<=120?Ur++:Ur-=2:pn=Me(),!(r>=100)){var i=!1;if(this.smartCheck.val&&re&&re.dist(p)<=600&&r<=75){if(this.smartCheckShame.val&&Ur>this.smartCheckShameVal.val){so();return}r<=55&&(i=!0),this.antiAgeOne.val&&r<=65&&re.wep==En.TOOL_HAMMER&&(i=!0,setTimeout(fn,110))}i?Dr():vn()}})}}class uo extends C{constructor(){super("clownnotify",M.COMBAT,"notifies you if a player gets clown"),this.onlySelf=this.addBool("onlyself",!1,"only notifies if you have clown");var t={};this.on("updatePlayer",r=>{if(this.onlySelf.val&&r.sid!=p.sid)return;const i=r.hat==ae.SHAME;if(!i&&t[r.sid]==null){t[r.sid]=!1;return}if(t[r.sid]!=i){t[r.sid]=i;const n=g.getPlayerBySid(r.sid);if(n==null)return;Ht(n.name+(i?"":" no longer")+" has clown")}})}}var Xt=(e=>(e[e.SNOWBALL=12]="SNOWBALL",e[e.TREE_CAPE=9]="TREE_CAPE",e[e.STONE_CAPE=10]="STONE_CAPE",e[e.COOKIE_CAPE=3]="COOKIE_CAPE",e[e.COW_CAPE=8]="COW_CAPE",e[e.MONKEY_TAIL=11]="MONKEY_TAIL",e[e.APPLE_BASKET=17]="APPLE_BASKET",e[e.WINTER_CAPE=6]="WINTER_CAPE",e[e.SKULL_CAPE=4]="SKULL_CAPE",e[e.DASH_CAPE=5]="DASH_CAPE",e[e.DRAGON_CAPE=2]="DRAGON_CAPE",e[e.SUPER_CAPE=1]="SUPER_CAPE",e[e.TROLL_CAPE=7]="TROLL_CAPE",e[e.THORNS=14]="THORNS",e[e.BLOCKADES=15]="BLOCKADES",e[e.DEVILS_TAIL=20]="DEVILS_TAIL",e[e.SAWBLADE=16]="SAWBLADE",e[e.ANGEL_WINGS=13]="ANGEL_WINGS",e[e.SHADOW_WINGS=19]="SHADOW_WINGS",e[e.BLOOD_WINGS=18]="BLOOD_WINGS",e[e.CORRUPT_X_WINGS=21]="CORRUPT_X_WINGS",e))(Xt||{});function pe(e){yr.buyHats.val&&g.buyHat(e),g.equipHat(e)}function Cr(e){yr.buyAccs.val&&g.buyAccessory(e),g.equipAccessory(e)}function ho(){g.player.acc==Xt.MONKEY_TAIL&&Cr(0),pe(ae.BULL_HELMET)}function gn(){g.setWeapon(p.getPrimaryType())}function Eo(){const e=p.getSecondaryType();e!=null&&g.setWeapon(e)}function xn(e){g.sendBasic(k.SET_ANGLE,p.getAsPos().dirTo(e))}var Qe=!1;g.on("packetReceive",e=>{e.type==I.DEATH&&(Qe=!1)}),g.on("packetSend",e=>{e.type==k.SET_ATTACK_STATE&&e.payload[0]&&(Qe=!Qe)});function kr(){g.toggleAutoAttack()}function po(){ho(),gn(),g.singleSwing()}function Ao(){pe(ae.TURRET_GEAR),Eo(),g.singleSwing()}function vo(){pe(ae.BOOSTER_HAT),Cr(Xt.MONKEY_TAIL),gn()}var xt=0,It,mn=!1,_n=(e=>(e[e.NONE=0]="NONE",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e))(_n||{});class go extends C{constructor(){super("insta",M.COMBAT,"insta kill noobs"),this.spikePlaceCount=this.addEnum("spikePlaceCount",0,_n,"amount of spikes to place for the insta"),this.on("packetReceive",t=>{if(t.type==I.UPDAE_PLAYERS){if(p.getSecondaryType()==null){this.disable("no secondary!");return}xt++,xt==1?(po(),this.instaSpike()):xt==2?Ao():xt==3&&(vo(),this.disable())}})}onPostInit(){It=Ee.getModule("autoaim")}onEnable(){xt=0,It.enabled.val||(It.enable(),mn=!0)}onDisable(){mn&&It.disable()}instaSpike(){this.spikePlaceCount.val==1?gt(Fe):this.spikePlaceCount.val==2&&(gt(Fe-45),gt(Fe+45))}}class xo extends C{constructor(){super("trapnuker",M.COMBAT,"Breaks traps that you're in"),this.on("serverTick",()=>{for(const t of g.gameObjects)t.buildType==Ge.PIT_TRAP&&t.dist(p)<=95&&(xn(t),Qe||kr())})}onDisable(){Qe&&kr()}}class mo extends C{constructor(){super("visualrange",M.COMBAT,"notifies you if players come into/leave your view"),this.tabbedOutNotif=this.addBool("tabbedout",!0,"pops up a desktop notification if you're tabbed out"),this.enter=this.addBool("enter",!0,"notifies when a player enters visual range"),this.exit=this.addBool("exit",!0,"notifies when a player exits visual range"),this.onJust("playerEnterRange",t=>{var i;if(!this.enter.val||t.sid==p.sid)return;const r=((i=g.getPlayerBySid(t.sid))==null?void 0:i.name)+" has entered visual range";this.info(r),this.tabbedOutNotif&&Et&&zi(r)}),this.onJust("playerExitRange",t=>{var i;if(!this.exit.val||t.sid==p.sid)return;const r=((i=g.getPlayerBySid(t.sid))==null?void 0:i.name)+" has exited visual range";this.info(r),this.tabbedOutNotif&&Et&&zi(r)})}}const mt=[];var Te=0,Gr=0;for(let e in ae){const t=parseInt(e);isNaN(t)||mt.push(t)}class _o extends C{constructor(){super("rainbow",M.GEAR,"cycles through hats"),this.tickInterval=this.addNum("interval",5,1,50,"interval to change hats"),this.on("serverTick",()=>{if(Gr++,Gr>=this.tickInterval.val){for(;!g.hatsOwned[mt[Te]];)Te++,Te>=mt.length&&(Te=0);Gr=0,pe(mt[Te]),Te++,Te>=mt.length&&(Te=0)}})}onDisable(){pe(0)}}var Rn;class Ro extends C{constructor(){super("autoez",M.CHAT,"Automatically insult players after death"),this.msg=this.addString("message","ez %PLAYER%","the message to send after killing a player",0,30),this.onJust("playerExitRange",t=>{Me()-Rn>=500||(an.targetPlayer=t,g.chat(Xi(this.msg.val)))}),this.on("packetReceive",t=>{t.type==I.UPDATE_MATS&&t.payload[0]=="kills"&&(Rn=Me())})}}class To extends C{constructor(){super("debug",M.MISC,"a module for debugging"),this.addBool("bool setting",!1,"bool setting defaulting to false"),this.addNum("num setting",5,1,10,"num setting defaulting to 5 with a minimum of 1 and max of 10"),this.addBind("bind setting","a bind setting with no defaults"),this.addHat("hat setting",ae.SHAME,"hat setting defaulting to the shame hat"),this.addBuild("build setting",de.TRAP,"building setting, defaulting to trap");let t;(r=>{r[r.ENUMVAL1=0]="ENUMVAL1",r[r.ENUMVAL2=1]="ENUMVAL2",r[r.ENUMVAL3=2]="ENUMVAL3"})(t||(t={})),this.addEnum("enum setting",0,t,"an enum setting")}}class bo extends C{constructor(){super("packetlogger",M.MISC,"logs packets"),this.consoleOnly=this.addBool("consoleonly",!1,"logs packets to the console"),this.sendingPackets=this.addBool("sending",!0,"logs packets if sent out to server"),this.receiveingPackets=this.addBool("receiving",!0,"logs packets sent from server to client"),this.on("packetSend",t=>{this.info("sending packet "+JSON.stringify(t.packet)),console.log(t.packet)}),this.on("packetReceive",t=>{this.info("receiving packet "+JSON.stringify(t.packet)),console.log(t.packet)})}}class Oo{constructor(t,r,i){this.cb=t,this.msInterval=r,this.code=i,this.intervalId=null}start(t){this.code!=t||this.intervalId!=null||(this.intervalId=setInterval(this.cb,this.msInterval))}stop(t){this.code!=t||this.intervalId==null||(clearInterval(this.intervalId),this.intervalId=null)}}class _t extends C{constructor(t,r){super(t,M.PLACEMENT,"placement settings"),this.repeater=null,this.triPlace=this.addBool("triplace",!1,"will place 3 builds instead of 1"),this.triPlaceDir=this.addNum("triplaceadd",90,45,120,"the amount (in degrees) to add to the placement"),this.cbId=r.bind(p),this.defaultToggle()}onPostInit(){this.repeater=new Oo(()=>{const t=this.cbId();if(t!=null&&(g.placeItem(t,ht),this.triPlace.val)){const r=nt(this.triPlaceDir.val);g.placeItem(t,ht+r),g.placeItem(t,ht-r)}},0,this.bind.val),this.bind.on("change",t=>{this.repeater.code=t}),to(this.repeater)}}class Bo extends _t{constructor(){super("spike",p.getSpikeType)}}class yo extends _t{constructor(){super("trap",p.getPadType)}}class So extends _t{constructor(){super("food",p.getFoodType)}}class Lo extends _t{constructor(){super("mill",p.getMillType)}}class Po extends _t{constructor(){super("turret",p.getSpecialType)}}class No extends C{constructor(){super("nuker",M.WORLD,"breaks near buildings"),this.on("serverTick",()=>{const t={dist:null,obj:null};for(const r in g.gameObjects){const i=g.gameObjects[r];(t.dist==null||i.dist(p.getAsPos())<t.dist)&&(t.obj=i,t.dist=i.dist(p.getAsPos()))}t.obj&&t.dist<100&&(xn(t.obj),Qe||kr())})}}var wo=`.notifDiv{position:absolute;right:-100px;width:fit-content;height:fit-content;background-color:#4b4b4b79;border-radius:5px;transition-duration:.65s;z-index:10}.guiHolder{top:0px;left:0px;width:100%;position:absolute;height:100%;background-color:#7c7c7c48;display:none}.catDiv{position:absolute;width:fit-content;height:fit-content;background-color:#1f1f1f;padding:6px;display:grid;place-items:center;color:#8ac0f0d7}.moduleDiv{display:block;width:fit-content;height:fit-content;padding:3px;background-color:#1f1f1f;transition-duration:.5s}.moduleDiv:hover{background-color:#3354c4}.invisHolder{display:grid;place-items:center;position:absolute;width:100%;height:100%}.dispGui{display:block;width:45%;height:70%;background-color:#103a94a2;overflow-y:hidden}.settingDiv{width:100%;height:fit-content;position:relative;display:grid;place-content:center;margin-bottom:4px;box-sizing:border-box}.settingContent{display:inline-block;width:fit-content}.moduleEnabled{background-color:#648edbea}.errorDiv{background-color:#740d0da8}.commandDiv{display:block;width:100%;height:fit-content;text-align:center;padding:5px;border:2px solid rgba(1,26,54,.26)}.helpDiv{display:block;width:50%;height:50%;background-color:#103a94a2;border-radius:8px}.commandDivName{width:100%;height:fit-content;text-align:center}.settingContent[type=color]{width:30px}
`;function Do(){const e=document.createElement("style");e.setAttribute("type","text/css"),e.appendChild(document.createTextNode(wo)),document.head.appendChild(e)}function Mo(e,t,r){r.on("packetSend",i=>{i.type==e&&t(i)})}function Uo(e,t,r){r.on("packetReceive",i=>{i.type==e&&t(i)})}const Co=JSON.parse(atob("WyJjdW50Iiwid2hvcmUiLCJmdWNrIiwic2hpdCIsImZhZ2dvdCIsIm5pZ2dlciIsIm5pZ2dhIiwiZGljayIsInZhZ2luYSIsIm1pbmdlIiwiY29jayIsInJhcGUiLCJjdW0iLCJzZXgiLCJ0aXRzIiwicGVuaXMiLCJjbGl0IiwicHVzc3kiLCJtZWF0Y3VydGFpbiIsImppenoiLCJwcnVuZSIsImRvdWNoZSIsIndhbmtlciIsImRhbW4iLCJiaXRjaCIsImRpY2siLCJmYWciLCJiYXN0YXJkIl0="));class ko extends C{constructor(){super("cursebypass",M.CHAT,"bypasses the curse filter"),Mo(k.CHAT,t=>{var r=t.payload[0],i=!1;Co.forEach(n=>{r.indexOf(n)!=-1&&(i=!0,r=r.replaceAll(n,`${n[0].toUpperCase()}${n.substring(1,n.length)}`))}),i&&(t.isCanceled=!0,g.sendHidden(k.CHAT,r))},this)}}var Tn=(e=>(e[e.ENEMIES=0]="ENEMIES",e[e.TEAM=1]="TEAM",e[e.ALL=2]="ALL",e))(Tn||{});class Go extends C{constructor(){super("chatmirror",M.CHAT,"mirrors player's chat messages"),this.copyPlayers=this.addEnum("playersel",2,Tn,"select which players to mirror"),Uo(I.CHAT,t=>{const r=t.payload[0];if(r==p.sid)return;const i=g.getPlayerBySid(r);i!=null&&(this.copyPlayers.val==1&&i.tribe!=p.tribe||this.copyPlayers.val==0&&i.tribe==p.tribe||g.chat(t.payload[1]))},this)}}class Fo extends C{constructor(){super("speedgear",M.GEAR,"Equips the fastest gear")}onEnable(){p.y<2400?pe(ae.WINTER_CAP):p.y>6850&&p.y<7550?pe(ae.FLIPPER_HAT):(pe(0),pe(ae.BOOSTER_HAT)),Cr(Xt.MONKEY_TAIL),this.disable()}}class Ko extends C{constructor(){super("gearsettings",M.GEAR,"various settings regarding the handling of gear, does not matter if enabled/disabled"),this.buyHats=this.addBool("buyhat",!0,"automatically buys hats"),this.buyAccs=this.addBool("buyaccs",!0,"automatically buys accessories")}}const Wo={esc:"Escape"},be=j("guiHolder"),bn=j("invisHolder"),Fr=j("helpDiv"),On=De("p","commandDivName"),Kr=j("commandsDiv");On.innerText="Commands",Fr.appendChild(On),Fr.appendChild(Kr),bn.appendChild(Fr),be.appendChild(bn),be.style.display="none",document.body.appendChild(be),be.addEventListener("click",()=>{be.style.display="none"}),be.addEventListener("keydown",e=>{e.code==Wo.esc&&(be.style.display="none")});class Ho extends cn{constructor(){super("help","get some help")}input(...t){return Js(Kr),be.style.display="block",Nr.forEach(r=>{const i=j("commandDiv");i.innerText=r.name,i.title=r.description,Kr.appendChild(i)}),!0}}var Bn=(e=>(e[e.MOUSE=0]="MOUSE",e[e.ENEMY=1]="ENEMY",e))(Bn||{}),yn=(e=>(e[e.NEAR=0]="NEAR",e[e.ALWAYS=1]="ALWAYS",e))(yn||{});class $o extends C{constructor(){super("boostspike",M.COMBAT,"rapidly places boost pads and spikes"),this.aimMode=this.addEnum("aimmode",1,Bn,"What direction to bostspike in"),this.spikeMode=this.addEnum("spikemode",0,yn,"When to place spikes"),this.spikeDist=this.addNum("spikedist",300,200,1e3,"Distance to start place spikes"),this.interval(0,()=>{const t=this.aimMode.val==0||re==null?ht:p.dirTo(re);ao(t),(this.spikeMode.val==1||re!=null&&p.dist(re)<this.spikeDist.val)&&(gt(t+nt(90)),gt(t-nt(90)))})}onEnable(){p.getPadType()!=Ge.BOOST_PAD&&this.disable("You do not have a boost pad!")}}console.log("jusclient init...");const jo=Date.now();w(fo),w(ke),w(io),w(no),w(Bo),w(yo),w(So),w(Lo),w(Po),w(go),w(uo),w(To),w(_o),w(bo),w(mo),w(co),w(oo),w(No),w(xo),w(Ro),w(ko),w(Go),w(Fo),w(Ko),w($o),Ee.init(),Ys(),Do(),sn(Ho),sn(ro),console.log("justclient init finished in",Date.now()-jo,"ms")});
